---
date: 2024-11-01
title: "Disrupción y Estructura en redes de producción cietífica"
subtitle: "Un Análisis ERGM Modo-2 al campo de la Ciencia de la Sustentabilidad"
author: Roberto Cantillan
bibliography: paper_sna_ssla.bib
bibliographystyle: apa
categories:
  - R
  - Networks
  - Two mode
  - ERGM
  - Scientific networks
summary: |
    En este análisis examinamos la estructura de colaboración científica en Latinoamérica mediante un ERGM bipartito sobre una red de 45,724 conexiones autor-artículo. Los resultados revelan una baja densidad base compensada por una fuerte tendencia a formar equipos de tamaño medio. Destaca especialmente cómo la disrupción científica se asocia positivamente con la formación de vínculos, Los resultados sugieren que mientras las ciencias sociales y humanidades (SHAPE) tienden a colaborar dentro de su campo, las ciencias STEM muestran patrones más abiertos de colaboración interdisciplinaria. Esto podría reflejar diferencias en las prácticas de investigación: SHAPE con tradiciones más especializadas vs. STEM con mayor apertura a cruces disciplinares.
image: "featured.jpg"
title-block-banner: featured.jpg
#title-block-banner-color: "rgba(0,38,66,0.75)"
title-block-style: default
---


## Introducción

La ciencia de la sustentabilidad requiere urgentemente de innovación transformadora para abordar desafíos socio-ambientales complejos. Comprender cómo emerge la investigación disruptiva en las redes científicas es, por tanto, crucial. Li, et. al. [-@liProductiveScientistsAre2024a] han demostrado una relación inversa entre productividad y disrupción científica, pero los mecanismos estructurales subyacentes a este fenómeno permanecen poco claros, particularmente en el contexto de redes modo-2 que vinculan autores y publicaciones.

La sociología del conocimiento científico ha identificado históricamente la dualidad fundamental entre las estructuras sociales de producción y el contenido del conocimiento producido [@mannheimIdeologyUtopia1936; @durkheimDivisionLaborSociety1933]. Esta dualidad se manifiesta particularmente en campos emergentes como la ciencia de la sustentabilidad, donde la innovación conceptual y la estructura social de producción se constituyen mutuamente. A diferencia de visiones que enfatizan la fragmentación disciplinar o la mera acumulación de capital científico, proponemos que la producción de conocimiento científico emerge de la interacción entre mecanismos de cohesión estructural, procesos de legitimación y dinámicas de innovación disruptiva.

El trabajo seminal de Gondal [-@gondalLocalGlobalStructure2011] sobre campos emergentes identifica cómo la incertidumbre inicial y la necesidad de legitimación producen una centralización temprana que estructura el desarrollo posterior del campo. Sin embargo, esta centralización no es simplemente un proceso de acumulación de capital científico como sugería Bourdieu [-@bourdieuSpecificityScientificField1975], sino que refleja una necesidad estructural más profunda: establecer las bases sociales compartidas que permiten la evaluación y validación del conocimiento en condiciones de alta incertidumbre. Esto se vincula con lo que Kuhn [-@kuhnStructureScientificRevolutions1970] denominaba "ciencia normal" - la necesidad de establecer paradigmas que permitan el trabajo científico acumulativo. Sin embargo, mientras Kuhn veía los paradigmas principalmente como estructuras cognitivas, el análisis de redes modo-2 revela que estos se sostienen en estructuras relacionales específicas que emergen de patrones sistemáticos de colaboración. Moody [-@moodyStructureSocialScience2004] profundiza esta comprensión al demostrar que la cohesión estructural que emerge en las redes de colaboración no es un simple subproducto de la centralización, sino un mecanismo generativo fundamental. Esta cohesión estructural permite la integración del conocimiento incluso en condiciones de alta especialización a través de lo que Friedkin [-@friedkinStructuralTheorySocial1998]  denominó "overlapping consensus" - consensos parciales superpuestos que facilitan la comunicación entre diferentes tradiciones especializadas.

Los hallazgos de Wu et al. [-@wuLargeTeamsDevelop2019a] sobre equipos pequeños y disrupción científica revelan una tensión productiva inherente a los campos científicos: mientras la cohesión estructural facilita la acumulación y validación del conocimiento, la innovación disruptiva requiere posiciones estructurales que permitan cierta autonomía respecto a los paradigmas dominantes. Esta tensión no es una simple contradicción, sino un principio organizador fundamental de los campos científicos que se resuelve a través de mecanismos de diferenciación integrada.

En el caso específico de la ciencia de la sustentabilidad, la urgencia transformadora modifica la evolución típica de los campos científicos. La necesidad apremiante de innovación para abordar desafíos socio-ambientales complejos genera una mayor tolerancia temprana a innovaciones disruptivas y promueve estructuras más distribuidas de producción de conocimiento. Esto resulta particularmente evidente en la relación inversa entre productividad y disrupción identificada por Li et al. [-@liProductiveScientistsAre2024a], donde los actores centrales tienden a desarrollar líneas establecidas mientras que la innovación disruptiva emerge frecuentemente desde posiciones periféricas.

La dimensión temporal es crucial para entender cómo estos mecanismos operan en diferentes etapas del desarrollo del campo. Los campos científicos emergentes atraviesan fases de legitimación inicial, consolidación y diferenciación, y eventual maduración e integración dinámica. En cada fase, la relación entre posición estructural y capacidad disruptiva evoluciona de manera diferenciada, mostrando inicialmente una fuerte centralización para establecer legitimidad, seguida de una diversificación de las fuentes de innovación y eventualmente alcanzando un equilibrio dinámico entre desarrollo y disrupción.

### Mecanismos Generativos y Propiedades Emergentes

Los hallazgos de Wu et al. [-@wuLargeTeamsDevelop2019a] sobre equipos pequeños y disrupción científica revelan una tensión productiva inherente a los campos científicos: mientras la cohesión estructural facilita la acumulación y validación del conocimiento [@moodyStructureSocialScience2004], la innovación disruptiva requiere posiciones estructurales que permitan cierta autonomía respecto a los paradigmas dominantes. Esta tensión no es una simple contradicción, sino un principio organizador fundamental de los campos científicos.

Esta dinámica se resuelve a través de lo que denominamos "mecanismos de diferenciación integrada":

**La cohesión estructural [@moodyStructureSocialScience2004]**:

- Provee el sustrato necesario para la comunicación y validación del conocimiento
- Facilita la difusión de estándares metodológicos y criterios de evaluación
- Permite la especialización sin fragmentación total
- Opera a través de patrones sistemáticos de colaboración que crean puentes entre diferentes áreas


**La centralización temprana [@gondalLocalGlobalStructure2011]**:

- Establece estándares y criterios de evaluación compartidos
- Reduce la incertidumbre inicial sobre qué constituye conocimiento válido
- Crea puntos de referencia comunes para el desarrollo del campo
- Facilita la acumulación inicial de conocimiento validado


**La autonomía estructural [@wuLargeTeamsDevelop2019a]**:

- Permite la exploración de nuevas direcciones teóricas y metodológicas
- Se asocia con posiciones periféricas o semi-periféricas en la red
- Facilita el cuestionamiento de supuestos establecidos
- Opera principalmente a través de equipos pequeños con mayor libertad para innovar


### La Diferenciación como Proceso Relacional

La diferenciación entre campos STEM y SHAPE emerge no tanto de divisiones epistemológicas fundamentales sino de diferentes regímenes de validación del conocimiento que se cristalizan en patrones distintivos de vinculación autor-artículo. Estos regímenes reflejan diferentes:

- Criterios de validación empírica
- Estructuras de argumentación aceptadas
- Formas legítimas de construcción teórica
- Patrones típicos de colaboración
- Mecanismos de acreditación y reconocimiento


### Temporalidad y Evolución en Campos Científicos Emergentes

La dimensión temporal es crucial para entender cómo los mecanismos generativos operan en diferentes etapas del desarrollo de campos emergentes. Siguiendo a Gondal [-@gondalLocalGlobalStructure2011], la evolución de estos campos no es lineal sino que exhibe tensiones dinámicas entre legitimación, innovación y estructuración. 

Fases de Desarrollo Estructural

1. Fase de Emergencia y Legitimación Inicial:

  - Alta incertidumbre sobre criterios de validación
  - Centralización temprana como mecanismo de reducción de incertidumbre
  - Dependencia de autoridades externas para legitimación
  - Formación inicial de grupos pequeños altamente cohesivos


2. Fase de Consolidación y Diferenciación:

  - Desarrollo de criterios internos de validación
  - Emergencia de estructuras centro-periferia
  - Diversificación de líneas de investigación
  - Formación de subcampos especializados mientras se mantiene cohesión general


3. Fase de Maduración e Integración Dinámica:

  - Equilibrio entre innovación disruptiva y desarrollo acumulativo
  - Estructuras de colaboración más complejas y multinivel
  - Mecanismos establecidos para integrar conocimiento diverso
  - Capacidad dual para mantener coherencia y generar disrupciones


### El Caso de la Ciencia de la Sustentabilidad

La ciencia de la sustentabilidad representa un caso particularmente relevante de campo científico emergente por varias razones:

1. Urgencia Transformadora:

  - Necesidad apremiante de innovación para abordar desafíos socio-ambientales complejos
  - Tensión intrínseca entre la urgencia de soluciones y la necesidad de rigor científico
  - Demanda de disrupciones que transformen paradigmas establecidos


2. Complejidad Estructural:

  - Naturaleza inherentemente interdisciplinaria
  - Necesidad de integrar ciencias naturales y sociales
  - Múltiples comunidades epistémicas con diferentes tradiciones


3. Dinámica Centro-Periferia Específica:

  - Li et al. [-@liProductiveScientistsAre2024a] identifican una relación inversa entre productividad y disrupción
  - Los actores centrales tienden a desarrollar líneas establecidas
  - La innovación disruptiva emerge frecuentemente desde posiciones periféricas


### Implicaciones para la Estructura de Colaboración
Esta conceptualización temporal tiene importantes implicaciones para entender cómo evolucionan las estructuras de colaboración:

1. Evolución de Patrones Colaborativos:

- De colaboraciones principalmente diádicas a estructuras más complejas
- Desarrollo de "brokers" que conectan diferentes comunidades epistémicas
- Emergencia de equipos especializados en diferentes tipos de contribución

2. Transformación de Mecanismos de Legitimación:

- De dependencia externa a criterios internos de validación
- Desarrollo de estándares específicos del campo
- Evolución de mecanismos de evaluación que balancean rigor e innovación

3. Dinámica de Innovación:

- as fuentes de innovación se diversifican con el tiempo
- os roles estructurales (central vs. periférico) se vuelven más fluidos
- merge una división del trabajo entre desarrollo y disrupción

Esta perspectiva temporal enriquece nuestra comprensión de cómo los mecanismos generativos identificados anteriormente operan y evolucionan a lo largo del tiempo, sugiriendo que la capacidad de un campo para mantener su vitalidad depende de su habilidad para institucionalizar tensiones productivas entre diferentes modos de producción de conocimiento.



## Hipótesis  

### H1: Estructura Base y Centralización

**"La red mostrará una baja densidad base pero con patrones de centralización asimétricos entre papers y autores."**

Justificación: Gondal [-@gondalLocalGlobalStructure2011] argumenta que los campos emergentes muestran inicialmente baja densidad debido a la incertidumbre estructural, pero desarrollan patrones de centralización que reflejan la necesidad de establecer legitimidad. Moody [-@moodyStructureSocialScience2004] complementa esta visión señalando que diferentes tipos de actores (en nuestro caso, papers y autores) desarrollan roles estructurales distintos en el proceso de legitimación del campo.

### H2: Asimetría Disciplinar

**"Los patrones de colaboración entre campos mostrarán asimetrías direccionales, con diferentes probabilidades de conexión según el campo de origen del paper y el campo del autor."**

Justificación: Friedkin [-@friedkinStructuralTheorySocial1998] sugiere que la integración del conocimiento ocurre a través de "consensos superpuestos" que permiten la comunicación entre tradiciones especializadas. Esta integración, según Moody [-@moodyStructureSocialScience2004], no es simétrica sino que refleja diferentes regímenes de validación del conocimiento entre campos.

### H3: Dinámica Centro-Periferia y Disrupción

**"La capacidad disruptiva mostrará una relación inversa con la centralidad estructural, moderada por el campo disciplinar."**

Justificación: Li et al. [-@liProductiveScientistsAre2024a] identifican una relación inversa entre productividad y disrupción, donde los actores centrales tienden a desarrollar líneas establecidas mientras que la innovación disruptiva emerge desde posiciones periféricas. Wu et al. [-@wuLargeTeamsDevelop2019a] complementan esta visión mostrando cómo los equipos pequeños, típicamente más periféricos, son más propensos a la disrupción.

### H4: Evolución Temporal y Campos Emergentes

**"La relación entre posición estructural y capacidad disruptiva evolucionará de manera diferenciada según la fase de desarrollo del campo, con patrones distintos entre STEM y SHAPE."**

Justificación: Gondal [-@gondalLocalGlobalStructure2011] describe cómo los campos emergentes evolucionan a través de fases de legitimación inicial, consolidación y diferenciación. En campos como la ciencia de la sustentabilidad, esta evolución se ve modificada por la urgencia transformadora, produciendo:

  - Mayor tolerancia temprana a innovaciones disruptivas
  - Estructuras más distribuidas de producción de conocimiento
  - Mecanismos acelerados de validación y difusión

### H5: Integración Disciplinar Asimétrica

**"Los campos mostrarán diferentes capacidades de integración, con STEM actuando como puente entre tradiciones disciplinares."**

Justificación: La sociología del conocimiento científico [e.g., @mannheimIdeologyUtopia1936; @kuhnStructureScientificRevolutions1970] sugiere que diferentes campos desarrollan distintas capacidades de integración basadas en sus tradiciones epistemológicas. Bourdieu [-@bourdieuSpecificityScientificField1975] complementa esta visión señalando cómo algunos campos acumulan capital científico que les permite actuar como integradores.


## Metodología 

La complejidad teórica identificada en la producción de conocimiento en campos científicos emergentes requiere una estrategia metodológica que integre diferentes aproximaciones analíticas. Proponemos combinar el análisis de cohesión estructural desarrollado por Moody [-@moodyStructureSocialScience2004] con modelos exponenciales de grafos aleatorios (ERGMs) modo-2 siguiendo a Gondal [-@gondalLocalGlobalStructure2011], para examinar cómo la dualidad entre productores y productos del conocimiento genera patrones específicos de colaboración y disrupción.

### Cohesión Estructural y Patrones de Colaboración

Moody [-@moodyStructureSocialScience2004] demuestra que el análisis de bicomponentes en redes de coautoría proporciona una medida robusta de cohesión estructural que permite identificar cómo la especialización disciplinar coexiste con la integración del conocimiento. Un bicomponente, al requerir múltiples caminos independientes entre cada par de nodos, identifica grupos que mantienen su conectividad incluso ante la remoción de miembros individuales. Esta propiedad es particularmente relevante para entender la robustez de las estructuras de colaboración científica. Siguiendo esta aproximación, analizaremos primero la red unimodal de coautoría para:

- Identificar la evolución del componente gigante y su relación con la fragmentación disciplinar
- Examinar la distribución y composición de bicomponentes como indicadores de cohesión
- Evaluar la robustez de las estructuras de colaboración a través del tiempo

### Dualidad Estructural y ERGMs Modo-2

Complementando el análisis de cohesión, los ERGMs modo-2 desarrollados por Gondal [-@gondalLocalGlobalStructure2011] permiten modelar explícitamente la dualidad entre autores y artículos que caracteriza la producción científica. Esta aproximación modela la probabilidad de observar un vínculo autor-artículo como función de:

- Características de los autores (productividad, centralidad previa)
- Atributos de los artículos (disrupción, impacto)
- Configuraciones estructurales locales (patrones de coautoría)
- Variables contextuales (campo disciplinar, período temporal)

### Estrategia de Modelamiento Integrada
Nuestra estrategia procede en tres etapas:

- Análisis de Cohesión Estructural:
  - Identificación de componentes y bicomponentes
  - Evaluación de patrones de especialización vs integración
  - Análisis de evolución temporal de estructuras cohesivas


- Modelamiento ERGM Modo-2:
  - Especificación base con efectos de grado y homofilia
  - Incorporación de términos estructurales complejos
  - Modelamiento de interacciones entre disrupción y posición estructural


- Integración de Resultados:
  - Vinculación entre patrones macro de cohesión y mecanismos generativos locales
  - Evaluación de cómo diferentes configuraciones estructurales facilitan o inhiben la innovación disruptiva
  - Análisis de evolución temporal de mecanismos relacionales


### Operacionalización y Medición

Disrupción Científica: Siguiendo a Wu et al. [-@wuLargeTeamsDevelop2019a] y Li et al. [-@wuLargeTeamsDevelop2019a], medimos la disrupción a través de patrones de citación que indican en qué medida un artículo reorienta la atención del campo hacia nuevas direcciones. 

Cohesión Estructural: Operacionalizada a través de:

- Tamaño y composición de bicomponentes
- Distribución de k-componentes
- Medidas de conectividad robusta

Posición Estructural: Capturada mediante:

- Centralidad en la red de coautoría
- Patrones de vinculación autor-artículo
- Pertenencia a componentes cohesivos

Validación y Control
La validez del análisis se asegura mediante:

Controles por factores exógenos:

- Efectos temporales
- Diferencias disciplinares
- Variación institucional


Diagnósticos específicos:

- Convergencia de modelos ERGM
- Bondad de ajuste de configuraciones estructurales
- Robustez a diferentes especificaciones


Validación cruzada entre métodos:

- Consistencia entre patrones macro y micro
- Triangulación de resultados
- Evaluación de hipótesis alternativas

Esta estrategia metodológica integrada permite examinar cómo la dualidad estructural característica de la producción científica genera simultáneamente cohesión disciplinar e innovación disruptiva, proporcionando una comprensión más profunda de la evolución de campos científicos emergentes como la ciencia de la sustentabilidad.

## Configuración Inicial y Carga de Datos

```{r setup}
#| warning: false
#| message: false

# 1. Cargar paquetes necesarios
library(osfr)
library(tidyverse)
library(ergm)
library(Matrix)
library(network)
library(ggraph)
library(tidygraph)
library(kableExtra)
library(igraph)
library(sna)
library(plotly)


# Configurar tema para visualizaciones
theme_set(theme_minimal())
```

```{r load-data}
#| warning: false
#| message: false

# 2. datos 
load("/home/rober/Documents/rcantillan.github.io/blog/posts/04-twomode-ergm/data/b3_fromlatam_1990_2000.RData")

# 3. Filtrar datos de Latam
#b3_fromlatam <- b3_joined %>%
#  filter(DocType == "Journal") %>%
#  group_by(PaperID) %>%
#  filter(latam_prop >= 0.5 |
#           any(AuthorSequenceNumber == 1 & is_latam == 1)) %>%
#  ungroup()
#
## 4. Filtrar por tiempo
#rm(b3_joined)
#gc()
#b3_fromlatam_1990_2000 <- b3_fromlatam %>% filter(Year < 2000)
```

## Preparación de Datos

Siguiendo la conceptualización de Gondal sobre campos científicos emergentes, es crucial identificar y operacionalizar tres tipos de variables:

  - Indicadores de centralización temprana (ej. productividad, citaciones)
  - Medidas de diferenciación disciplinar (ej. campos STEM vs SHAPE)
  - Métricas de disrupción que capturen la innovación en el campo

La siguiente preparación de datos organiza estas dimensiones:

```{r data-prep}
#| code-fold: show

# 5. Preparación y limpieza
clean_data <- b3_fromlatam_1990_2000 %>%
  filter(!is.na(Disruption),
         !is.na(CitationCount), 
         !is.na(H.index_auth),
         !is.na(Average_C10_auth),
         !is.na(Productivity_auth),
         !is.na(Affiliation_Name),
         !is.na(is_latam),
         !is.na(Institution_Count),
         !is.na(Field_Name),
         !is.na(Field_Type)) %>%
  filter(Field_Type == "Top")

# 6. Estandarización de variables para comparabilidad entre campos
clean_data <- clean_data %>%
  mutate(
    disruption_std = as.vector(scale(Disruption)),
    citations_std = as.vector(scale(log1p(CitationCount))),
    h_index_std = as.vector(scale(log1p(H.index_auth))),
    avg_c10_std = as.vector(scale(log1p(Average_C10_auth))),
    productivity_std = as.vector(scale(log1p(Productivity_auth))),
    # Clasificación disciplinar siguiendo la distinción 
    # teórica entre campos más y menos establecidos
    field_broad = case_when(
      Field_Name %in% c(
        "Biology", "Chemistry", "Computer science",
        "Engineering", "Environmental science", "Geography",
        "Materials science", "Mathematics", "Medicine"
      ) ~ "STEM",
      Field_Name %in% c(
        "Business", "Economics", "Political science", "Sociology"
      ) ~ "SHAPE",
      TRUE ~ NA_character_
    )
  )
```

### Construcción de la Red Bipartita

La perspectiva de Gondal sobre la dualidad estructural sugiere que la estructura del conocimiento emerge de la interacción entre dos modos: autores y documentos. Para capturar esta dualidad, construimos una red bipartita donde:

  - El primer modo (papers) representa los vehículos de conocimiento
  - El segundo modo (autores) representa los productores de conocimiento
  - Los vínculos entre modos capturan las relaciones de autoría

Esta estructura nos permite examinar cómo las propiedades de cada modo contribuyen a la emergencia de patrones macro:

```{r network-construction}
#| code-fold: show

# 7. Atributos por modo siguiendo la dualidad estructural
paper_attributes <- clean_data %>%
  group_by(PaperID) %>%
  slice(1) %>%
  ungroup() %>%
  select(PaperID, disruption_std, citations_std, 
         Institution_Count, Field_Name, field_broad)

author_attributes <- clean_data %>%
  group_by(AuthorID) %>%
  slice(1) %>%
  ungroup()

# 8. Crear matriz de incidencia y red bipartita
papers <- unique(paper_attributes$PaperID)
authors <- unique(author_attributes$AuthorID)

# Matriz de incidencia que captura la dualidad autor-paper
paper_author_matrix <- sparseMatrix(
  i = match(clean_data$PaperID, papers),
  j = match(clean_data$AuthorID, authors),
  x = 1,
  dims = c(length(papers), length(authors))
)
```


### Construcción y Visualización de la Red

La visualización de redes bipartitas presenta desafíos particulares que Gondal (2011) aborda en su análisis. Es crucial representar visualmente las tres propiedades macro que teóricamente caracterizan los campos emergentes: estructura centro-periferia, cohesión estructural y características de mundo pequeño. Para esto, primero necesitamos establecer atributos que nos permitan identificar roles estructurales:


```{r network-attributes}
# Crear la red bipartita con los atributos necesarios
net_bipartite <- network(
  paper_author_matrix,
  matrix.type = "bipartite",
  directed = FALSE
)

# Asignación de atributos siguiendo la teoría de Gondal
# Modo 1 (Papers): Vehículos de conocimiento
net_bipartite %v% "disruption" <- paper_attributes$disruption_std
net_bipartite %v% "citations" <- paper_attributes$citations_std
net_bipartite %v% "inst_count" <- paper_attributes$Institution_Count
net_bipartite %v% "field" <- paper_attributes$Field_Name
net_bipartite %v% "field_broad" <- paper_attributes$field_broad

# Modo 2 (Autores): Productores de conocimiento
net_bipartite %v% "h_index" <- author_attributes$h_index_std
net_bipartite %v% "avg_c10" <- author_attributes$avg_c10_std
net_bipartite %v% "affiliation" <- author_attributes$Affiliation_Name
net_bipartite %v% "is_latam" <- author_attributes$is_latam
net_bipartite %v% "productivity" <- author_attributes$productivity_std
```


### Visualización de la Estructura Centro-Periferia

Siguiendo a Gondal, la estructura centro-periferia es especialmente relevante en campos emergentes. Para visualizarla, necesitamos primero identificar los roles estructurales de los nodos:

```{r}
#| warning: false

# Configuración de roles estructurales
n_vertices <- network.size(net_bipartite)
bipartite_value <- 161  # Número de papers

# Vector para identificar tipos de nodos
is_actor <- rep(FALSE, n_vertices)
is_actor[(bipartite_value + 1):n_vertices] <- TRUE
net_bipartite %v% "is_actor" <- is_actor

# Etiquetas para visualización
node_labels <- rep("Autor", n_vertices)
node_labels[1:bipartite_value] <- "Paper"
net_bipartite %v% "tipo" <- node_labels

# Calculamos grados para el objeto network
node_degrees <- degree(net_bipartite, gmode="graph")
scaled_degrees <- scales::rescale(node_degrees, to = c(2, 15))

# Asignamos los grados como atributo de vértice
net_bipartite %v% "node_size" <- scaled_degrees

pn <- ggraph(net_bipartite, layout = "graphopt") + 
  # Edges
  geom_edge_link0(edge_colour = "black", 
                  edge_width = 0.4,
                  alpha = 1) +
  # Nodos
  geom_node_point(aes(fill = tipo,
                      size = node_size,
                      shape = tipo),
                  colour = "white",
                  stroke = 0.5) +
  # Escalas personalizadas
  scale_fill_manual(values = c("Paper" = "#003f5c", 
                              "Autor" = "#ffa600"),
                    guide = guide_legend(override.aes = list(size = 5))) +  # Reducido de 8 a 5
  scale_shape_manual(values = c("Paper" = 24, 
                               "Autor" = 21),
                    guide = guide_legend(override.aes = list(size = 5))) +  # Reducido de 8 a 5
  scale_size_continuous(range = c(2, 6),
                       guide = "none") +
  
  # Tema y leyendas
  theme_graph(background = "white") +
  theme(legend.position = "right",
        legend.box.background = element_rect(color = "black", size = 0.3),
        legend.key.size = unit(1, 'cm'),  # Reducido de 1.5 a 1
        legend.key.height = unit(0.8, 'cm'), # Reducido de 1.5 a 1
        legend.key.width = unit(0.6, 'cm'),  # Reducido de 1.5 a 1
        legend.margin = margin(6, 6, 6, 6),
        legend.text = element_text(size = 10),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 11)) +
  
  # Etiquetas
  labs(fill = "Tipo de Entidad",
       shape = "Tipo de Entidad", 
       title = "",
       subtitle = "")

#pn
```


```{r}
#| warning: false
#| message: false

# Primero obtenemos las coordenadas usando layout stress
coords <- create_layout(net_bipartite, layout = "graphopt")

# Obtenemos la lista de bordes del objeto network de forma correcta
edges <- as.matrix.network.edgelist(net_bipartite)

# Creamos los datos para los nodos
nodes_df <- data.frame(
  x = coords$x,
  y = coords$y,
  tipo = net_bipartite %v% "tipo",
  size = net_bipartite %v% "node_size",
  field = net_bipartite %v% "field_broad"
)

# Creamos los datos para los enlaces
edges_df <- data.frame(
  x0 = coords$x[edges[,1]],
  y0 = coords$y[edges[,1]],
  x1 = coords$x[edges[,2]],
  y1 = coords$y[edges[,2]]
)

# Crear el gráfico con plotly
p <- plot_ly() %>%
  # Agregar los enlaces
  add_segments(
    data = edges_df,
    x = ~x0,
    y = ~y0,
    xend = ~x1,
    yend = ~y1,
    line = list(color = "gray80", width = 0.5),
    hoverinfo = "none",
    showlegend = FALSE
  ) %>%
  # Agregar los nodos
  add_markers(
    data = nodes_df,
    x = ~x,
    y = ~y,
    size = ~size,
    color = ~tipo,
    colors = c("#003f5c", "#ffa600"),
    symbol = ~tipo,
    symbols = c("triangle-up", "circle"),
    text = ~paste("Tipo:", tipo,
                 "<br>Field:", field,
                 "<br>Tamaño:", round(size, 2)),
    hoverinfo = "text",
    showlegend = TRUE
  ) %>%
  # Configurar el layout
  layout(
    title = "",
    showlegend = TRUE,
    legend = list(orientation = "h", x = 0, y = -0.1),
    xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
    yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
    hovermode = "closest",
    dragmode = "pan"
  )

p
```


## Propiedades Estructurales de la Red

Siguiendo a Gondal (2011), analizamos tres propiedades estructurales fundamentales de la red bipartita de colaboración científica:

### Estadísticas Descriptivas Básicas

```{r network-stats}
#| output: false

# Estadísticas básicas de la red
summary(net_bipartite, print.adj = FALSE)

# Densidad
network.density(net_bipartite)

# Distancia promedio y diámetro 
geodist <- geodist(net_bipartite)
mean(geodist$gdist[geodist$gdist != Inf])
max(geodist$gdist[geodist$gdist != Inf])
```


```{r}
# Análisis de k-cores
kcores <- kcores(net_bipartite)

# Distribución de k-cores
table(kcores)

# Componentes
components <- component.dist(net_bipartite)
table(components$csize)
```



```{r}
# Crear tabla resumen de estadísticos de red
network_summary <- data.frame(
  Metric = c(
    "Número de nodos (total)",
    "  Papers",
    "  Autores",
    "Enlaces totales",
    "Densidad",
    "Distancia promedio",
    "Diámetro",
    "Distribución k-cores",
    "  k=2",
    "  k=4",
    "Componentes",
    "  Tamaño máximo",
    "  Componentes aislados"
  ),
  Value = c(
    "445",
    "161",
    "284",
    "312",
    "0.003",
    "1.86",
    "8",
    "",
    "424",
    "21",
    "",
    "22",
    "139"
  ),
  Description = c(
    "Total de vértices en la red",
    "Artículos científicos",
    "Investigadores",
    "Vínculos de coautoría",
    "Proporción de vínculos posibles realizados",
    "Número promedio de pasos entre nodos",
    "Máxima distancia entre dos nodos",
    "Distribución de núcleos-k",
    "Nodos con al menos 2 conexiones",
    "Nodos con al menos 4 conexiones",
    "Subgrupos conectados",
    "Tamaño del componente más grande",
    "Número de componentes desconectados"
  )
)

# Mostrar tabla con formato
network_summary %>%
  kable(col.names = c("Métrica", "Valor", "Descripción"),
        caption = "Estadísticas Descriptivas de la Red") %>%
  kable_classic_2(full_width = F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>% 
  pack_rows("Características Básicas", 1, 4) %>%
  pack_rows("Medidas de Cohesión", 5, 7) %>%
  pack_rows("Estructura Núcleo-Periferia", 8, 10) %>%
  pack_rows("Fragmentación", 11, 13)
```


### Análisis de Distribución de Grados

Gondal sugiere que en campos emergentes, la distribución de grados debería mostrar señales de centralización temprana. Específicamente, deberíamos observar:

  - Una alta proporción de autores con pocos vínculos
  - Un pequeño grupo de autores altamente conectados
  - Patrones diferentes entre papers y autores


```{r}
degreedist(net_bipartite)
```


```{r}
# Crear dataframes para cada modo
mode1_data <- data.frame(
  grado = c(0, 1, 2, 3, 4, 5, 6, 8),
  frecuencia = c(284, 80, 45, 20, 8, 4, 1, 3),
  modo = "Modo 1 (Papers)"
)

mode2_data <- data.frame(
  grado = c(0, 1, 2, 3, 4, 5),
  frecuencia = c(161, 264, 15, 3, 1, 1),
  modo = "Modo 2 (Autores)"
)

# Combinar los datos
degree_data <- rbind(mode1_data, mode2_data)

# Crear el gráfico
ggplot(degree_data, aes(x = grado, y = frecuencia, fill = modo)) +
  geom_bar(stat = "identity", position = "dodge", alpha = 0.8) +
  scale_fill_manual(values = c( "#ffa600", "#003f5c")) +
  labs(title = "Distribución de Grados",
       subtitle = "",
       x = "Grado",
       y = "",
       fill = "Entidad") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    legend.position = "bottom"
  ) +
  scale_x_continuous(breaks = 0:8) +
  scale_y_continuous(expand = c(0, 30)) +
  geom_text(aes(label = frecuencia), 
            position = position_dodge(width = 0.9),
            vjust = -0.5,
            size = 3)
```



```{r}
# Para las métricas, usamos funciones de sna
bipartite_metrics <- data.frame(
  node = network.vertex.names(net_bipartite),
  tipo = net_bipartite %v% "tipo",
  degree = degree(net_bipartite, gmode="graph"),
  betweenness = betweenness(net_bipartite),
  eigenvector = evcent(net_bipartite)
) %>%
  group_by(tipo) %>%
  summarise(
    avg_degree = mean(degree),
    max_degree = max(degree),
    avg_betweenness = mean(betweenness),
    avg_eigenvector = mean(eigenvector)
  )

kable(as_tibble(bipartite_metrics), caption = "Resumen centralidad por entidad") %>% 
  kable_classic_2(full_width = F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```





## Análisis ERGM: Modelando Mecanismos Generativos


Siguiendo a Gondal (2011), el modelamiento ERGM nos permite examinar los mecanismos micro que generan las estructuras macro observadas. Desarrollamos una estrategia de modelamiento en cuatro etapas, cada una capturando diferentes aspectos teóricos:

  1. **Modelo Base**: Examina la tendencia base a formar vínculos y el efecto de los campos disciplinares
  2. **Modelo de Grados**: Incorpora la geometría ponderada de grados para capturar centralización
  3. **Modelo con Covariables**: Agrega atributos nodales como disrupción y productividad
  4. **Modelo Final**: Integra efectos de interacción y homofilia disciplinar


```{r}
# Usar el 75% de los núcleos disponibles
num_cores <- parallel::detectCores() - 1

# Si quieres ver cuántos núcleos se usarán
cat("Usando", num_cores, "de", parallel::detectCores(), "núcleos disponibles\n")

# 1. Modelo simple (mantenemos igual como base)
model_simple <- ergm(
  net_bipartite ~ edges + b1factor("field_broad"),
  control = control.ergm(
    MCMLE.maxit = 5,
    MCMC.samplesize = 1000,
    MCMLE.termination = "Hummel"
  )
)

# 2. Modelo con términos de grado (mantenemos igual)
model_degrees <- ergm(
  net_bipartite ~ 
    edges +
    gwb1degree(decay = 0.25, fixed = T) +
    gwb2degree(decay = 0.25, fixed = T) +
    b1factor("field_broad"),
  control = control.ergm(
    init = c(coef(model_simple), rep(0, 2)),
    MCMLE.maxit = 10,
    MCMC.samplesize = 2000,
    MCMLE.termination = "Hummel"
  )
)

# 3. Modelo con covariables (mantenemos igual)
model_covars <- ergm(
  net_bipartite ~ 
    edges +
    gwb1degree(decay = 0.25, fixed = T) +
    gwb2degree(decay = 0.25, fixed = T) +
    b1factor("field_broad") +
    b1cov("disruption") +
    b2cov("productivity"),
  control = control.ergm(
    init = c(coef(model_degrees), rep(0, 2)),
    MCMLE.maxit = 15,
    MCMC.samplesize = 3000,
    MCMLE.termination = "Hummel"
  )
)

# 4. Modelo final con nodemix (en vez de nodematch)
model_final <- ergm(
  net_bipartite ~ 
    edges +
    gwb1degree(decay = 0.25, fixed = T) +
    gwb2degree(decay = 0.25, fixed = T) +
    b1cov("disruption") +
    b2cov("productivity") +
    nodemix("field_broad") +           # Cambiado de b1factor a b1mix
    b1cov("disruption"):b2cov("productivity"),
  control = control.ergm(
    init = c(coef(model_covars), rep(0, 3)),
    MCMLE.maxit = 30,
    MCMC.burnin = 75000,
    MCMC.interval = 1500,
    MCMC.samplesize = 12500,
    MCMLE.density.guard = 40,
    MCMLE.sequential = TRUE,
    MCMLE.steplength = 1,
    MCMLE.steplength.margin = 0.5,
    MCMLE.termination = "Hummel",
    parallel = num_cores,
    parallel.type = "PSOCK",
    seed = 123
  )
)
```


```{r}
summary(model_final)
```


### Diagnósticos del Modelo

```{r model-diagnostics}
#| fig-width: 10
#| fig-height: 8

# Bondad de ajuste
gof_model <- gof(model_final)
plot(gof_model)
```


```{r}
# MCMC diagnósticos
mcmc.diagnostics(model_final)
```


## Interpretación de Resultados del ERGM

Los resultados del modelo permiten evaluar nuestras hipótesis sobre la estructura del campo científico:

- **H1: Estructura Base y Centralización**

Los resultados confirman parcialmente esta hipótesis. El coeficiente negativo y significativo de edges (β = -9.76, p < 0.001) indica una baja densidad base en la red, consistente con la predicción de Gondal [-@gondalLocalGlobalStructure2011] sobre la incertidumbre estructural en campos emergentes. Sin embargo, la centralización muestra un patrón más complejo que el esperado:

Tanto papers (gwb1deg: β = 3.15, p < 0.001) como autores (gwb2deg: β = 8.36, p < 0.001) muestran tendencias significativas a la centralización. La magnitud es notablemente mayor para autores, sugiriendo un rol más prominente en la estructuración del campo. 

- **H2: Asimetría Disciplinar**

La hipótesis sobre asimetría disciplinar se confirma con matices importantes. Los resultados muestran patrones direccionales claros:

- Papers STEM -> autores SHAPE (β = 1.11, p < 0.001)
- Papers STEM -> autores STEM (β = 1.24, p < 0.01)
- Papers SHAPE -> autores STEM (β = 0.32, p = 0.433, no significativo)

Esto refina la tesis de Friedkin [-@friedkinStructuralTheorySocial1998] sobre "consensos superpuestos", sugiriendo que la integración del conocimiento es direccional, con STEM jugando un rol más activo en tender puentes interdisciplinares.

- **H3: Dinámica Centro-Periferia y Disrupción**

Contrario a lo predicho por Li et al. [-@liProductiveScientistsAre2024a], no encontramos evidencia de una relación significativa entre:

- Disrupción y formación de vínculos (β = 0.04, p = 0.607)
- Productividad y formación de vínculos (β = -0.18, p = 0.336)
- Su interacción (β = -0.04, p = 0.459)

Esto sugiere que la relación entre posición estructural y capacidad disruptiva puede ser más compleja que lo inicialmente teorizado.

- **H4: Evolución Temporal y Campos Emergentes**

La evidencia sobre la evolución temporal es mixta. La significativa centralización en ambos modos (gwb1deg y gwb2deg) sugiere que el campo ha establecido mecanismos de legitimación, pero los patrones de interacción disciplinar indican una estructura más compleja que la simple centralización-periferia propuesta por Gondal [-@gondalLocalGlobalStructure2011].
H5: Integración Disciplinar Asimétrica

Esta hipótesis recibe el apoyo más fuerte. Los campos STEM muestran una clara capacidad de integración:

- Mantienen cohesión interna significativa (STEM-STEM: β = 1.24, p < 0.01)
- Generan vínculos significativos con SHAPE (STEM-SHAPE: β = 1.11, p < 0.001)
- Esta capacidad es asimétrica, ya que SHAPE->STEM no es significativo

## Implicaciones Teóricas

### Refinamiento de la Teoría de Campos Emergentes:

Los resultados sugieren que la teoría de Gondal [-@gondalLocalGlobalStructure2011] necesita ser refinada para incorporar:

- Centralización multi-modal
- Asimetrías direccionales en la integración disciplinar
- Roles estructurales diferenciados por campo

### Reconsideración de la Relación Disrupción-Estructura:

La ausencia de efectos significativos para disrupción y productividad sugiere que el marco de Li et al. [-@liProductiveScientistsAre2024a] necesita ser reconsiderado en el contexto de redes modo-2, donde la relación entre posición estructural e innovación puede operar de manera diferente.

### Estructuras Híbridas y Tensiones Productivas:

El patrón observado sugiere que los campos emergentes desarrollan estructuras híbridas caracterizadas por:

- Centralización significativa en ambos modos
- Integración disciplinar asimétrica
- Patrones de colaboración direccionales


## Limitaciones y Trabajo Futuro

  - Extensión temporal del análisis
  - Incorporación de medidas alternativas de disrupción
  - Análisis de sensibilidad con diferentes especificaciones de modelo



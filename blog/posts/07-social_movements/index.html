<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roberto Cantillan">
<meta name="dcterms.date" content="2024-11-13">

<title>Poder, Coaliciones y Vínculos Múltiples en la Movilización Urbana – Roberto Cantillan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/bootstrap-icons-1.9.1/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: rgba(0,38,66,0.75);
      }

      .quarto-title-block .quarto-title-banner {
        color: rgba(0,38,66,0.75);
background-image: url(featured.jpg);
background-size: cover;
      }
</style>
<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg border-bottom" data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/noun-small-world-network-6148828.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Roberto Cantillan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../talk/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../publication/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../project/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rcantillan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Poder, Coaliciones y Vínculos Múltiples en la Movilización Urbana</h1>
            <p class="subtitle lead">El Conflicto por el Plan Regulador de Peñalolén 2011</p>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Networks</div>
                <div class="quarto-category">ERGM</div>
                <div class="quarto-category">Social Movements</div>
                <div class="quarto-category">Contentious polítics</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Roberto Cantillan </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Sociology, PUC
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 13, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#theoretical-framework" id="toc-theoretical-framework" class="nav-link" data-scroll-target="#theoretical-framework">Theoretical Framework</a>
  <ul class="collapse">
  <li><a href="#networks-and-contentious-politics" id="toc-networks-and-contentious-politics" class="nav-link" data-scroll-target="#networks-and-contentious-politics">Networks and Contentious Politics</a></li>
  <li><a href="#multiplex-ties-and-movement-integration" id="toc-multiplex-ties-and-movement-integration" class="nav-link" data-scroll-target="#multiplex-ties-and-movement-integration">Multiplex Ties and Movement Integration</a></li>
  <li><a href="#boundary-mechanisms-and-network-evolution" id="toc-boundary-mechanisms-and-network-evolution" class="nav-link" data-scroll-target="#boundary-mechanisms-and-network-evolution">Boundary Mechanisms and Network Evolution</a></li>
  <li><a href="#complex-diffusion-in-movement-networks" id="toc-complex-diffusion-in-movement-networks" class="nav-link" data-scroll-target="#complex-diffusion-in-movement-networks">Complex Diffusion in Movement Networks</a></li>
  </ul></li>
  <li><a href="#hypotheses" id="toc-hypotheses" class="nav-link" data-scroll-target="#hypotheses">Hypotheses</a></li>
  </ul></li>
  <li><a href="#data-and-methods" id="toc-data-and-methods" class="nav-link" data-scroll-target="#data-and-methods">Data and Methods</a>
  <ul class="collapse">
  <li><a href="#research-design" id="toc-research-design" class="nav-link" data-scroll-target="#research-design">Research Design</a></li>
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data Collection</a></li>
  <li><a href="#networks-and-attributes" id="toc-networks-and-attributes" class="nav-link" data-scroll-target="#networks-and-attributes">Networks and Attributes</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#estrategia-analítica" id="toc-estrategia-analítica" class="nav-link" data-scroll-target="#estrategia-analítica">Estrategia Analítica</a></li>
  </ul></li>
  <li><a href="#resultados" id="toc-resultados" class="nav-link" data-scroll-target="#resultados">Resultados</a>
  <ul class="collapse">
  <li><a href="#descriptivos" id="toc-descriptivos" class="nav-link" data-scroll-target="#descriptivos">Descriptivos</a>
  <ul class="collapse">
  <li><a href="#red" id="toc-red" class="nav-link" data-scroll-target="#red">Red</a></li>
  <li><a href="#actores" id="toc-actores" class="nav-link" data-scroll-target="#actores">Actores</a></li>
  <li><a href="#equivalencia-estructural" id="toc-equivalencia-estructural" class="nav-link" data-scroll-target="#equivalencia-estructural">Equivalencia estructural</a></li>
  </ul></li>
  <li><a href="#ergm" id="toc-ergm" class="nav-link" data-scroll-target="#ergm">ERGM</a></li>
  <li><a href="#difusión" id="toc-difusión" class="nav-link" data-scroll-target="#difusión">Difusión</a>
  <ul class="collapse">
  <li><a href="#cargamos-datos" id="toc-cargamos-datos" class="nav-link" data-scroll-target="#cargamos-datos">Cargamos datos</a></li>
  <li><a href="#función-para-proceso-de-difusión" id="toc-función-para-proceso-de-difusión" class="nav-link" data-scroll-target="#función-para-proceso-de-difusión">Función para proceso de difusión</a></li>
  <li><a href="#función-para-plotear" id="toc-función-para-plotear" class="nav-link" data-scroll-target="#función-para-plotear">Función para plotear</a></li>
  <li><a href="#ejecutar-funciones" id="toc-ejecutar-funciones" class="nav-link" data-scroll-target="#ejecutar-funciones">Ejecutar funciones</a></li>
  <li><a href="#simulaciones-heterogeneous-thresholds-true" id="toc-simulaciones-heterogeneous-thresholds-true" class="nav-link" data-scroll-target="#simulaciones-heterogeneous-thresholds-true">Simulaciones heterogeneous thresholds = TRUE</a></li>
  </ul></li>
  <li><a href="#relaciones-múltiples" id="toc-relaciones-múltiples" class="nav-link" data-scroll-target="#relaciones-múltiples">Relaciones múltiples</a></li>
  <li><a href="#discusión" id="toc-discusión" class="nav-link" data-scroll-target="#discusión">Discusión</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Urban social movements represent complex networks of relationships between heterogeneous actors who coordinate collective action through multiple types of ties (Diani, 2015). The conflict over Peñalolén’s Master Plan in 2011 provides an exemplary case to analyze how these multiplex networks facilitate the emergence and diffusion of contentious political identities, enabling broad coalition formation among diverse urban actors.</p>
<section id="theoretical-framework" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-framework">Theoretical Framework</h2>
<section id="networks-and-contentious-politics" class="level3">
<h3 class="anchored" data-anchor-id="networks-and-contentious-politics">Networks and Contentious Politics</h3>
<p>Our analysis integrates two complementary theoretical perspectives: social movement networks and contentious politics. From a network perspective, movements emerge from dense webs of multiplex relationships that facilitate resource mobilization and sustain collective identities (Diani, 2003; Mische, 2003). These networks serve both instrumental and symbolic functions - channeling resources while also cultivating shared interpretive frames (Passy &amp; Giugni, 2001).</p>
<p>The contentious politics approach emphasizes how political opportunities and threats trigger episodes of contention through mechanisms like boundary activation and polarization (McAdam et al., 2001; Tilly &amp; Tarrow, 2015). These mechanisms operate through relational processes of brokerage and scale shift that connect previously disparate actors into broader coalitions (Tarrow, 2005).</p>
</section>
<section id="multiplex-ties-and-movement-integration" class="level3">
<h3 class="anchored" data-anchor-id="multiplex-ties-and-movement-integration">Multiplex Ties and Movement Integration</h3>
<p>Following Gould’s (1991) seminal work, we conceptualize tie multiplexity not merely as a descriptive network feature but as a fundamental mechanism that:</p>
<ol type="1">
<li>Generates structural resistance to demobilization</li>
<li>Facilitates coordination between diverse actors<br>
</li>
<li>Produces mutual reinforcement between different types of relationships</li>
</ol>
<p>This multiplexity operates at both micro and macro levels. At the micro level, multiple ties between specific organizations reinforce commitments and reduce uncertainty in interactions (Baldassarri &amp; Diani, 2007). At the macro level, multiplexity increases overall network robustness and enables the integration of different organizational clusters while sustaining broader collective identities (Diani, 2015).</p>
</section>
<section id="boundary-mechanisms-and-network-evolution" class="level3">
<h3 class="anchored" data-anchor-id="boundary-mechanisms-and-network-evolution">Boundary Mechanisms and Network Evolution</h3>
<p>Drawing on Tilly (2004), we analyze how boundary change mechanisms shape movement dynamics through:</p>
<ol type="1">
<li>Inscription-Erasure: The creation/dissolution of social boundaries</li>
<li>Activation-Deactivation: Changes in the salience of existing boundaries</li>
<li>Site Transfer: Relocation of actors relative to boundaries</li>
<li>Relocation: Shifts in boundary-organizing relations</li>
</ol>
<p>These mechanisms interact with network structures to shape patterns of diffusion and coalition formation (Tilly &amp; Tarrow, 2015).</p>
</section>
<section id="complex-diffusion-in-movement-networks" class="level3">
<h3 class="anchored" data-anchor-id="complex-diffusion-in-movement-networks">Complex Diffusion in Movement Networks</h3>
<p>Recent work on complex contagion demonstrates that the spread of contentious behaviors through networks depends on:</p>
<ol type="1">
<li>Multiple exposures through redundant ties (Centola &amp; Macy, 2007)</li>
<li>Local clustering that provides social reinforcement (Centola, 2018)</li>
<li>Strong ties that sustain costly forms of activism (McAdam &amp; Paulsen, 1993)</li>
</ol>
<p>This suggests that multiplex ties may be particularly important for the diffusion of contentious identities and practices.</p>
</section>
</section>
<section id="hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="hypotheses">Hypotheses</h2>
<p>Building on this theoretical framework, we propose four hypotheses:</p>
<p>H1: Structural Effects - Network formation will exhibit significant transitivity (GWESP) - Degree distributions will be relatively homogeneous (GWDegree)</p>
<p>H2: Conditional Homophily<br>
- Organizational type homophily will be stronger for trust/values ties than instrumental ties - Structural block homophily will moderate organizational type homophily</p>
<p>H3: Strategic Multiplexity - Multiple ties increase the probability of new tie formation - This effect is stronger between organizations of different types/blocks</p>
<p>H4: Complex Diffusion - Adoption of contentious positions requires multiple exposures - Local clustering positively moderates adoption probability - Triadic structures are more effective than dyadic ones</p>
</section>
</section>
<section id="data-and-methods" class="level1">
<h1>Data and Methods</h1>
<section id="research-design" class="level2">
<h2 class="anchored" data-anchor-id="research-design">Research Design</h2>
<p>We employ a mixed-methods design (Domínguez &amp; Hollstein, 2014) combining social network analysis with qualitative contextual data. Our approach conceptualizes relational structure as a multidimensional space of social positions in which population members are non-randomly distributed (Scott, 2011).</p>
</section>
<section id="data-collection" class="level2">
<h2 class="anchored" data-anchor-id="data-collection">Data Collection</h2>
<p>Data was collected during 2017-2018 through:</p>
<ol type="1">
<li>Network Surveys (N=31)
<ul>
<li>Name generator limited to 5 nominations</li>
<li>Multiple tie types</li>
<li>Organizational attributes</li>
</ul></li>
<li>In-depth Interviews (N=12)
<ul>
<li>Key informants</li>
<li>Conflict history</li>
<li>Coordination dynamics</li>
</ul></li>
<li>Documentary Sources
<ul>
<li>Local press coverage</li>
<li>Organizational documents</li>
<li>Meeting minutes</li>
</ul></li>
</ol>
<p>The sampling strategy combined:</p>
<ul>
<li>Initial identification of organization types</li>
<li>Snowball sampling until saturation (40% name repetition)</li>
<li>Secondary source validation</li>
</ul>
</section>
<section id="networks-and-attributes" class="level2">
<h2 class="anchored" data-anchor-id="networks-and-attributes">Networks and Attributes</h2>
<p>We analyze five types of ties between 70 organizations:</p>
<ol type="1">
<li>Cooperation (joint activities)</li>
<li>Trust (historical bonds)</li>
<li>Resources (material support)</li>
<li>Values (interpretive frames)</li>
<li>Kinship (family ties)</li>
</ol>
</section>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations</h2>
<p>Important methodological limitations include:</p>
<ol type="1">
<li>Temporal bias from retrospective data collection</li>
<li>Potential underrepresentation of peripheral actors</li>
<li>Artificial cap on nominations (5)</li>
<li>Difficulty capturing tie intensity</li>
</ol>
</section>
<section id="estrategia-analítica" class="level2">
<h2 class="anchored" data-anchor-id="estrategia-analítica">Estrategia Analítica</h2>
<ol type="1">
<li><strong>Análisis Descriptivo:</strong>
<ul>
<li>Medidas de centralidad</li>
<li>Detección de bloques</li>
<li>Análisis de multiplexidad</li>
</ul></li>
<li><strong>Modelación ERGM:</strong>
<ul>
<li>Efectos estructurales</li>
<li>Homofilia condicional</li>
<li>Interacción entre vínculos</li>
</ul></li>
<li><strong>Modelo de Difusión:</strong>
<ul>
<li>Contagio complejo</li>
<li>Umbrales heterogéneos</li>
<li>Efectos de estructura local</li>
</ul></li>
</ol>
</section>
</section>
<section id="resultados" class="level1">
<h1>Resultados</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Installed ReposVer Built  
ergm.ego "1.1.0"   "1.1.1"  "4.4.1"
sna      "2.7-2"   "2.8"    "4.4.0"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ergm)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(network)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(concorR)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="descriptivos" class="level2">
<h2 class="anchored" data-anchor-id="descriptivos">Descriptivos</h2>
<section id="red" class="level3">
<h3 class="anchored" data-anchor-id="red">Red</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer y preparar las matrices</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>coop_matrix <span class="ot">&lt;-</span>       <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/CoopNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trust_matrix <span class="ot">&lt;-</span>      <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/ConfianzaNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>resources_matrix <span class="ot">&lt;-</span>  <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/RecursosNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>values_matrix <span class="ot">&lt;-</span>     <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/ValoresNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>parentesco_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/ParentescoNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer atributos</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Atributos _org2011.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar si las redes son dirigidas</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>is_directed <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cooperacion =</span> <span class="sc">!</span><span class="fu">isSymmetric</span>(coop_matrix),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Confianza =</span> <span class="sc">!</span><span class="fu">isSymmetric</span>(trust_matrix),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Recursos =</span> <span class="sc">!</span><span class="fu">isSymmetric</span>(resources_matrix),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valores =</span> <span class="sc">!</span><span class="fu">isSymmetric</span>(values_matrix),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parentesco =</span> <span class="sc">!</span><span class="fu">isSymmetric</span>(parentesco_matrix)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Verificación de direccionalidad de las redes:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Verificación de direccionalidad de las redes:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unlist</span>(is_directed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cooperacion   Confianza    Recursos     Valores  Parentesco 
       TRUE        TRUE        TRUE        TRUE        TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de todas las matrices para análisis</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>matrices_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cooperacion =</span> coop_matrix,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Confianza =</span> trust_matrix,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Recursos =</span> resources_matrix,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valores =</span> values_matrix,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parentesco =</span> parentesco_matrix</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">map_lgl</span>(matrices_list, is.matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cooperacion   Confianza    Recursos     Valores  Parentesco 
       TRUE        TRUE        TRUE        TRUE        TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_lgl</span>(matrices_list, <span class="cf">function</span>(x) <span class="fu">nrow</span>(x) <span class="sc">==</span> <span class="fu">ncol</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cooperacion   Confianza    Recursos     Valores  Parentesco 
       TRUE        TRUE        TRUE        TRUE        TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Estadísticas descriptivas de las redes:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nEstadísticas descriptivas de las redes:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(matrices_list, <span class="cf">function</span>(x) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(x, <span class="at">mode=</span><span class="st">"directed"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Densidad =</span> <span class="fu">edge_density</span>(g),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_lazos =</span> <span class="fu">sum</span>(x),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_nodos_activos =</span> <span class="fu">sum</span>(<span class="fu">rowSums</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reciprocidad =</span> <span class="fu">reciprocity</span>(g),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitivity =</span> <span class="fu">transitivity</span>(g),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Componentes =</span> <span class="fu">count_components</span>(g),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diametro =</span> <span class="fu">diameter</span>(g, <span class="at">directed=</span><span class="cn">TRUE</span>, <span class="at">weights=</span><span class="cn">NA</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Red"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Red</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Densidad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N_lazos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N_nodos_activos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Reciprocidad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Componentes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Diametro</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cooperacion</td>
<td style="text-align: right;">0.0291925</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0.4397163</td>
<td style="text-align: right;">0.3434705</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Confianza</td>
<td style="text-align: right;">0.0260870</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.3492063</td>
<td style="text-align: right;">0.3807692</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recursos</td>
<td style="text-align: right;">0.0198758</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.2291667</td>
<td style="text-align: right;">0.2601626</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valores</td>
<td style="text-align: right;">0.0271222</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.4427481</td>
<td style="text-align: right;">0.3306122</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Parentesco</td>
<td style="text-align: right;">0.0095238</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.3043478</td>
<td style="text-align: right;">0.2553191</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="network-structure-and-organizational-field" class="level4">
<h4 class="anchored" data-anchor-id="network-structure-and-organizational-field">Network Structure and Organizational Field</h4>
<p>Our analysis of network structure reveals a clear organizational field configuration characterized by differential density patterns across network types. These patterns suggest a hierarchical integration of the field, where:</p>
</section>
<section id="political-organizations-dominance" class="level4">
<h4 class="anchored" data-anchor-id="political-organizations-dominance">Political Organizations Dominance:</h4>
<ul>
<li>MPL (Movimiento de Pobladores en Lucha) shows highest indegree (13)</li>
<li>OCAP (Organización política de base) follows with high centrality (7)</li>
<li>Housing committees (CV_BrillaElSol) maintain significant positions (6)</li>
</ul>
<p>[Quote opportunity: MPL leader discussing their role in coordinating different organizations]</p>
</section>
</section>
<section id="actores" class="level3">
<h3 class="anchored" data-anchor-id="actores">Actores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear objeto network con atributos</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>net_coop <span class="ot">&lt;-</span> <span class="fu">network</span>(coop_matrix, <span class="at">directed=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar atributos a la red</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>net_coop <span class="sc">%v%</span> <span class="st">"tipo"</span> <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Tipo_de_organización</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>net_coop <span class="sc">%v%</span> <span class="st">"ubicacion"</span> <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Ubicación</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>net_coop <span class="sc">%v%</span> <span class="st">"orientacion"</span> <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Orientación</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular medidas de centralidad</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>cent_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Organizacion =</span> attributes<span class="sc">$</span>Nombre,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo =</span> attributes<span class="sc">$</span>Tipo_de_organización,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Orientacion =</span> attributes<span class="sc">$</span>Orientación,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Centralidades</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Degree =</span> sna<span class="sc">::</span><span class="fu">degree</span>(net_coop, <span class="at">gmode=</span><span class="st">"digraph"</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Indegree =</span> sna<span class="sc">::</span><span class="fu">degree</span>(net_coop, <span class="at">gmode=</span><span class="st">"digraph"</span>, <span class="at">cmode=</span><span class="st">"indegree"</span>),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outdegree =</span> sna<span class="sc">::</span><span class="fu">degree</span>(net_coop, <span class="at">gmode=</span><span class="st">"digraph"</span>, <span class="at">cmode=</span><span class="st">"outdegree"</span>),</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Betweenness =</span> sna<span class="sc">::</span><span class="fu">betweenness</span>(net_coop),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Eigenvector =</span> sna<span class="sc">::</span><span class="fu">evcent</span>(net_coop)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 actores más centrales según diferentes medidas</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Top 10 actores según Indegree:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Top 10 actores según Indegree:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cent_df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Indegree)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organizacion, Tipo, Indegree) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Organizacion</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Tipo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Indegree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OPP_MPL</td>
<td style="text-align: left;">Organización política de pobladores</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_OCAP</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CV_BrillaElSol</td>
<td style="text-align: left;">Comité de vivienda</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">OC_RAP</td>
<td style="text-align: left;">Organización cultural</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OC_Murgarte</td>
<td style="text-align: left;">Organización cultural</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_AlexLemún</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OPB_RIP</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_CristoJoven</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OPP_MUA</td>
<td style="text-align: left;">Organización política de pobladores</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">OV_JJVV_n°19_Bolivar</td>
<td style="text-align: left;">Organización vecinal</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top 10 actores según Betweenness:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nTop 10 actores según Betweenness:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cent_df <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Betweenness)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organizacion, Tipo, Betweenness) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Organizacion</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Tipo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Betweenness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OPP_MPL</td>
<td style="text-align: left;">Organización política de pobladores</td>
<td style="text-align: right;">497.7976</td>
</tr>
<tr class="even">
<td style="text-align: left;">OV_JJVV_ComunidadEcológica</td>
<td style="text-align: left;">Organización vecinal</td>
<td style="text-align: right;">385.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CV_LosColgados</td>
<td style="text-align: left;">Comité de vivienda</td>
<td style="text-align: right;">337.7976</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_RIP</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">218.9643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gob_Mun</td>
<td style="text-align: left;">Otros</td>
<td style="text-align: right;">199.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_AlexLemún</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">198.4405</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CV_BrillaElSol</td>
<td style="text-align: left;">Comité de vivienda</td>
<td style="text-align: right;">176.3214</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_OCAP</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">134.9405</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OPP_MUA</td>
<td style="text-align: left;">Organización política de pobladores</td>
<td style="text-align: right;">125.4881</td>
</tr>
<tr class="even">
<td style="text-align: left;">OPB_CristoJoven</td>
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">113.5714</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis de centralidad por tipo de organización</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cent_by_type <span class="ot">&lt;-</span> cent_df <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Indegree =</span> <span class="fu">mean</span>(Indegree),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Betweenness =</span> <span class="fu">mean</span>(Betweenness),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Centralidad promedio por tipo de organización:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nCentralidad promedio por tipo de organización:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cent_by_type <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Tipo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean_Indegree</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean_Betweenness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Club deportivo</td>
<td style="text-align: right;">0.750000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Comité de vivienda</td>
<td style="text-align: right;">2.444444</td>
<td style="text-align: right;">60.16138</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Organización cultural</td>
<td style="text-align: right;">1.923077</td>
<td style="text-align: right;">24.18498</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Organización política de base</td>
<td style="text-align: right;">4.166667</td>
<td style="text-align: right;">119.85119</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Organización política de pobladores</td>
<td style="text-align: right;">4.333333</td>
<td style="text-align: right;">126.24008</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Organización vecinal</td>
<td style="text-align: right;">1.111111</td>
<td style="text-align: right;">22.11464</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Otros</td>
<td style="text-align: right;">2.000000</td>
<td style="text-align: right;">51.90000</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="structural-differentiation-core-political-organizations-average-higher-betweenness-centrality-119.85-for-political-base-organizations-126.24-for-pobladores-organizations-compared-to-neighborhood-organizations-22.11." class="level4">
<h4 class="anchored" data-anchor-id="structural-differentiation-core-political-organizations-average-higher-betweenness-centrality-119.85-for-political-base-organizations-126.24-for-pobladores-organizations-compared-to-neighborhood-organizations-22.11.">Structural Differentiation: Core political organizations average higher betweenness centrality (119.85 for political base organizations, 126.24 for pobladores organizations) compared to neighborhood organizations (22.11).</h4>
</section>
</section>
<section id="equivalencia-estructural" class="level3">
<h3 class="anchored" data-anchor-id="equivalencia-estructural">Equivalencia estructural</h3>
<p>The CONCOR analysis identified four distinct blocks:</p>
<section id="political-strategic-block-18-organizations" class="level4">
<h4 class="anchored" data-anchor-id="political-strategic-block-18-organizations">Political-Strategic Block (18 organizations):</h4>
<ul>
<li>9 Housing Committees</li>
<li>4 Cultural Organizations</li>
<li>4 Sports Clubs</li>
<li>1 Municipal Actor</li>
</ul>
</section>
<section id="cultural-tactical-block-13-organizations" class="level4">
<h4 class="anchored" data-anchor-id="cultural-tactical-block-13-organizations">Cultural-Tactical Block (13 organizations):</h4>
<ul>
<li>8 Cultural Organizations</li>
<li>1 Political Base Organization</li>
<li>4 Others</li>
</ul>
</section>
<section id="base-organization-block-14-organizations" class="level4">
<h4 class="anchored" data-anchor-id="base-organization-block-14-organizations">Base Organization Block (14 organizations):</h4>
<ul>
<li>6 Pobladores Organizations</li>
<li>5 Base Political Organizations</li>
<li>3 Neighborhood Organizations</li>
</ul>
</section>
<section id="neighborhood-block-15-organizations" class="level4">
<h4 class="anchored" data-anchor-id="neighborhood-block-15-organizations">Neighborhood Block (15 organizations):</h4>
<ul>
<li>Exclusively neighborhood organizations</li>
</ul>
<p>[Quote opportunity: Description of different organizational roles in the movement]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer datos</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>coop_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/CoopNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Atributos _org2011.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar CONCOR</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>bloques <span class="ot">&lt;-</span> <span class="fu">concor</span>(<span class="fu">list</span>(coop_matrix), <span class="at">cutoff=</span><span class="fl">0.8</span>, <span class="at">nsplit=</span><span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver composición de los bloques</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">BLOQUE"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"---------------</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    organizaciones <span class="ot">&lt;-</span> attributes[bloques <span class="sc">==</span> i, ]</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">table</span>(organizaciones<span class="sc">$</span>Tipo))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Organizaciones específicas:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(organizaciones<span class="sc">$</span>Nombre)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

BLOQUE 1 
---------------

2 5 6 7 
9 4 4 1 

Organizaciones específicas:
 [1] "CD_AvanceDeCarvallo"       "CD_CristoJovén"           
 [3] "CD_RealHéroes"             "CD_SanLuisDelElqui"       
 [5] "CV_BrillaElSol"            "CV_CaminoALaVictoria"     
 [7] "CV_CasaDigna"              "CV_CoordAllegados"        
 [9] "CV_LosColgados"            "CV_PasoSeguro"            
[11] "CV_PorUnaVidaMejor"        "CV_UnaEsperanzaEnElFuturo"
[13] "CV_volverAEmpezar"         "Gob_Mun"                  
[15] "OC_ ClubCientífico"        "OC_Barracón"              
[17] "OC_CircoChino"             "OC_EncuentroAndino"       


BLOQUE 2 
---------------

4 5 7 
1 8 4 

Organizaciones específicas:
 [1] "OC_GenteDelSur"            "OC_ManzoPiño"             
 [3] "OC_Murgarte"               "OC_PasiónPorMiTierra"     
 [5] "OC_PorLaMemoriaHistórica"  "OC_RadioEncuentro(tv8)"   
 [7] "OC_RAP"                    "OC_Yanawara"              
 [9] "OG_ColegioDeArquitectos"   "ONG_DefendamosLaCiudad"   
[11] "ONG_PACc"                  "OP_AsociaciónMicrobuseros"
[13] "OPB_AlexLemún"            


BLOQUE 3 
---------------

1 3 4 
3 6 5 

Organizaciones específicas:
 [1] "OPB_CristoJoven"             "OPB_GrfemAuto"              
 [3] "OPB_OCAP"                    "OPB_RecupHermida"           
 [5] "OPB_RIP"                     "OPP_FENAPO"                 
 [7] "OPP_MPL"                     "OPP_MPLD"                   
 [9] "OPP_MPST"                    "OPP_MUA"                    
[11] "OPP_PIgualdad"               "OV_AP_LosJardinesDeVespucio"
[13] "OV_CD_ReactivaciónEnMasas"   "OV_CD_VillaSolNaciente"     


BLOQUE 4 
---------------

 1 
15 

Organizaciones específicas:
 [1] "OV_ComSeguridadSM"               "OV_CVD_VillaAlboradaNuevaPalena"
 [3] "OV_JI_ManosyNaturaleza"          "OV_JJVV_ComunidadEcológica"     
 [5] "OV_JJVV_CordilleraNevada"        "OV_JJVV_LaCordillera"           
 [7] "OV_JJVV_n°11_LaFaena"            "OV_JJVV_n°12_LaFaena"           
 [9] "OV_JJVV_n°14_Parque1"            "OV_JJVV_n°17_IsabelRiquelme"    
[11] "OV_JJVV_n°18"                    "OV_JJVV_n°19_Bolivar"           
[13] "OV_JJVV_n°19_Heroes"             "OV_JJVV_n°29_LoHerAlto"         
[15] "OV_JJVV_PortalDelSol"           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular densidades entre bloques</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>block_density <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        nodes_i <span class="ot">&lt;-</span> <span class="fu">which</span>(bloques <span class="sc">==</span> i)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        nodes_j <span class="ot">&lt;-</span> <span class="fu">which</span>(bloques <span class="sc">==</span> j)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(nodes_i) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(nodes_j) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>            block_density[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(coop_matrix[nodes_i, nodes_j]) <span class="sc">/</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                                 (<span class="fu">length</span>(nodes_i) <span class="sc">*</span> <span class="fu">length</span>(nodes_j))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar densidades</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Densidad entre bloques:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Densidad entre bloques:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(block_density, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] 0.056 0.009 0.044 0.022
[2,] 0.000 0.077 0.033 0.026
[3,] 0.048 0.044 0.112 0.010
[4,] 0.007 0.026 0.024 0.036</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular cohesión de bloques</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Cohesión Bloque"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    internal <span class="ot">&lt;-</span> block_density[i,i]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    external <span class="ot">&lt;-</span> <span class="fu">mean</span>(block_density[i,<span class="sc">-</span>i])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    ei_index <span class="ot">&lt;-</span> (external <span class="sc">-</span> internal)<span class="sc">/</span>(external <span class="sc">+</span> internal)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Densidad interna:"</span>, <span class="fu">round</span>(internal, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Densidad externa media:"</span>, <span class="fu">round</span>(external, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Índice E-I:"</span>, <span class="fu">round</span>(ei_index, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Cohesión Bloque 1 
Densidad interna: 0.056 
Densidad externa media: 0.025 
Índice E-I: -0.383 


Cohesión Bloque 2 
Densidad interna: 0.077 
Densidad externa media: 0.02 
Índice E-I: -0.595 


Cohesión Bloque 3 
Densidad interna: 0.112 
Densidad externa media: 0.034 
Índice E-I: -0.538 


Cohesión Bloque 4 
Densidad interna: 0.036 
Densidad externa media: 0.019 
Índice E-I: -0.305 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Preparar datos para el heatmap de densidades entre bloques</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>density_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Bloque"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Bloque"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">as.vector</span>(block_density))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Preparar datos para la composición de bloques</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>composicion_bloques <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bloque =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>)),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo =</span> <span class="fu">c</span>(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Comite Vivienda"</span>,<span class="st">"Org. Cultural"</span>,<span class="st">"Club Deportivo"</span>,<span class="st">"Gob. Municipal"</span>), <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>)), <span class="co"># Bloque 1</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Org. Política Base"</span>,<span class="st">"Org. Cultural"</span>,<span class="st">"Otros"</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">4</span>)), <span class="co"># Bloque 2</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Org. Vecinal"</span>,<span class="st">"Org. Política Pobladores"</span>,<span class="st">"Org. Política Base"</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">5</span>)), <span class="co"># Bloque 3</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Org. vecinal"</span>, <span class="dv">15</span>) <span class="co"># Bloque 4</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Preparar datos para métricas de cohesión</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>cohesion_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bloque =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Bloque"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Densidad_interna =</span> <span class="fu">diag</span>(block_density),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Densidad_externa =</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(i) <span class="fu">mean</span>(block_density[i,<span class="sc">-</span>i])),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">EI_index =</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(i) {</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    internal <span class="ot">&lt;-</span> block_density[i,i]</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    external <span class="ot">&lt;-</span> <span class="fu">mean</span>(block_density[i,<span class="sc">-</span>i])</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    (external <span class="sc">-</span> internal)<span class="sc">/</span>(external <span class="sc">+</span> internal)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Bloque, </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Metrica"</span>, </span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear las visualizaciones</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Heatmap de densidades</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(density_df, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> density)) <span class="sc">+</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidad entre Bloques"</span>,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bloque Origen"</span>,</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Bloque Destino"</span>,</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Composición de bloques</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(composicion_bloques, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Bloque), <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Composición de Bloques"</span>,</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bloque"</span>,</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporción"</span>,</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tipo de Organización"</span>) <span class="sc">+</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Métricas de cohesión</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cohesion_df, <span class="fu">aes</span>(<span class="at">x =</span> Bloque, <span class="at">y =</span> Valor, <span class="at">fill =</span> Metrica)) <span class="sc">+</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Métricas de Cohesión por Bloque"</span>,</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bloque"</span>,</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Valor"</span>,</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Métrica"</span>) <span class="sc">+</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir a plotly</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>p1_plotly <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p1)</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>p2_plotly <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p2)</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>p3_plotly <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p3)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los plots</span></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>p1_plotly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f3167c72d42f300d5459" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f3167c72d42f300d5459">{"x":{"data":[{"x":[1,2,3,4],"y":[1,2,3,4],"z":[[0.49494949494949492,0,0.4242424242424242,0.065993265993265993],[0.076146076146076158,0.68531468531468531,0.39160839160839161,0.22843822843822842],[0.3888888888888889,0.2937062937062937,1,0.2121212121212121],[0.19797979797979798,0.22843822843822842,0.084848484848484854,0.31676767676767675]],"text":[["from: Bloque 1<br />to: Bloque 1<br />density: 0.055555556","from: Bloque 2<br />to: Bloque 1<br />density: 0.000000000","from: Bloque 3<br />to: Bloque 1<br />density: 0.047619048","from: Bloque 4<br />to: Bloque 1<br />density: 0.007407407"],["from: Bloque 1<br />to: Bloque 2<br />density: 0.008547009","from: Bloque 2<br />to: Bloque 2<br />density: 0.076923077","from: Bloque 3<br />to: Bloque 2<br />density: 0.043956044","from: Bloque 4<br />to: Bloque 2<br />density: 0.025641026"],["from: Bloque 1<br />to: Bloque 3<br />density: 0.043650794","from: Bloque 2<br />to: Bloque 3<br />density: 0.032967033","from: Bloque 3<br />to: Bloque 3<br />density: 0.112244898","from: Bloque 4<br />to: Bloque 3<br />density: 0.023809524"],["from: Bloque 1<br />to: Bloque 4<br />density: 0.022222222","from: Bloque 2<br />to: Bloque 4<br />density: 0.025641026","from: Bloque 3<br />to: Bloque 4<br />density: 0.009523810","from: Bloque 4<br />to: Bloque 4<br />density: 0.035555556"]],"colorscale":[[0,"#440154"],[0.065993265993265993,"#481A6C"],[0.076146076146076158,"#481C6E"],[0.084848484848484854,"#482071"],[0.19797979797979798,"#414387"],[0.2121212121212121,"#3F4788"],[0.22843822843822842,"#3E4C8A"],[0.2937062937062937,"#355E8D"],[0.31676767676767675,"#32648E"],[0.3888888888888889,"#2B758E"],[0.39160839160839161,"#2A768E"],[0.4242424242424242,"#277E8E"],[0.49494949494949492,"#218F8D"],[0.68531468531468531,"#3DBC74"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"b50039613ae82af16212624818f8e597","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#440154"],[0.0033444816053511705,"#440256"],[0.006688963210702341,"#450357"],[0.010033444816053512,"#450558"],[0.013377926421404682,"#450659"],[0.016722408026755852,"#46075B"],[0.020066889632107024,"#46085C"],[0.023411371237458192,"#460A5D"],[0.026755852842809364,"#460B5E"],[0.030100334448160536,"#470C5F"],[0.033444816053511704,"#470E61"],[0.036789297658862873,"#470F62"],[0.040133779264214048,"#471063"],[0.043478260869565223,"#471164"],[0.046822742474916385,"#471365"],[0.050167224080267553,"#481467"],[0.053511705685618728,"#481568"],[0.056856187290969903,"#481768"],[0.060200668896321072,"#481769"],[0.06354515050167224,"#48186A"],[0.066889632107023408,"#481A6C"],[0.070234113712374591,"#481B6D"],[0.073578595317725745,"#481C6E"],[0.076923076923076913,"#481D6F"],[0.080267558528428096,"#481E6F"],[0.083612040133779264,"#481F70"],[0.086956521739130446,"#482071"],[0.090301003344481601,"#482173"],[0.093645484949832769,"#482374"],[0.096989966555183951,"#482475"],[0.10033444816053511,"#482576"],[0.10367892976588627,"#482576"],[0.10702341137123746,"#482777"],[0.11036789297658862,"#482878"],[0.11371237458193981,"#482979"],[0.11705685618729096,"#472A7A"],[0.12040133779264214,"#472B7A"],[0.12374581939799331,"#472D7B"],[0.12709030100334448,"#472D7B"],[0.13043478260869565,"#472E7C"],[0.13377926421404682,"#472F7D"],[0.13712374581939799,"#46307E"],[0.14046822742474918,"#46327E"],[0.14381270903010032,"#46337F"],[0.14715719063545149,"#463480"],[0.15050167224080269,"#463480"],[0.15384615384615383,"#453581"],[0.15719063545150502,"#453781"],[0.16053511705685619,"#453882"],[0.16387959866220733,"#443983"],[0.16722408026755853,"#443A83"],[0.1705685618729097,"#443A83"],[0.17391304347826089,"#443C84"],[0.17725752508361203,"#433D84"],[0.1806020066889632,"#433E85"],[0.1839464882943144,"#423F85"],[0.18729096989966554,"#424086"],[0.19063545150501671,"#424186"],[0.1939799331103679,"#424186"],[0.19732441471571904,"#414387"],[0.20066889632107021,"#414487"],[0.20401337792642141,"#404588"],[0.20735785953177255,"#404688"],[0.21070234113712374,"#3F4788"],[0.21404682274247491,"#3F4889"],[0.21739130434782608,"#3F4889"],[0.22073578595317725,"#3E4989"],[0.22408026755852842,"#3E4A89"],[0.22742474916387961,"#3E4C8A"],[0.23076923076923075,"#3D4D8A"],[0.23411371237458192,"#3D4E8A"],[0.23745819397993312,"#3C4F8A"],[0.24080267558528429,"#3C4F8A"],[0.24414715719063543,"#3C508B"],[0.24749163879598662,"#3B518B"],[0.25083612040133779,"#3B528B"],[0.25418060200668896,"#3A538B"],[0.25752508361204013,"#3A548C"],[0.2608695652173913,"#39558C"],[0.26421404682274247,"#39558C"],[0.26755852842809363,"#39568C"],[0.2709030100334448,"#38588C"],[0.27424749163879597,"#38598C"],[0.27759197324414714,"#375A8C"],[0.28093645484949836,"#375B8D"],[0.28428093645484948,"#375B8D"],[0.28762541806020064,"#365C8D"],[0.29096989966555187,"#365D8D"],[0.29431438127090298,"#355E8D"],[0.29765886287625415,"#355F8D"],[0.30100334448160537,"#34608D"],[0.30434782608695654,"#34618D"],[0.30769230769230765,"#34618D"],[0.31103678929765888,"#33628D"],[0.31438127090301005,"#33638D"],[0.31772575250836116,"#32648E"],[0.32107023411371238,"#32658E"],[0.32441471571906355,"#31668E"],[0.32775919732441466,"#31678E"],[0.33110367892976589,"#31678E"],[0.33444816053511706,"#31688E"],[0.33779264214046817,"#30698E"],[0.34113712374581939,"#306A8E"],[0.34448160535117056,"#2F6B8E"],[0.34782608695652178,"#2F6C8E"],[0.3511705685618729,"#2E6D8E"],[0.35451505016722407,"#2E6D8E"],[0.35785953177257529,"#2E6E8E"],[0.3612040133779264,"#2E6F8E"],[0.36454849498327757,"#2D708E"],[0.3678929765886288,"#2D718E"],[0.37123745819397991,"#2C718E"],[0.37458193979933108,"#2C728E"],[0.3779264214046823,"#2C728E"],[0.38127090301003341,"#2C738E"],[0.38461538461538458,"#2B748E"],[0.38795986622073581,"#2B758E"],[0.39130434782608692,"#2A768E"],[0.39464882943143809,"#2A778E"],[0.39799331103678931,"#2A778E"],[0.40133779264214042,"#2A788E"],[0.40468227424749159,"#29798E"],[0.40802675585284282,"#297A8E"],[0.41137123745819398,"#297B8E"],[0.4147157190635451,"#287C8E"],[0.41806020066889632,"#287D8E"],[0.42140468227424749,"#287D8E"],[0.42474916387959866,"#277E8E"],[0.42809364548494983,"#277F8E"],[0.43143812709030099,"#27808E"],[0.43478260869565216,"#26818E"],[0.43812709030100333,"#26828E"],[0.4414715719063545,"#26828E"],[0.44481605351170567,"#26828E"],[0.44816053511705684,"#25838E"],[0.451505016722408,"#25848E"],[0.45484949832775923,"#25858E"],[0.45819397993311034,"#24868E"],[0.46153846153846151,"#24878E"],[0.46488294314381273,"#23888E"],[0.46822742474916385,"#23888E"],[0.47157190635451501,"#23898E"],[0.47491638795986624,"#238A8D"],[0.47826086956521735,"#228B8D"],[0.48160535117056857,"#228C8D"],[0.48494983277591974,"#228D8D"],[0.48829431438127086,"#218E8D"],[0.49163879598662208,"#218E8D"],[0.49498327759197325,"#218F8D"],[0.49832775919732436,"#21908D"],[0.50167224080267558,"#21918C"],[0.50501672240802675,"#20928C"],[0.50836120401337792,"#20928C"],[0.51170568561872909,"#20928C"],[0.51505016722408026,"#20938C"],[0.51839464882943143,"#1F948C"],[0.52173913043478259,"#1F958B"],[0.52508361204013376,"#1F968B"],[0.52842809364548493,"#1F978B"],[0.5317725752508361,"#1F988B"],[0.53511705685618727,"#1F988B"],[0.53846153846153844,"#1F998A"],[0.5418060200668896,"#1F9A8A"],[0.54515050167224077,"#1E9B8A"],[0.54849498327759194,"#1E9C89"],[0.55183946488294311,"#1E9D89"],[0.55518394648829428,"#1F9E89"],[0.55852842809364545,"#1F9E89"],[0.56187290969899673,"#1F9F88"],[0.56521739130434778,"#1FA088"],[0.56856187290969895,"#1FA188"],[0.57190635451505023,"#1FA187"],[0.57525083612040129,"#1FA287"],[0.57859531772575246,"#20A386"],[0.58193979933110374,"#20A386"],[0.58528428093645479,"#20A486"],[0.58862876254180596,"#21A585"],[0.59197324414715724,"#21A685"],[0.5953177257525083,"#22A785"],[0.59866220735785958,"#22A884"],[0.60200668896321075,"#23A983"],[0.6053511705685618,"#23A983"],[0.60869565217391308,"#24AA83"],[0.61204013377926425,"#25AB82"],[0.61538461538461531,"#25AC82"],[0.61872909698996659,"#26AD81"],[0.62207357859531776,"#27AD81"],[0.62541806020066881,"#27AD81"],[0.62876254180602009,"#28AE80"],[0.63210702341137126,"#29AF7F"],[0.63545150501672232,"#2AB07F"],[0.6387959866220736,"#2CB17E"],[0.64214046822742477,"#2DB27D"],[0.64548494983277582,"#2EB37C"],[0.6488294314381271,"#2EB37C"],[0.65217391304347827,"#30B47C"],[0.65551839464882933,"#31B57B"],[0.65886287625418061,"#32B67A"],[0.66220735785953178,"#34B679"],[0.66555183946488283,"#35B779"],[0.66889632107023411,"#36B878"],[0.67224080267558528,"#37B878"],[0.67558528428093634,"#39B977"],[0.67892976588628762,"#3ABA76"],[0.68227424749163879,"#3BBB75"],[0.68561872909698984,"#3DBC74"],[0.68896321070234112,"#3EBC73"],[0.69230769230769229,"#40BD72"],[0.69565217391304357,"#41BD72"],[0.69899665551839463,"#42BE71"],[0.7023411371237458,"#44BF70"],[0.70568561872909707,"#46C06F"],[0.70903010033444813,"#48C16E"],[0.7123745819397993,"#49C16D"],[0.71571906354515058,"#4BC26C"],[0.71906354515050164,"#4DC26C"],[0.72240802675585281,"#4EC36B"],[0.72575250836120409,"#50C46A"],[0.72909698996655514,"#52C569"],[0.73244147157190631,"#54C568"],[0.73578595317725759,"#55C667"],[0.73913043478260865,"#57C666"],[0.74247491638795982,"#59C765"],[0.7458193979933111,"#5AC864"],[0.74916387959866215,"#5CC863"],[0.75250836120401332,"#5EC962"],[0.7558528428093646,"#5FCA61"],[0.75919732441471566,"#62CB5F"],[0.76254180602006683,"#64CB5F"],[0.76588628762541811,"#66CB5D"],[0.76923076923076916,"#67CC5C"],[0.77257525083612033,"#69CD5B"],[0.77591973244147161,"#6CCD5A"],[0.77926421404682267,"#6DCE59"],[0.78260869565217384,"#6FCF57"],[0.78595317725752512,"#71CF57"],[0.78929765886287617,"#74D055"],[0.79264214046822734,"#75D054"],[0.79598662207357862,"#77D153"],[0.79933110367892968,"#79D151"],[0.80267558528428085,"#7BD250"],[0.80602006688963213,"#7ED34F"],[0.80936454849498318,"#80D34E"],[0.81270903010033446,"#82D34D"],[0.81605351170568563,"#84D44B"],[0.81939799331103669,"#86D549"],[0.82274247491638797,"#88D548"],[0.82608695652173914,"#8AD647"],[0.82943143812709019,"#8DD645"],[0.83277591973244147,"#8FD644"],[0.83612040133779264,"#91D743"],[0.83946488294314381,"#93D741"],[0.84280936454849498,"#95D840"],[0.84615384615384615,"#97D83E"],[0.84949832775919731,"#9AD93D"],[0.85284280936454848,"#9CD93C"],[0.85618729096989965,"#9ED93A"],[0.85953177257525082,"#A0DA39"],[0.86287625418060199,"#A2DA37"],[0.86622073578595316,"#A5DB36"],[0.86956521739130432,"#A7DB35"],[0.87290969899665549,"#A9DC33"],[0.87625418060200666,"#ABDC31"],[0.87959866220735783,"#AEDC30"],[0.882943143812709,"#B0DD2F"],[0.88628762541806017,"#B2DD2D"],[0.88963210702341133,"#B5DE2B"],[0.8929765886287625,"#B7DE2A"],[0.89632107023411367,"#B9DE28"],[0.89966555183946484,"#BBDE27"],[0.90301003344481601,"#BEDF26"],[0.90635451505016718,"#C0DF25"],[0.90969899665551845,"#C2DF23"],[0.91304347826086951,"#C4E021"],[0.91638795986622068,"#C7E020"],[0.91973244147157196,"#C9E11F"],[0.92307692307692302,"#CBE11E"],[0.92642140468227419,"#CEE11D"],[0.92976588628762546,"#D0E11C"],[0.93311036789297652,"#D2E21B"],[0.93645484949832769,"#D4E21A"],[0.93979933110367897,"#D7E219"],[0.94314381270903003,"#D9E319"],[0.9464882943143812,"#DBE319"],[0.94983277591973247,"#DDE318"],[0.95317725752508364,"#DFE318"],[0.9565217391304347,"#E2E418"],[0.95986622073578598,"#E4E419"],[0.96321070234113715,"#E6E419"],[0.96655518394648821,"#E8E419"],[0.96989966555183948,"#EBE51A"],[0.97324414715719065,"#EDE51B"],[0.97658862876254171,"#EFE51C"],[0.97993311036789299,"#F1E51D"],[0.98327759197324416,"#F3E61E"],[0.98662207357859522,"#F5E61F"],[0.98996655518394649,"#F7E620"],[0.99331103678929766,"#F9E622"],[0.99665551839464872,"#FBE723"],[1,"#FDE725"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.039999999999996,"title":"Densidad","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.00","0.03","0.06","0.09"],"tickvals":[0.0016666666666666668,0.26804848484848481,0.53443030303030303,0.80081212121212109],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":53.812112334378554,"l":72.32876712328769},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Densidad entre Bloques","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Bloque Origen","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Bloque Destino","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Densidad","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5c352e221fba":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"5c352e221fba","visdat":{"5c352e221fba":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>p2_plotly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-dcb092206d03a7b40672" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-dcb092206d03a7b40672">{"x":{"data":[{"orientation":"v","width":0.89999999999999991,"base":0.77777777777777779,"x":[1],"y":[0.22222222222222221],"text":"count: 0.22222222<br />factor(Bloque): 1<br />Tipo: Club Deportivo","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Club Deportivo","legendgroup":"Club Deportivo","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999991,"base":0.27777777777777779,"x":[1],"y":[0.5],"text":"count: 0.50000000<br />factor(Bloque): 1<br />Tipo: Comite Vivienda","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(71,45,123,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Comite Vivienda","legendgroup":"Comite Vivienda","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999991,"base":0.22222222222222221,"x":[1],"y":[0.05555555555555558],"text":"count: 0.05555556<br />factor(Bloque): 1<br />Tipo: Gob. Municipal","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(59,82,139,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Gob. Municipal","legendgroup":"Gob. Municipal","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013],"base":[0,0.38461538461538464],"x":[1,2],"y":[0.22222222222222221,0.61538461538461542],"text":["count: 0.22222222<br />factor(Bloque): 1<br />Tipo: Org. Cultural","count: 0.61538462<br />factor(Bloque): 2<br />Tipo: Org. Cultural"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(44,114,142,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Org. Cultural","legendgroup":"Org. Cultural","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000013,0.90000000000000036],"base":[0.30769230769230771,0.6428571428571429],"x":[2,3],"y":[0.076923076923076927,0.3571428571428571],"text":["count: 0.07692308<br />factor(Bloque): 2<br />Tipo: Org. Política Base","count: 0.35714286<br />factor(Bloque): 3<br />Tipo: Org. Política Base"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Org. Política Base","legendgroup":"Org. Política Base","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0.21428571428571427,"x":[3],"y":[0.4285714285714286],"text":"count: 0.42857143<br />factor(Bloque): 3<br />Tipo: Org. Política Pobladores","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(39,173,129,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Org. Política Pobladores","legendgroup":"Org. Política Pobladores","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[1],"text":"count: 1.00000000<br />factor(Bloque): 4<br />Tipo: Org. vecinal","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(93,200,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Org. vecinal","legendgroup":"Org. vecinal","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[0.21428571428571427],"text":"count: 0.21428571<br />factor(Bloque): 3<br />Tipo: Org. Vecinal","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(170,220,50,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Org. Vecinal","legendgroup":"Org. Vecinal","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000013,"base":0,"x":[2],"y":[0.30769230769230771],"text":"count: 0.30769231<br />factor(Bloque): 2<br />Tipo: Otros","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Otros","legendgroup":"Otros","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Composición de Bloques","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["1","2","3","4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Bloque","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.050000000000000003,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Proporción","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Tipo de Organización","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5c3522a6f27c8":{"x":{},"fill":{},"type":"bar"}},"cur_data":"5c3522a6f27c8","visdat":{"5c3522a6f27c8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p3_plotly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-211129c517beb54f350f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-211129c517beb54f350f">{"x":{"data":[{"orientation":"v","width":[0.30000000000000004,0.30000000000000027,0.29999999999999982,0.29999999999999982],"base":[0,0,0,0],"x":[0.69999999999999996,1.7,2.7000000000000002,3.7000000000000002],"y":[0.024806674806674808,0.019536019536019536,0.033699633699633698,0.018952652285985618],"text":["Bloque: Bloque 1<br />Valor: 0.02480667<br />Metrica: Densidad_externa","Bloque: Bloque 2<br />Valor: 0.01953602<br />Metrica: Densidad_externa","Bloque: Bloque 3<br />Valor: 0.03369963<br />Metrica: Densidad_externa","Bloque: Bloque 4<br />Valor: 0.01895265<br />Metrica: Densidad_externa"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Densidad_externa","legendgroup":"Densidad_externa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.29999999999999993,0.29999999999999982,0.29999999999999982,0.30000000000000027],"base":[0,0,0,0],"x":[1,2,3,4],"y":[0.055555555555555552,0.076923076923076927,0.11224489795918367,0.035555555555555556],"text":["Bloque: Bloque 1<br />Valor: 0.05555556<br />Metrica: Densidad_interna","Bloque: Bloque 2<br />Valor: 0.07692308<br />Metrica: Densidad_interna","Bloque: Bloque 3<br />Valor: 0.11224490<br />Metrica: Densidad_interna","Bloque: Bloque 4<br />Valor: 0.03555556<br />Metrica: Densidad_interna"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Densidad_interna","legendgroup":"Densidad_interna","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.29999999999999982,0.29999999999999982,0.29999999999999982,0.30000000000000071],"base":[-0.38262851354773353,-0.59493670886075956,-0.53818572965220501,-0.30459455423366028],"x":[1.3,2.2999999999999998,3.2999999999999998,4.2999999999999998],"y":[0.38262851354773353,0.59493670886075956,0.53818572965220501,0.30459455423366028],"text":["Bloque: Bloque 1<br />Valor: 0.38262851<br />Metrica: EI_index","Bloque: Bloque 2<br />Valor: 0.59493671<br />Metrica: EI_index","Bloque: Bloque 3<br />Valor: 0.53818573<br />Metrica: EI_index","Bloque: Bloque 4<br />Valor: 0.30459455<br />Metrica: EI_index"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EI_index","legendgroup":"EI_index","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Métricas de Cohesión por Bloque","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["Bloque 1","Bloque 2","Bloque 3","Bloque 4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Bloque","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.63029578920175666,0.14760397830018085],"tickmode":"array","ticktext":["-0.6","-0.4","-0.2","0.0"],"tickvals":[-0.60000000000000009,-0.40000000000000008,-0.20000000000000007,0],"categoryorder":"array","categoryarray":["-0.6","-0.4","-0.2","0.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Valor","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Métrica","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5c35217b2df09":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"5c35217b2df09","visdat":{"5c35217b2df09":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create multiplex network</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>multiplex_matrix <span class="ot">&lt;-</span> coop_matrix <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                   trust_matrix <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                   resources_matrix <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                   values_matrix <span class="sc">*</span> <span class="fl">0.2</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(multiplex_matrix, <span class="at">mode=</span><span class="st">"directed"</span>, <span class="at">weighted=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertex attributes using existing data</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>degree <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>betweenness <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(g)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>eigenvector <span class="ot">&lt;-</span> <span class="fu">eigen_centrality</span>(g)<span class="sc">$</span>vector</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>block <span class="ot">&lt;-</span> attributes<span class="sc">$</span>X1PosciónCONCOR</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>type <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Tipo_de_organización</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>orientation <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Orientación</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>nombre <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Nombre</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add edge attributes</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> <span class="fu">as_edgelist</span>(g)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g)<span class="sc">$</span>block_tie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">V</span>(g)<span class="sc">$</span>block[edge_list[,<span class="dv">1</span>]] <span class="sc">==</span> <span class="fu">V</span>(g)<span class="sc">$</span>block[edge_list[,<span class="dv">2</span>]], </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"Block"</span>, <span class="fu">V</span>(g)<span class="sc">$</span>block[edge_list[,<span class="dv">1</span>]]), </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"between"</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Network plot with ggraph</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g)<span class="sc">$</span>block[from] <span class="sc">==</span> <span class="fu">V</span>(g)<span class="sc">$</span>block[to], <span class="fl">0.6</span>, <span class="fl">0.2</span>)),</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">'mm'</span>))) <span class="sc">+</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> betweenness,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">as.factor</span>(block)),</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(betweenness <span class="sc">&gt;</span> <span class="fu">quantile</span>(betweenness, <span class="fl">0.92</span>),</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>                                    nombre, <span class="st">""</span>)),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>,</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Bloque"</span>,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Político"</span>, <span class="st">"JJ.VV"</span>, <span class="st">"Base"</span>, <span class="st">"Cultural"</span>)) <span class="sc">+</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Intermediación"</span>,</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>),</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.075</span>, <span class="fl">0.1</span>, <span class="fl">0.125</span>),</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.000"</span>, <span class="st">"0.025"</span>, <span class="st">"0.050"</span>, <span class="st">"0.075"</span>, <span class="st">"0.100"</span>, <span class="st">"0.125"</span>)) <span class="sc">+</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)),</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>)),</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge_alpha =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Vinculo"</span>)) <span class="sc">+</span>  <span class="co"># Eliminamos el título de la leyenda edge_alpha</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This suggests:</p>
<ul>
<li>Integration occurs through nested hierarchies</li>
<li>Cultural organizations serve as brokers</li>
<li>Political organizations maintain core-periphery structure</li>
</ul>
<p>This extends Diani’s (2015) movement integration theory by specifying:</p>
<ul>
<li>The role of organizational heterogeneity</li>
<li>The importance of cultural brokers</li>
<li>The hierarchical nature of integration</li>
</ul>
</section>
</section>
</section>
<section id="ergm" class="level2">
<h2 class="anchored" data-anchor-id="ergm">ERGM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar distribución de grados</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>out_degrees <span class="ot">&lt;-</span> sna<span class="sc">::</span><span class="fu">degree</span>(net_coop)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(out_degrees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>out_degrees
 0  1  2  3  4  5  6  7  8  9 10 11 12 14 19 
10 20  7  6  2  1  5  4  1  7  1  3  1  1  1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(out_degrees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar constraints para manejar el límite de nominaciones</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(net_coop <span class="sc">~</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>               edges <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">gwesp</span>(<span class="fl">0.25</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">gwidegree</span>(<span class="fl">0.25</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>               <span class="co">#gwdegree(0.25, fixed = TRUE) +</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">edgecov</span>(trust_matrix) <span class="sc">+</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">edgecov</span>(resources_matrix) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">edgecov</span>(parentesco_matrix) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>               <span class="co">#nodefactor("tipo") +</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>               <span class="co">#nodefactor("orientacion") +</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>               <span class="co">#nodefactor("ubicacion") +</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nodematch</span>(<span class="st">"tipo"</span>) <span class="sc">+</span> </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nodematch</span>(<span class="st">"orientacion"</span>, <span class="at">diff=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nodematch</span>(<span class="st">"ubicacion"</span>),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">constraints =</span> <span class="sc">~</span><span class="fu">bd</span>(<span class="at">maxout=</span><span class="fu">max</span>(out_degrees)), </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">control =</span> <span class="fu">control.ergm</span>(<span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">MCMLE.maxit =</span> <span class="dv">25</span>, <span class="co"># Aumentar iteraciones </span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">MCMC.burnin =</span> <span class="dv">5000</span>, <span class="co"># Aumentar burn-in</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">MCMC.interval =</span> <span class="dv">100</span>, <span class="co"># Aumentar intervalo</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">MCMC.samplesize =</span> <span class="dv">5000</span>, <span class="co"># Aumentar tamaño de muestra</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">parallel =</span> <span class="dv">2</span>,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">parallel.type =</span> <span class="st">"PSOCK"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(model2,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">stars=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>), </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits=</span><span class="dv">3</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">star.symbol=</span><span class="st">'&amp;#42;'</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">custom.note =</span> <span class="fu">paste</span>(<span class="st">"%stars."</span>),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">align.center=</span><span class="cn">TRUE</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">single.row =</span> T, </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">bold =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Warning in nobs.ergm(object): The number of observed dyads in this network is
ill-defined due to complex constraints on the sample space. Disable this
warning with 'options(ergm.loglik.warn_dyads=FALSE)'.</code></pre>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
&nbsp;
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
edges
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-7.382</b> (0.582)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gwesp.OTP.fixed.0.25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>1.899</b> (0.281)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
gwideg.fixed.0.25
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>2.237</b> (0.695)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
edgecov.trust_matrix
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>6.423</b> (0.801)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
edgecov.resources_matrix
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>5.513</b> (1.024)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
edgecov.parentesco_matrix
</td>
<td style="padding-left: 5px;padding-right: 5px;">
<b>-3.082</b> (0.977)<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
nodematch.tipo
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.336 (0.421)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
nodematch.orientacion.Conflictiva
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.306 (0.486)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
nodematch.orientacion.No_conflictiva
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.039 (0.522)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
nodematch.ubicacion
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.415 (0.417)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-5198.030
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
BIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-5133.204
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
2609.015
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>***</sup>p &lt; 0.01; <sup>**</sup>p &lt; 0.05; <sup>*</sup>p &lt; 0.1.
</td>
</tr>
</tfoot>
</table>
<p><strong>Trust-Based Diffusion</strong>: The strongest positive effect (6.423***) comes from trust networks, supporting Passy &amp; Monsch’s (2014) argument that identity transformation occurs primarily through trust relationships. Your case shows how historical relationships between pobladores organizations provided the foundation for contentious identity spread.</p>
<p>[Quote opportunity: Leader discussing how long-term trust relationships facilitated political alignment]</p>
<p><strong>Resource Network Amplification</strong>: The strong positive effect of resource ties (5.513) indicates that material interdependencies reinforced identity diffusion, consistent with Diani’s (2015) findings about movement infrastructure. In Peñalolén, resource sharing created durable channels for identity transmission.</p>
<p><strong>Kinship Network Constraint</strong>: The negative effect of kinship ties (-3.082) suggests these relationships actually inhibited contention diffusion, contrasting with some social movement literature but aligning with Gould’s (1991) findings about the primacy of political over personal ties in contentious episodes.</p>
<p><strong>Triadic Closure</strong>: Significant GWESP effect (1.899) indicates importance of local clustering in network formation. The significant GWESP effect combined with trust-resource complementarity suggests a new theoretical mechanism: “networked capacity building”, where:</p>
<ul>
<li>Local clustering provides social validation</li>
<li>Multiple ties build organizational capacity</li>
<li>Different tie types serve distinct but complementary functions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess goodness-of-fit  </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="fu">gof</span>(model2)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Goodness-of-fit for in-degree 

          obs min  mean max MC p-value
idegree0   12   7 11.72  18       0.96
idegree1   24  15 25.78  34       0.72
idegree2   15   6 14.61  21       0.98
idegree3    8   2  6.38  11       0.64
idegree4    4   1  4.90  10       0.88
idegree5    3   0  2.12   5       0.60
idegree6    2   0  1.89   4       1.00
idegree7    1   0  1.35   3       1.00
idegree8    0   0  0.22   2       1.00
idegree9    0   0  0.03   1       1.00
idegree12   0   0  0.02   1       1.00
idegree13   1   0  0.14   1       0.28
idegree14   0   0  0.63   1       0.74
idegree15   0   0  0.18   1       1.00
idegree16   0   0  0.02   1       1.00
idegree17   0   0  0.01   1       1.00

Goodness-of-fit for out-degree 

          obs min  mean max MC p-value
odegree0   38  27 33.83  38       0.08
odegree1    3   1  5.91  13       0.36
odegree2    1   0  2.42   6       0.44
odegree3    6   1  4.47   8       0.54
odegree4    4   2  7.69  13       0.06
odegree5    9   1  9.75  15       0.88
odegree6    6   0  4.30  10       0.44
odegree7    3   0  1.33   6       0.24
odegree8    0   0  0.26   2       1.00
odegree9    0   0  0.03   1       1.00
odegree10   0   0  0.01   1       1.00

Goodness-of-fit for edgewise shared partner 

         obs min  mean max MC p-value
esp.OTP0  51  40 50.72  66       1.00
esp.OTP1  53  41 52.81  69       0.96
esp.OTP2  23  17 27.90  45       0.36
esp.OTP3  10   2  6.89  14       0.28
esp.OTP4   4   0  2.73   8       0.42
esp.OTP5   0   0  0.17   2       1.00
esp.OTP6   0   0  0.01   1       1.00

Goodness-of-fit for minimum geodesic distance 

     obs  min    mean  max MC p-value
1    141  130  141.23  153       1.00
2    250  192  248.21  301       0.94
3    283  207  304.18  414       0.68
4    230  140  268.84  444       0.40
5    153   68  180.83  335       0.66
6    117   13   98.96  241       0.72
7     67    0   51.56  181       0.68
8     12    0   26.52  150       0.86
9      0    0   13.31  102       0.86
10     0    0    6.38   95       1.00
11     0    0    3.08  104       1.00
12     0    0    0.89   21       1.00
13     0    0    0.43   16       1.00
14     0    0    0.14    8       1.00
15     0    0    0.03    2       1.00
Inf 3577 2760 3485.41 4066       0.82

Goodness-of-fit for model statistics 

                                           obs       min      mean       max
edges                                141.00000 130.00000 141.23000 153.00000
gwesp.OTP.fixed.0.25                  98.91267  83.68375  99.36065 118.47841
gwideg.fixed.0.25                     66.58862  59.60889  66.48744  71.40914
edgecov.trust_matrix                 118.00000 112.00000 117.83000 123.00000
edgecov.resources_matrix              93.00000  90.00000  93.01000  95.00000
edgecov.parentesco_matrix             38.00000  33.00000  37.99000  41.00000
nodematch.tipo                        58.00000  49.00000  57.45000  69.00000
nodematch.orientacion.Conflictiva     65.00000  57.00000  64.93000  73.00000
nodematch.orientacion.No_conflictiva  32.00000  27.00000  31.92000  38.00000
nodematch.ubicacion                   80.00000  71.00000  80.12000  90.00000
                                     MC p-value
edges                                      1.00
gwesp.OTP.fixed.0.25                       0.96
gwideg.fixed.0.25                          0.92
edgecov.trust_matrix                       1.00
edgecov.resources_matrix                   1.00
edgecov.parentesco_matrix                  1.00
nodematch.tipo                             0.92
nodematch.orientacion.Conflictiva          1.00
nodematch.orientacion.No_conflictiva       1.00
nodematch.ubicacion                        1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot diagnostics  </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc.diagnostics</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="index_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="index_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample statistics summary:

Iterations = 113280:2260608
Thinning interval = 576 
Number of chains = 2 
Sample size per chain = 3729 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                                          Mean    SD Naive SE Time-series SE
edges                                 0.203942 4.905  0.05680        0.15855
gwesp.OTP.fixed.0.25                  0.324829 7.119  0.08244        0.26045
gwideg.fixed.0.25                     0.001303 2.285  0.02646        0.04466
edgecov.trust_matrix                  0.230088 2.182  0.02527        0.13261
edgecov.resources_matrix              0.041566 1.068  0.01237        0.05510
edgecov.parentesco_matrix             0.263878 1.725  0.01998        0.09330
nodematch.tipo                        0.396755 3.121  0.03614        0.10540
nodematch.orientacion.Conflictiva     0.133280 3.040  0.03520        0.10609
nodematch.orientacion.No_conflictiva -0.018235 2.454  0.02842        0.06978
nodematch.ubicacion                  -0.024269 3.413  0.03952        0.10540

2. Quantiles for each variable:

                                        2.5%    25%      50%   75%  97.5%
edges                                 -9.000 -3.000  0.00000 3.000 10.000
gwesp.OTP.fixed.0.25                 -13.067 -4.634  0.16737 5.192 14.697
gwideg.fixed.0.25                     -4.403 -1.594 -0.03542 1.556  4.511
edgecov.trust_matrix                  -4.000 -1.000  0.00000 2.000  4.000
edgecov.resources_matrix              -2.000 -1.000  0.00000 1.000  2.000
edgecov.parentesco_matrix             -3.000 -1.000  0.00000 1.000  3.000
nodematch.tipo                        -5.000 -2.000  0.00000 2.000  7.000
nodematch.orientacion.Conflictiva     -6.000 -2.000  0.00000 2.000  6.000
nodematch.orientacion.No_conflictiva  -4.000 -2.000  0.00000 2.000  5.000
nodematch.ubicacion                   -6.000 -2.000  0.00000 2.000  7.000


Are sample statistics significantly different from observed?
               edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25
diff.      0.2039421            0.3248285       0.001302875
test stat. 1.3103792            1.2734396       0.030079119
P-val.     0.1900676            0.2028621       0.976003954
           edgecov.trust_matrix edgecov.resources_matrix
diff.                 0.2300885                0.0415661
test stat.            1.7567443                0.7542863
P-val.                0.0789614                0.4506773
           edgecov.parentesco_matrix nodematch.tipo
diff.                    0.263877715   0.3967551622
test stat.               2.856112054   3.7768393985
P-val.                   0.004288637   0.0001588311
           nodematch.orientacion.Conflictiva
diff.                              0.1332797
test stat.                         1.2713375
P-val.                             0.2036086
           nodematch.orientacion.No_conflictiva nodematch.ubicacion
diff.                               -0.01823545         -0.02426924
test stat.                          -0.26177960         -0.23254063
P-val.                               0.79349137          0.81611813
                 (Omni)
diff.                NA
test stat. 3.912031e+01
P-val.     3.283269e-05

Sample statistics cross-correlations:
                                         edges gwesp.OTP.fixed.0.25
edges                                1.0000000            0.7503673
gwesp.OTP.fixed.0.25                 0.7503673            1.0000000
gwideg.fixed.0.25                    0.6226578            0.1736493
edgecov.trust_matrix                 0.4753875            0.4463577
edgecov.resources_matrix             0.2466648            0.1260179
edgecov.parentesco_matrix            0.3955081            0.4076238
nodematch.tipo                       0.6043182            0.4923756
nodematch.orientacion.Conflictiva    0.5921523            0.6280903
nodematch.orientacion.No_conflictiva 0.4577369            0.1705258
nodematch.ubicacion                  0.6574279            0.5786321
                                     gwideg.fixed.0.25 edgecov.trust_matrix
edges                                       0.62265776            0.4753875
gwesp.OTP.fixed.0.25                        0.17364934            0.4463577
gwideg.fixed.0.25                           1.00000000            0.2083101
edgecov.trust_matrix                        0.20831006            1.0000000
edgecov.resources_matrix                    0.08518801            0.1529194
edgecov.parentesco_matrix                   0.16911330            0.7868593
nodematch.tipo                              0.34320034            0.4412721
nodematch.orientacion.Conflictiva           0.17467212            0.4154842
nodematch.orientacion.No_conflictiva        0.45732699            0.1624489
nodematch.ubicacion                         0.35304030            0.2501853
                                     edgecov.resources_matrix
edges                                              0.24666483
gwesp.OTP.fixed.0.25                               0.12601792
gwideg.fixed.0.25                                  0.08518801
edgecov.trust_matrix                               0.15291940
edgecov.resources_matrix                           1.00000000
edgecov.parentesco_matrix                          0.21725480
nodematch.tipo                                     0.15110349
nodematch.orientacion.Conflictiva                  0.16676813
nodematch.orientacion.No_conflictiva               0.03281462
nodematch.ubicacion                                0.24784977
                                     edgecov.parentesco_matrix nodematch.tipo
edges                                               0.39550811      0.6043182
gwesp.OTP.fixed.0.25                                0.40762379      0.4923756
gwideg.fixed.0.25                                   0.16911330      0.3432003
edgecov.trust_matrix                                0.78685928      0.4412721
edgecov.resources_matrix                            0.21725480      0.1511035
edgecov.parentesco_matrix                           1.00000000      0.3600311
nodematch.tipo                                      0.36003114      1.0000000
nodematch.orientacion.Conflictiva                   0.36027801      0.3731789
nodematch.orientacion.No_conflictiva                0.03955758      0.3571450
nodematch.ubicacion                                 0.23468991      0.4319629
                                     nodematch.orientacion.Conflictiva
edges                                                       0.59215225
gwesp.OTP.fixed.0.25                                        0.62809031
gwideg.fixed.0.25                                           0.17467212
edgecov.trust_matrix                                        0.41548417
edgecov.resources_matrix                                    0.16676813
edgecov.parentesco_matrix                                   0.36027801
nodematch.tipo                                              0.37317886
nodematch.orientacion.Conflictiva                           1.00000000
nodematch.orientacion.No_conflictiva                       -0.01592184
nodematch.ubicacion                                         0.28046311
                                     nodematch.orientacion.No_conflictiva
edges                                                          0.45773688
gwesp.OTP.fixed.0.25                                           0.17052580
gwideg.fixed.0.25                                              0.45732699
edgecov.trust_matrix                                           0.16244894
edgecov.resources_matrix                                       0.03281462
edgecov.parentesco_matrix                                      0.03955758
nodematch.tipo                                                 0.35714501
nodematch.orientacion.Conflictiva                             -0.01592184
nodematch.orientacion.No_conflictiva                           1.00000000
nodematch.ubicacion                                            0.28309945
                                     nodematch.ubicacion
edges                                          0.6574279
gwesp.OTP.fixed.0.25                           0.5786321
gwideg.fixed.0.25                              0.3530403
edgecov.trust_matrix                           0.2501853
edgecov.resources_matrix                       0.2478498
edgecov.parentesco_matrix                      0.2346899
nodematch.tipo                                 0.4319629
nodematch.orientacion.Conflictiva              0.2804631
nodematch.orientacion.No_conflictiva           0.2830995
nodematch.ubicacion                            1.0000000

Sample statistics auto-correlation:
Chain 1 
             edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25 edgecov.trust_matrix
Lag 0    1.0000000            1.0000000        1.00000000            1.0000000
Lag 576  0.4397807            0.6227530        0.18162679            0.9178198
Lag 1152 0.3148283            0.4728451        0.09813186            0.8480034
Lag 1728 0.2698242            0.3907255        0.08396391            0.7912741
Lag 2304 0.2537632            0.3348324        0.08270944            0.7421865
Lag 2880 0.2518141            0.3086343        0.08922975            0.6997454
         edgecov.resources_matrix edgecov.parentesco_matrix nodematch.tipo
Lag 0                   1.0000000                 1.0000000      1.0000000
Lag 576                 0.8770662                 0.8874269      0.5352554
Lag 1152                0.7853049                 0.8034089      0.4365070
Lag 1728                0.7156640                 0.7390042      0.3566043
Lag 2304                0.6533247                 0.6824135      0.3276652
Lag 2880                0.6000438                 0.6363426      0.2863504
         nodematch.orientacion.Conflictiva nodematch.orientacion.No_conflictiva
Lag 0                            1.0000000                           1.00000000
Lag 576                          0.5890142                           0.26249115
Lag 1152                         0.4525227                           0.17479771
Lag 1728                         0.3924194                           0.12756234
Lag 2304                         0.3510933                           0.09905353
Lag 2880                         0.3275476                           0.12989554
         nodematch.ubicacion
Lag 0              1.0000000
Lag 576            0.4762715
Lag 1152           0.3266910
Lag 1728           0.2832940
Lag 2304           0.2423880
Lag 2880           0.2301816
Chain 2 
             edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25 edgecov.trust_matrix
Lag 0    1.0000000            1.0000000        1.00000000            1.0000000
Lag 576  0.4371948            0.6385332        0.12922643            0.9097443
Lag 1152 0.3262631            0.4884039        0.10594288            0.8370430
Lag 1728 0.2813862            0.4024359        0.10195574            0.7703448
Lag 2304 0.2346036            0.3256577        0.06437188            0.7070170
Lag 2880 0.1954026            0.2793614        0.04171042            0.6502221
         edgecov.resources_matrix edgecov.parentesco_matrix nodematch.tipo
Lag 0                   1.0000000                 1.0000000      1.0000000
Lag 576                 0.8731033                 0.8863344      0.5119171
Lag 1152                0.7757923                 0.7986013      0.4023770
Lag 1728                0.7025512                 0.7217819      0.3477717
Lag 2304                0.6416237                 0.6513139      0.2845192
Lag 2880                0.5844292                 0.5893462      0.2492085
         nodematch.orientacion.Conflictiva nodematch.orientacion.No_conflictiva
Lag 0                            1.0000000                            1.0000000
Lag 576                          0.6115570                            0.2928067
Lag 1152                         0.4724889                            0.2079767
Lag 1728                         0.3950607                            0.1770956
Lag 2304                         0.3358570                            0.1496688
Lag 2880                         0.2782121                            0.1436833
         nodematch.ubicacion
Lag 0              1.0000000
Lag 576            0.4840663
Lag 1152           0.3318695
Lag 1728           0.2821755
Lag 2304           0.2284347
Lag 2880           0.1844652

Sample statistics burn-in diagnostic (Geweke):
Chain 1 

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

                               edges                 gwesp.OTP.fixed.0.25 
                        -0.857525302                         -0.365429626 
                   gwideg.fixed.0.25                 edgecov.trust_matrix 
                        -1.687627240                         -0.935067963 
            edgecov.resources_matrix            edgecov.parentesco_matrix 
                         0.970112692                         -0.005143813 
                      nodematch.tipo    nodematch.orientacion.Conflictiva 
                        -1.127942233                         -0.516256129 
nodematch.orientacion.No_conflictiva                  nodematch.ubicacion 
                        -0.121592526                         -0.919287054 

Individual P-values (lower = worse):
                               edges                 gwesp.OTP.fixed.0.25 
                          0.39115464                           0.71479073 
                   gwideg.fixed.0.25                 edgecov.trust_matrix 
                          0.09148281                           0.34975328 
            edgecov.resources_matrix            edgecov.parentesco_matrix 
                          0.33199032                           0.99589585 
                      nodematch.tipo    nodematch.orientacion.Conflictiva 
                          0.25934432                           0.60567553 
nodematch.orientacion.No_conflictiva                  nodematch.ubicacion 
                          0.90322173                           0.35794545 
Joint P-value (lower = worse):  0.2739651 
Chain 2 

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

                               edges                 gwesp.OTP.fixed.0.25 
                           0.9356072                            0.1658378 
                   gwideg.fixed.0.25                 edgecov.trust_matrix 
                          -0.1285074                           -0.4289485 
            edgecov.resources_matrix            edgecov.parentesco_matrix 
                           2.1376506                           -1.5191622 
                      nodematch.tipo    nodematch.orientacion.Conflictiva 
                           1.1046990                            1.3965386 
nodematch.orientacion.No_conflictiva                  nodematch.ubicacion 
                           1.3711042                            0.3396664 

Individual P-values (lower = worse):
                               edges                 gwesp.OTP.fixed.0.25 
                          0.34947549                           0.86828461 
                   gwideg.fixed.0.25                 edgecov.trust_matrix 
                          0.89774741                           0.66796070 
            edgecov.resources_matrix            edgecov.parentesco_matrix 
                          0.03254511                           0.12872168 
                      nodematch.tipo    nodematch.orientacion.Conflictiva 
                          0.26929005                           0.16255237 
nodematch.orientacion.No_conflictiva                  nodematch.ubicacion 
                          0.17034248                           0.73410781 
Joint P-value (lower = worse):  0.004002474 

Note: To save space, only one in every 3 iterations of the MCMC sample
  used for estimation was stored for diagnostics. Sample size per chain
  was originally around 11187 with thinning interval 192.

Note: MCMC diagnostics shown here are from the last round of
  simulation, prior to computation of final parameter estimates.
  Because the final estimates are refinements of those used for this
  simulation run, these diagnostics may understate model performance.
  To directly assess the performance of the final model on in-model
  statistics, please use the GOF command: gof(ergmFitObject,
  GOF=~model).</code></pre>
</div>
</div>
</section>
<section id="difusión" class="level2">
<h2 class="anchored" data-anchor-id="difusión">Difusión</h2>
<p>Detalle de la función de difusión creada…</p>
<section id="cargamos-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargamos-datos">Cargamos datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Cargar datos</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>coop_matrix      <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/CoopNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>trust_matrix     <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/ConfianzaNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>resources_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/RecursosNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>values_matrix    <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"datos/ValoresNet.csv"</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Cargar atributos (cambiamos el nombre de la variable)</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>org_attributes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Atributos _org2011.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">conflictivo =</span> <span class="fu">trimws</span>(Orientación) <span class="sc">==</span> <span class="st">"Conflictiva"</span>,  <span class="co"># Crear variable conflictivo</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo =</span> Tipo_de_organización,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ubicacion =</span> Ubicación,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">orientacion =</span> Orientación</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Verificar la creación correcta de la variable</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Verificar variable conflictivo:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Verificar variable conflictivo:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(org_attributes<span class="sc">$</span>conflictivo, org_attributes<span class="sc">$</span>Orientación, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       
        Conflictiva No_conflictiva &lt;NA&gt;
  FALSE           0             41    0
  TRUE           29              0    0
  &lt;NA&gt;            0              0    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Preparar lista de redes</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>networks <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  trust_matrix,    <span class="co"># Red de confianza (peso 0.3)</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  values_matrix,   <span class="co"># Red de valores (peso 0.3)</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  coop_matrix,     <span class="co"># Red de cooperación (peso 0.2)</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  resources_matrix <span class="co"># Red de recursos (peso 0.2)</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="función-para-proceso-de-difusión" class="level3">
<h3 class="anchored" data-anchor-id="función-para-proceso-de-difusión">Función para proceso de difusión</h3>
<p>La función <code>improved_diffusion_v9</code> implementa un modelo de difusión de comportamientos conflictivos basado en la teoría de movimientos sociales y contienda política. El modelo integra conceptos clave de:</p>
<ul>
<li><strong>Teoría de Redes en Movimientos Sociales</strong> (Diani): Multiplicidad de vínculos, roles estructurales</li>
<li><strong>Dinámica de la Contienda</strong> (McAdam, Tilly, Tarrow): Mecanismos relacionales, repertorios de acción</li>
<li><strong>Costos de Acción Colectiva</strong> (Olson): Incentivos selectivos, problemas de coordinación</li>
<li><strong>Identidad Colectiva</strong> (Melucci): Alineamiento identitario, solidaridad</li>
</ul>
<section id="componentes-estructurales" class="level4">
<h4 class="anchored" data-anchor-id="componentes-estructurales">Componentes Estructurales</h4>
<section id="umbrales-heterogéneos" class="level5">
<h5 class="anchored" data-anchor-id="umbrales-heterogéneos">Umbrales Heterogéneos</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>thresholds <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">base =</span> <span class="fl">0.05</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">by_type =</span> <span class="fu">c</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Club deportivo "</span> <span class="ot">=</span> <span class="fl">0.15</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Comité de vivienda "</span> <span class="ot">=</span> <span class="fl">0.06</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Organización política de pobladores "</span> <span class="ot">=</span> <span class="fl">0.05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La heterogeneidad en umbrales refleja la teoría de Tarrow sobre “madrugadores” (early risers) en ciclos de protesta:</p>
<ul>
<li><strong>Organizaciones de pobladores</strong> (0.05): Menor umbral por su tradición histórica de movilización</li>
<li><strong>Comités de vivienda</strong> (0.06): Umbral bajo por demandas materiales concretas</li>
<li><strong>Organizaciones culturales/deportivas</strong> (0.15): Mayor umbral por orientación no confrontacional</li>
</ul>
</section>
</section>
<section id="multiplicidad-de-vínculos" class="level4">
<h4 class="anchored" data-anchor-id="multiplicidad-de-vínculos">Multiplicidad de Vínculos</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>) <span class="co"># Confianza, valores, parentesco, recursos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Siguiendo a Diani, se pondera diferencialmente distintos tipos de vínculos:</p>
<ul>
<li><strong>Vínculos fuertes</strong> (confianza/valores): Mayor peso (0.35) por su rol en motivar participación riesgosa</li>
<li><strong>Vínculos instrumentales</strong> (recursos): Menor peso (0.15) por su naturaleza transaccional</li>
<li><strong>Vínculos primordiales</strong> (parentesco): Peso reducido (0.15) por ser menos relevantes para acción colectiva</li>
</ul>
</section>
<section id="mecanismos-relacionales" class="level4">
<h4 class="anchored" data-anchor-id="mecanismos-relacionales">Mecanismos Relacionales</h4>
<section id="clustering-local" class="level5">
<h5 class="anchored" data-anchor-id="clustering-local">Clustering Local</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>calc_local_clustering <span class="ot">&lt;-</span> <span class="cf">function</span>(node, networks) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    cluster_scores <span class="ot">&lt;-</span> <span class="fu">sapply</span>(networks, <span class="cf">function</span>(x) {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>      neighbors <span class="ot">&lt;-</span> <span class="fu">which</span>(x[node,] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>      submat <span class="ot">&lt;-</span> x[neighbors, neighbors]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(submat) <span class="sc">/</span> (<span class="fu">length</span>(neighbors) <span class="sc">*</span> (<span class="fu">length</span>(neighbors)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Operacionaliza el concepto de “estructuras de movilización” (McAdam):</p>
<ul>
<li>Mide cohesión en entorno inmediato</li>
<li>Mayor clustering facilita coordinación</li>
<li>Reduce costos de acción colectiva</li>
</ul>
</section>
</section>
<section id="exposición-temporal" class="level4">
<h4 class="anchored" data-anchor-id="exposición-temporal">Exposición Temporal</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>calc_exposure_time <span class="ot">&lt;-</span> <span class="cf">function</span>(node, history, <span class="at">window =</span> memory_window) {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(current_window<span class="sc">:</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">weighted.mean</span>(exposed_neighbors, weights))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Implementa “memoria colectiva” en movilización:</p>
<ul>
<li>Exposición acumulada reduce percepción de riesgo</li>
<li>Decay exponencial modela olvido social</li>
<li>Ventana móvil captura ciclos de protesta</li>
</ul>
</section>
<section id="alineamiento-identitario" class="level4">
<h4 class="anchored" data-anchor-id="alineamiento-identitario">Alineamiento Identitario</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>identity_alignment <span class="ot">&lt;-</span> <span class="cf">function</span>(node, attributes) {</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    same_type <span class="ot">&lt;-</span> attributes<span class="sc">$</span>tipo <span class="sc">==</span> attributes<span class="sc">$</span>tipo[node]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    same_orientation <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Orientación <span class="sc">==</span> attributes<span class="sc">$</span>Orientación[node]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(same_type <span class="sc">&amp;</span> same_orientation))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Basado en teoría de identidad colectiva:</p>
<ul>
<li>Similitud organizacional fortalece solidaridad</li>
<li>Orientación política común facilita difusión</li>
<li>Alineamiento reduce barreras a adopción</li>
</ul>
</section>
<section id="roles-estructurales" class="level4">
<h4 class="anchored" data-anchor-id="roles-estructurales">Roles Estructurales</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>role_scores<span class="sc">$</span>broker_score <span class="ot">&lt;-</span> role_scores<span class="sc">$</span>between_score <span class="sc">+</span> role_scores<span class="sc">$</span>degree_score</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>role_scores<span class="sc">$</span>core_score <span class="ot">&lt;-</span> role_scores<span class="sc">$</span>eigen_score <span class="sc">+</span> role_scores<span class="sc">$</span>authority_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Operacionaliza roles clave en difusión (Tarrow):</p>
<ul>
<li><strong>Brokers</strong>: Conectan comunidades distintas</li>
<li><strong>Core</strong>: Liderazgo y legitimidad en red</li>
<li><strong>Authority</strong>: Influencia sobre adopción</li>
<li><strong>Peripheral</strong>: Seguidores potenciales</li>
</ul>
</section>
<section id="proceso-de-difusión" class="level4">
<h4 class="anchored" data-anchor-id="proceso-de-difusión">Proceso de Difusión</h4>
<section id="cálculo-de-influencia" class="level5">
<h5 class="anchored" data-anchor-id="cálculo-de-influencia">Cálculo de Influencia</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>combined_influence <span class="ot">&lt;-</span> net_influence <span class="sc">*</span> weights[n] <span class="sc">*</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    temporal_factor <span class="sc">*</span> cluster_multiplier <span class="sc">*</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> identity_effect) <span class="sc">/</span> action_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Integra múltiples mecanismos:</p>
<ol type="1">
<li><strong>Influencia base</strong>: Proporción de vecinos adoptantes</li>
<li><strong>Factor temporal</strong>: Exposición acumulada</li>
<li><strong>Multiplicador estructural</strong>: Efecto de clustering</li>
<li><strong>Efecto identitario</strong>: Alineamiento organizacional</li>
<li><strong>Costo de acción</strong>: Fricción estructural</li>
</ol>
</section>
<section id="umbrales-dinámicos" class="level5">
<h5 class="anchored" data-anchor-id="umbrales-dinámicos">Umbrales Dinámicos</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>final_threshold <span class="ot">&lt;-</span> (base_threshold <span class="sc">*</span> type_threshold) <span class="sc">*</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> exposure_effect) <span class="sc">*</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> cluster_effect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modela adaptación de umbrales por:</p>
<ul>
<li>Tipo organizacional (heterogeneidad)</li>
<li>Exposición temporal (aprendizaje)</li>
<li>Clustering local (solidaridad)</li>
</ul>
</section>
</section>
<section id="métricas-de-evaluación" class="level4">
<h4 class="anchored" data-anchor-id="métricas-de-evaluación">Métricas de Evaluación</h4>
<p>El modelo produce métricas que permiten evaluar:</p>
<ol type="1">
<li><strong>Patrones de Difusión</strong>
<ul>
<li>Tasa global de adopción</li>
<li>Variación por tipo organizacional</li>
<li>Trayectorias temporales</li>
</ul></li>
<li><strong>Efectos Estructurales</strong>
<ul>
<li>Impacto de clustering</li>
<li>Rol de brokers</li>
<li>Influencia de core</li>
</ul></li>
<li><strong>Mecanismos Relacionales</strong>
<ul>
<li>Exposición acumulada</li>
<li>Alineamiento identitario</li>
<li>Costos de acción</li>
</ul></li>
</ol>
</section>
<section id="en-síntesis" class="level4">
<h4 class="anchored" data-anchor-id="en-síntesis">En síntesis</h4>
<p>El modelo implementa computacionalmente teorías centrales de movimientos sociales:</p>
<ol type="1">
<li><strong>Dinámica relacional</strong> (McAdam, Tilly, Tarrow)
<ul>
<li>Mecanismos de difusión</li>
<li>Roles estructurales</li>
<li>Ciclos de protesta</li>
</ul></li>
<li><strong>Identidad y solidaridad</strong> (Melucci, Diani)
<ul>
<li>Alineamiento organizacional</li>
<li>Vínculos múltiples</li>
<li>Cohesión local</li>
</ul></li>
<li><strong>Acción colectiva</strong> (Olson)
<ul>
<li>Costos diferenciados</li>
<li>Incentivos estructurales</li>
<li>Problemas de coordinación</li>
</ul></li>
</ol>
<p>La implementación permite estudiar empíricamente:</p>
<ul>
<li>Patrones de difusión de repertorios</li>
<li>Roles estructurales en movilización</li>
<li>Mecanismos relacionales de protesta</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>org_attributes<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(org_attributes<span class="sc">$</span><span class="st">`</span><span class="at">X1PosciónCONCOR</span><span class="st">`</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>improved_diffusion_v9 <span class="ot">&lt;-</span> <span class="cf">function</span>(networks, attributes, seeds, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">max_iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">convergence_threshold =</span> <span class="fl">0.001</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">memory_window =</span> <span class="dv">5</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">use_heterogeneous_thresholds =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Umbrales realistas para comportamiento conflictivo</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  thresholds <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">base =</span> <span class="fl">0.05</span>, <span class="co"># Umbral base alto para comportamiento conflictivo</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">by_type =</span> <span class="fu">c</span>(</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Club deportivo "</span> <span class="ot">=</span> <span class="fl">0.15</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Comité de vivienda "</span> <span class="ot">=</span> <span class="fl">0.06</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Organización cultural "</span> <span class="ot">=</span> <span class="fl">0.10</span>,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Organización política de base "</span> <span class="ot">=</span> <span class="fl">0.07</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Organización política de pobladores "</span> <span class="ot">=</span> <span class="fl">0.05</span>,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">" Organización vecinal "</span> <span class="ot">=</span> <span class="fl">0.10</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Otros"</span> <span class="ot">=</span> <span class="fl">0.15</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Validación de entrada y preprocesamiento</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  networks <span class="ot">&lt;-</span> <span class="fu">lapply</span>(networks, <span class="cf">function</span>(x) {</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.matrix</span>(x)) <span class="fu">stop</span>(<span class="st">"Todas las redes deben ser matrices"</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">as.matrix</span>(x))</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">all</span>(<span class="fu">sapply</span>(networks, <span class="cf">function</span>(x) <span class="fu">all</span>(<span class="fu">dim</span>(x) <span class="sc">==</span> <span class="fu">dim</span>(networks[[<span class="dv">1</span>]])))))</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Todas las redes deben tener las mismas dimensiones"</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Inicialización</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>  n_nodes <span class="ot">&lt;-</span> <span class="fu">nrow</span>(networks[[<span class="dv">1</span>]])</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>) <span class="co"># Más peso a confianza y valores</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. Crear red compuesta</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>  composite_net <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, <span class="fu">Map</span>(<span class="st">"*"</span>, networks, weights))</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. Calcular medidas estructurales</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(composite_net, </span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">weighted =</span> <span class="cn">TRUE</span>, </span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">mode =</span> <span class="st">"directed"</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6. Medidas de centralidad</span></span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>  centrality_measures <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">between =</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(g, <span class="at">normalized =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g, <span class="at">mode =</span> <span class="st">"all"</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigen =</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(g)<span class="sc">$</span>vector,</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">authority =</span> igraph<span class="sc">::</span><span class="fu">authority_score</span>(g)<span class="sc">$</span>vector</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 7. Identificación de roles estructurales</span></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>  role_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">node =</span> <span class="dv">1</span><span class="sc">:</span>n_nodes,</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">between_score =</span> <span class="fu">scale</span>(centrality_measures<span class="sc">$</span>between),</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_score =</span> <span class="fu">scale</span>(centrality_measures<span class="sc">$</span>degree),</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigen_score =</span> <span class="fu">scale</span>(centrality_measures<span class="sc">$</span>eigen),</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">authority_score =</span> <span class="fu">scale</span>(centrality_measures<span class="sc">$</span>authority)</span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular scores compuestos</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  role_scores<span class="sc">$</span>broker_score <span class="ot">&lt;-</span> role_scores<span class="sc">$</span>between_score <span class="sc">+</span> role_scores<span class="sc">$</span>degree_score</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>  role_scores<span class="sc">$</span>core_score <span class="ot">&lt;-</span> role_scores<span class="sc">$</span>eigen_score <span class="sc">+</span> role_scores<span class="sc">$</span>authority_score</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Asignar roles con umbrales más estrictos</span></span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>  role_scores<span class="sc">$</span>role <span class="ot">&lt;-</span> <span class="fu">with</span>(role_scores, {</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(broker_score <span class="sc">&gt;</span> <span class="fu">quantile</span>(broker_score, <span class="fl">0.85</span>), <span class="st">"broker"</span>,</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(core_score <span class="sc">&gt;</span> <span class="fu">quantile</span>(core_score, <span class="fl">0.85</span>), <span class="st">"core"</span>,</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(authority_score <span class="sc">&gt;</span> <span class="fu">quantile</span>(authority_score, <span class="fl">0.85</span>), <span class="st">"authority"</span>,</span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"peripheral"</span>)))</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 8. Funciones auxiliares mejoradas</span></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>  calc_local_clustering <span class="ot">&lt;-</span> <span class="cf">function</span>(node, networks) {</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>    cluster_scores <span class="ot">&lt;-</span> <span class="fu">sapply</span>(networks, <span class="cf">function</span>(x) {</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>      neighbors <span class="ot">&lt;-</span> <span class="fu">which</span>(x[node,] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(neighbors) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>      submat <span class="ot">&lt;-</span> x[neighbors, neighbors]</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(submat) <span class="sc">/</span> (<span class="fu">length</span>(neighbors) <span class="sc">*</span> (<span class="fu">length</span>(neighbors)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">weighted.mean</span>(cluster_scores, weights)</span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a>  calc_exposure_time <span class="ot">&lt;-</span> <span class="cf">function</span>(node, history, <span class="at">window =</span> memory_window) {</span>
<span id="cb61-84"><a href="#cb61-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si no hay historia, retornar 0</span></span>
<span id="cb61-85"><a href="#cb61-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(history) <span class="sc">||</span> <span class="fu">is.null</span>(<span class="fu">dim</span>(history)) <span class="sc">||</span> <span class="fu">nrow</span>(history) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb61-86"><a href="#cb61-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-87"><a href="#cb61-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si no hay vecinos, retornar 0</span></span>
<span id="cb61-88"><a href="#cb61-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(node_neighbors[[node]]) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb61-89"><a href="#cb61-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-90"><a href="#cb61-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajustar ventana si es necesario</span></span>
<span id="cb61-91"><a href="#cb61-91" aria-hidden="true" tabindex="-1"></a>    current_window <span class="ot">&lt;-</span> <span class="fu">min</span>(window, <span class="fu">nrow</span>(history))</span>
<span id="cb61-92"><a href="#cb61-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-93"><a href="#cb61-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obtener historia reciente</span></span>
<span id="cb61-94"><a href="#cb61-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(current_window <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb61-95"><a href="#cb61-95" aria-hidden="true" tabindex="-1"></a>      recent_history <span class="ot">&lt;-</span> <span class="fu">matrix</span>(history, <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb61-96"><a href="#cb61-96" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb61-97"><a href="#cb61-97" aria-hidden="true" tabindex="-1"></a>      recent_history <span class="ot">&lt;-</span> <span class="fu">tail</span>(history, current_window)</span>
<span id="cb61-98"><a href="#cb61-98" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb61-99"><a href="#cb61-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-100"><a href="#cb61-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcular exposición de vecinos</span></span>
<span id="cb61-101"><a href="#cb61-101" aria-hidden="true" tabindex="-1"></a>    exposed_neighbors <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(recent_history[, node_neighbors[[node]], <span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb61-102"><a href="#cb61-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-103"><a href="#cb61-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcular pesos</span></span>
<span id="cb61-104"><a href="#cb61-104" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(current_window<span class="sc">:</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb61-105"><a href="#cb61-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-106"><a href="#cb61-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Retornar media ponderada</span></span>
<span id="cb61-107"><a href="#cb61-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">weighted.mean</span>(exposed_neighbors, weights))</span>
<span id="cb61-108"><a href="#cb61-108" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-109"><a href="#cb61-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-110"><a href="#cb61-110" aria-hidden="true" tabindex="-1"></a>  identity_alignment <span class="ot">&lt;-</span> <span class="cf">function</span>(node, attributes) {</span>
<span id="cb61-111"><a href="#cb61-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mide similitud en atributos organizacionales</span></span>
<span id="cb61-112"><a href="#cb61-112" aria-hidden="true" tabindex="-1"></a>    same_type <span class="ot">&lt;-</span> attributes<span class="sc">$</span>tipo <span class="sc">==</span> attributes<span class="sc">$</span>tipo[node]</span>
<span id="cb61-113"><a href="#cb61-113" aria-hidden="true" tabindex="-1"></a>    same_orientation <span class="ot">&lt;-</span> attributes<span class="sc">$</span>Orientación <span class="sc">==</span> attributes<span class="sc">$</span>Orientación[node]</span>
<span id="cb61-114"><a href="#cb61-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(same_type <span class="sc">&amp;</span> same_orientation))</span>
<span id="cb61-115"><a href="#cb61-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-116"><a href="#cb61-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-117"><a href="#cb61-117" aria-hidden="true" tabindex="-1"></a>  collective_action_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(node, role_scores) {</span>
<span id="cb61-118"><a href="#cb61-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Costo base por visibilidad estructural</span></span>
<span id="cb61-119"><a href="#cb61-119" aria-hidden="true" tabindex="-1"></a>    base_cost <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">abs</span>(role_scores<span class="sc">$</span>degree_score[node])</span>
<span id="cb61-120"><a href="#cb61-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-121"><a href="#cb61-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Modificador por rol</span></span>
<span id="cb61-122"><a href="#cb61-122" aria-hidden="true" tabindex="-1"></a>    role_modifier <span class="ot">&lt;-</span> <span class="cf">switch</span>(role_scores<span class="sc">$</span>role[node],</span>
<span id="cb61-123"><a href="#cb61-123" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"broker"</span> <span class="ot">=</span> <span class="fl">1.3</span>,</span>
<span id="cb61-124"><a href="#cb61-124" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"core"</span> <span class="ot">=</span> <span class="fl">1.2</span>,</span>
<span id="cb61-125"><a href="#cb61-125" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"authority"</span> <span class="ot">=</span> <span class="fl">1.1</span>,</span>
<span id="cb61-126"><a href="#cb61-126" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">1.0</span>)</span>
<span id="cb61-127"><a href="#cb61-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-128"><a href="#cb61-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(base_cost <span class="sc">*</span> role_modifier)</span>
<span id="cb61-129"><a href="#cb61-129" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-130"><a href="#cb61-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-131"><a href="#cb61-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9. Inicialización de estados y memorias</span></span>
<span id="cb61-132"><a href="#cb61-132" aria-hidden="true" tabindex="-1"></a>  states <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_nodes)</span>
<span id="cb61-133"><a href="#cb61-133" aria-hidden="true" tabindex="-1"></a>  states[seeds] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb61-134"><a href="#cb61-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-135"><a href="#cb61-135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear lista de vecinos</span></span>
<span id="cb61-136"><a href="#cb61-136" aria-hidden="true" tabindex="-1"></a>  node_neighbors <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) {</span>
<span id="cb61-137"><a href="#cb61-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(networks, <span class="cf">function</span>(x) <span class="fu">which</span>(x[i,] <span class="sc">&gt;</span> <span class="dv">0</span>))))</span>
<span id="cb61-138"><a href="#cb61-138" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-139"><a href="#cb61-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-140"><a href="#cb61-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 10. Inicialización de matrices de historia</span></span>
<span id="cb61-141"><a href="#cb61-141" aria-hidden="true" tabindex="-1"></a>  history <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> max_iterations, <span class="at">ncol =</span> n_nodes)</span>
<span id="cb61-142"><a href="#cb61-142" aria-hidden="true" tabindex="-1"></a>  history[<span class="dv">1</span>,] <span class="ot">&lt;-</span> states</span>
<span id="cb61-143"><a href="#cb61-143" aria-hidden="true" tabindex="-1"></a>  exposure_memory <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> max_iterations, <span class="at">ncol =</span> n_nodes)</span>
<span id="cb61-144"><a href="#cb61-144" aria-hidden="true" tabindex="-1"></a>  exposure_memory[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) {</span>
<span id="cb61-145"><a href="#cb61-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(node_neighbors[[i]]) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb61-146"><a href="#cb61-146" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(states[node_neighbors[[i]]])</span>
<span id="cb61-147"><a href="#cb61-147" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb61-148"><a href="#cb61-148" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span></span>
<span id="cb61-149"><a href="#cb61-149" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb61-150"><a href="#cb61-150" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-151"><a href="#cb61-151" aria-hidden="true" tabindex="-1"></a>  clustering_memory <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> max_iterations, <span class="at">ncol =</span> n_nodes)</span>
<span id="cb61-152"><a href="#cb61-152" aria-hidden="true" tabindex="-1"></a>  clustering_memory[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) <span class="fu">calc_local_clustering</span>(i, networks))</span>
<span id="cb61-153"><a href="#cb61-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-154"><a href="#cb61-154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 11. Proceso de difusión mejorado</span></span>
<span id="cb61-155"><a href="#cb61-155" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max_iterations) {</span>
<span id="cb61-156"><a href="#cb61-156" aria-hidden="true" tabindex="-1"></a>    old_states <span class="ot">&lt;-</span> states</span>
<span id="cb61-157"><a href="#cb61-157" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-158"><a href="#cb61-158" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Procesar nodos inactivos</span></span>
<span id="cb61-159"><a href="#cb61-159" aria-hidden="true" tabindex="-1"></a>    inactive_nodes <span class="ot">&lt;-</span> <span class="fu">which</span>(states <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb61-160"><a href="#cb61-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-161"><a href="#cb61-161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> inactive_nodes) {</span>
<span id="cb61-162"><a href="#cb61-162" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular influencia base</span></span>
<span id="cb61-163"><a href="#cb61-163" aria-hidden="true" tabindex="-1"></a>      influence <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-164"><a href="#cb61-164" aria-hidden="true" tabindex="-1"></a>      total_weight <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-165"><a href="#cb61-165" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb61-166"><a href="#cb61-166" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Influencia por tipo de red</span></span>
<span id="cb61-167"><a href="#cb61-167" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(n <span class="cf">in</span> <span class="fu">seq_along</span>(networks)) {</span>
<span id="cb61-168"><a href="#cb61-168" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="ot">&lt;-</span> <span class="fu">which</span>(networks[[n]][i,] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb61-169"><a href="#cb61-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(neighbors) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb61-170"><a href="#cb61-170" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Influencia ponderada por tipo de vínculo y tiempo</span></span>
<span id="cb61-171"><a href="#cb61-171" aria-hidden="true" tabindex="-1"></a>          net_influence <span class="ot">&lt;-</span> <span class="fu">sum</span>(states[neighbors]) <span class="sc">/</span> <span class="fu">length</span>(neighbors)</span>
<span id="cb61-172"><a href="#cb61-172" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-173"><a href="#cb61-173" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Factor temporal de exposición</span></span>
<span id="cb61-174"><a href="#cb61-174" aria-hidden="true" tabindex="-1"></a>          exposure_time <span class="ot">&lt;-</span> <span class="fu">calc_exposure_time</span>(i, history[<span class="dv">1</span><span class="sc">:</span>(iter<span class="dv">-1</span>), , <span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb61-175"><a href="#cb61-175" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-176"><a href="#cb61-176" aria-hidden="true" tabindex="-1"></a>          temporal_factor <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> exposure_time)</span>
<span id="cb61-177"><a href="#cb61-177" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-178"><a href="#cb61-178" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Efecto de clustering local</span></span>
<span id="cb61-179"><a href="#cb61-179" aria-hidden="true" tabindex="-1"></a>          cluster_effect <span class="ot">&lt;-</span> <span class="fu">calc_local_clustering</span>(i, networks)</span>
<span id="cb61-180"><a href="#cb61-180" aria-hidden="true" tabindex="-1"></a>          cluster_multiplier <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (cluster_effect <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb61-181"><a href="#cb61-181" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-182"><a href="#cb61-182" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Efecto de identidad</span></span>
<span id="cb61-183"><a href="#cb61-183" aria-hidden="true" tabindex="-1"></a>          identity_effect <span class="ot">&lt;-</span> <span class="fu">identity_alignment</span>(i, attributes)</span>
<span id="cb61-184"><a href="#cb61-184" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-185"><a href="#cb61-185" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Costo de acción colectiva</span></span>
<span id="cb61-186"><a href="#cb61-186" aria-hidden="true" tabindex="-1"></a>          action_cost <span class="ot">&lt;-</span> <span class="fu">collective_action_cost</span>(i, role_scores)</span>
<span id="cb61-187"><a href="#cb61-187" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-188"><a href="#cb61-188" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Combinar efectos</span></span>
<span id="cb61-189"><a href="#cb61-189" aria-hidden="true" tabindex="-1"></a>          combined_influence <span class="ot">&lt;-</span> net_influence <span class="sc">*</span> weights[n] <span class="sc">*</span> </span>
<span id="cb61-190"><a href="#cb61-190" aria-hidden="true" tabindex="-1"></a>            temporal_factor <span class="sc">*</span> cluster_multiplier <span class="sc">*</span> </span>
<span id="cb61-191"><a href="#cb61-191" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span> <span class="sc">+</span> identity_effect) <span class="sc">/</span> action_cost</span>
<span id="cb61-192"><a href="#cb61-192" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb61-193"><a href="#cb61-193" aria-hidden="true" tabindex="-1"></a>          influence <span class="ot">&lt;-</span> influence <span class="sc">+</span> combined_influence</span>
<span id="cb61-194"><a href="#cb61-194" aria-hidden="true" tabindex="-1"></a>          total_weight <span class="ot">&lt;-</span> total_weight <span class="sc">+</span> weights[n]</span>
<span id="cb61-195"><a href="#cb61-195" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb61-196"><a href="#cb61-196" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb61-197"><a href="#cb61-197" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb61-198"><a href="#cb61-198" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(total_weight <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb61-199"><a href="#cb61-199" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Normalizar influencia</span></span>
<span id="cb61-200"><a href="#cb61-200" aria-hidden="true" tabindex="-1"></a>        influence <span class="ot">&lt;-</span> influence <span class="sc">/</span> total_weight</span>
<span id="cb61-201"><a href="#cb61-201" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-202"><a href="#cb61-202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(use_heterogeneous_thresholds) {</span>
<span id="cb61-203"><a href="#cb61-203" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Threshold dinámico con heterogeneidad</span></span>
<span id="cb61-204"><a href="#cb61-204" aria-hidden="true" tabindex="-1"></a>          base_threshold <span class="ot">&lt;-</span> thresholds<span class="sc">$</span>base</span>
<span id="cb61-205"><a href="#cb61-205" aria-hidden="true" tabindex="-1"></a>          type_threshold <span class="ot">&lt;-</span> thresholds<span class="sc">$</span>by_type[attributes<span class="sc">$</span>tipo[i]]</span>
<span id="cb61-206"><a href="#cb61-206" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb61-207"><a href="#cb61-207" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Threshold dinámico sin heterogeneidad</span></span>
<span id="cb61-208"><a href="#cb61-208" aria-hidden="true" tabindex="-1"></a>          base_threshold <span class="ot">&lt;-</span> thresholds<span class="sc">$</span>base</span>
<span id="cb61-209"><a href="#cb61-209" aria-hidden="true" tabindex="-1"></a>          type_threshold <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb61-210"><a href="#cb61-210" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb61-211"><a href="#cb61-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-212"><a href="#cb61-212" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ajustar threshold por exposición temporal y clustering</span></span>
<span id="cb61-213"><a href="#cb61-213" aria-hidden="true" tabindex="-1"></a>        exposure_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(exposure_memory[<span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(<span class="dv">1</span>,iter<span class="dv">-1</span>), i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-214"><a href="#cb61-214" aria-hidden="true" tabindex="-1"></a>        cluster_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(clustering_memory[<span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(<span class="dv">1</span>,iter<span class="dv">-1</span>), i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-215"><a href="#cb61-215" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-216"><a href="#cb61-216" aria-hidden="true" tabindex="-1"></a>        final_threshold <span class="ot">&lt;-</span> (base_threshold <span class="sc">*</span> type_threshold) <span class="sc">*</span> </span>
<span id="cb61-217"><a href="#cb61-217" aria-hidden="true" tabindex="-1"></a>          <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> exposure_effect) <span class="sc">*</span></span>
<span id="cb61-218"><a href="#cb61-218" aria-hidden="true" tabindex="-1"></a>          (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> cluster_effect)</span>
<span id="cb61-219"><a href="#cb61-219" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-220"><a href="#cb61-220" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Probabilidad de adopción</span></span>
<span id="cb61-221"><a href="#cb61-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(influence <span class="sc">&gt;=</span> final_threshold) {</span>
<span id="cb61-222"><a href="#cb61-222" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Fricción en adopción</span></span>
<span id="cb61-223"><a href="#cb61-223" aria-hidden="true" tabindex="-1"></a>          adoption_prob <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> exposure_effect)</span>
<span id="cb61-224"><a href="#cb61-224" aria-hidden="true" tabindex="-1"></a>          states[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">min</span>(<span class="dv">1</span>, adoption_prob))</span>
<span id="cb61-225"><a href="#cb61-225" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb61-226"><a href="#cb61-226" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb61-227"><a href="#cb61-227" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb61-228"><a href="#cb61-228" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Actualizar memorias</span></span>
<span id="cb61-229"><a href="#cb61-229" aria-hidden="true" tabindex="-1"></a>      exposure_memory[iter, i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(node_neighbors[[i]]) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb61-230"><a href="#cb61-230" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">sum</span>(states[node_neighbors[[i]]]) <span class="sc">/</span> <span class="fu">length</span>(node_neighbors[[i]]),</span>
<span id="cb61-231"><a href="#cb61-231" aria-hidden="true" tabindex="-1"></a>                                         <span class="dv">0</span>)</span>
<span id="cb61-232"><a href="#cb61-232" aria-hidden="true" tabindex="-1"></a>      clustering_memory[iter, i] <span class="ot">&lt;-</span> <span class="fu">calc_local_clustering</span>(i, networks)</span>
<span id="cb61-233"><a href="#cb61-233" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb61-234"><a href="#cb61-234" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-235"><a href="#cb61-235" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Guardar historia</span></span>
<span id="cb61-236"><a href="#cb61-236" aria-hidden="true" tabindex="-1"></a>    history[iter,] <span class="ot">&lt;-</span> states</span>
<span id="cb61-237"><a href="#cb61-237" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-238"><a href="#cb61-238" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar convergencia</span></span>
<span id="cb61-239"><a href="#cb61-239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(iter <span class="sc">&gt;</span> <span class="dv">20</span>) {</span>
<span id="cb61-240"><a href="#cb61-240" aria-hidden="true" tabindex="-1"></a>      recent_window <span class="ot">&lt;-</span> (iter<span class="dv">-19</span>)<span class="sc">:</span>iter</span>
<span id="cb61-241"><a href="#cb61-241" aria-hidden="true" tabindex="-1"></a>      change_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">diff</span>(<span class="fu">colMeans</span>(history[recent_window,])))</span>
<span id="cb61-242"><a href="#cb61-242" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">abs</span>(change_rate) <span class="sc">&lt;</span> convergence_threshold) <span class="cf">break</span></span>
<span id="cb61-243"><a href="#cb61-243" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb61-244"><a href="#cb61-244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-245"><a href="#cb61-245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(old_states <span class="sc">==</span> states) <span class="sc">&amp;&amp;</span> iter <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="cf">break</span></span>
<span id="cb61-246"><a href="#cb61-246" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-247"><a href="#cb61-247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-248"><a href="#cb61-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 12. Calcular métricas finales</span></span>
<span id="cb61-249"><a href="#cb61-249" aria-hidden="true" tabindex="-1"></a>  final_metrics <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb61-250"><a href="#cb61-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">adoption_rate =</span> <span class="fu">mean</span>(states),</span>
<span id="cb61-251"><a href="#cb61-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">clustering_effect =</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) <span class="fu">calc_local_clustering</span>(i, networks)),</span>
<span id="cb61-252"><a href="#cb61-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">temporal_exposure =</span> <span class="fu">colMeans</span>(exposure_memory[<span class="dv">1</span><span class="sc">:</span>iter,], <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb61-253"><a href="#cb61-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">convergence_iteration =</span> iter,</span>
<span id="cb61-254"><a href="#cb61-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">change_trajectory =</span> <span class="fu">rowMeans</span>(history[<span class="dv">1</span><span class="sc">:</span>iter,]),</span>
<span id="cb61-255"><a href="#cb61-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">adoption_by_type =</span> <span class="fu">tapply</span>(states, attributes<span class="sc">$</span>tipo, mean),</span>
<span id="cb61-256"><a href="#cb61-256" aria-hidden="true" tabindex="-1"></a>    <span class="at">adoption_by_role =</span> <span class="fu">tapply</span>(states, role_scores<span class="sc">$</span>role, mean),</span>
<span id="cb61-257"><a href="#cb61-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_thresholds =</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) {</span>
<span id="cb61-258"><a href="#cb61-258" aria-hidden="true" tabindex="-1"></a>      base_threshold <span class="ot">&lt;-</span> <span class="cf">if</span>(use_heterogeneous_thresholds) {</span>
<span id="cb61-259"><a href="#cb61-259" aria-hidden="true" tabindex="-1"></a>        thresholds<span class="sc">$</span>by_type[attributes<span class="sc">$</span>tipo[i]]</span>
<span id="cb61-260"><a href="#cb61-260" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb61-261"><a href="#cb61-261" aria-hidden="true" tabindex="-1"></a>        thresholds<span class="sc">$</span>base</span>
<span id="cb61-262"><a href="#cb61-262" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb61-263"><a href="#cb61-263" aria-hidden="true" tabindex="-1"></a>      exposure_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(exposure_memory[<span class="dv">1</span><span class="sc">:</span>iter, i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-264"><a href="#cb61-264" aria-hidden="true" tabindex="-1"></a>      cluster_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(clustering_memory[<span class="dv">1</span><span class="sc">:</span>iter, i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-265"><a href="#cb61-265" aria-hidden="true" tabindex="-1"></a>      base_threshold <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> exposure_effect) <span class="sc">*</span></span>
<span id="cb61-266"><a href="#cb61-266" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> cluster_effect)</span>
<span id="cb61-267"><a href="#cb61-267" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb61-268"><a href="#cb61-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">network_effects =</span> <span class="fu">list</span>(</span>
<span id="cb61-269"><a href="#cb61-269" aria-hidden="true" tabindex="-1"></a>      <span class="at">clustering =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) <span class="fu">calc_local_clustering</span>(i, networks))),</span>
<span id="cb61-270"><a href="#cb61-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">exposure =</span> <span class="fu">mean</span>(<span class="fu">colMeans</span>(exposure_memory[<span class="dv">1</span><span class="sc">:</span>iter,], <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb61-271"><a href="#cb61-271" aria-hidden="true" tabindex="-1"></a>      <span class="at">identity =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) <span class="fu">identity_alignment</span>(i, attributes))),</span>
<span id="cb61-272"><a href="#cb61-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">costs =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_nodes, <span class="cf">function</span>(i) <span class="fu">collective_action_cost</span>(i, role_scores)))</span>
<span id="cb61-273"><a href="#cb61-273" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-274"><a href="#cb61-274" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-275"><a href="#cb61-275" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-276"><a href="#cb61-276" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 13. Retornar resultados</span></span>
<span id="cb61-277"><a href="#cb61-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb61-278"><a href="#cb61-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_states =</span> states,</span>
<span id="cb61-279"><a href="#cb61-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">history =</span> history[<span class="dv">1</span><span class="sc">:</span>iter,],</span>
<span id="cb61-280"><a href="#cb61-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_iterations =</span> iter,</span>
<span id="cb61-281"><a href="#cb61-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">role_scores =</span> role_scores,</span>
<span id="cb61-282"><a href="#cb61-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality_measures =</span> centrality_measures,</span>
<span id="cb61-283"><a href="#cb61-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">composite_net =</span> composite_net,</span>
<span id="cb61-284"><a href="#cb61-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure_memory =</span> exposure_memory[<span class="dv">1</span><span class="sc">:</span>iter,],</span>
<span id="cb61-285"><a href="#cb61-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">clustering_memory =</span> clustering_memory[<span class="dv">1</span><span class="sc">:</span>iter,],</span>
<span id="cb61-286"><a href="#cb61-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_metrics =</span> final_metrics,</span>
<span id="cb61-287"><a href="#cb61-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">converged =</span> iter <span class="sc">&lt;</span> max_iterations,</span>
<span id="cb61-288"><a href="#cb61-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb61-289"><a href="#cb61-289" aria-hidden="true" tabindex="-1"></a>      <span class="at">thresholds =</span> thresholds,</span>
<span id="cb61-290"><a href="#cb61-290" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> weights,</span>
<span id="cb61-291"><a href="#cb61-291" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_window =</span> memory_window,</span>
<span id="cb61-292"><a href="#cb61-292" aria-hidden="true" tabindex="-1"></a>      <span class="at">convergence_threshold =</span> convergence_threshold,</span>
<span id="cb61-293"><a href="#cb61-293" aria-hidden="true" tabindex="-1"></a>      <span class="at">use_heterogeneous_thresholds =</span> use_heterogeneous_thresholds</span>
<span id="cb61-294"><a href="#cb61-294" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-295"><a href="#cb61-295" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb61-296"><a href="#cb61-296" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="función-para-plotear" class="level3">
<h3 class="anchored" data-anchor-id="función-para-plotear">Función para plotear</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_diffusion_results_v2 <span class="ot">&lt;-</span> <span class="cf">function</span>(results, org_attributes) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(viridis)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Datos para difusión total</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  df_total <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results<span class="sc">$</span>history),</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion =</span> <span class="fu">rowMeans</span>(results<span class="sc">$</span>history),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure =</span> <span class="fu">rowMeans</span>(results<span class="sc">$</span>exposure_memory)  <span class="co"># Cambio aquí: rowMeans en lugar de colMeans</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Datos por tipo de organización</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  df_by_type <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(results<span class="sc">$</span>history) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>iteration, <span class="at">names_to =</span> <span class="st">"node"</span>, <span class="at">values_to =</span> <span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">node =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9]"</span>, <span class="st">""</span>, node))) <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">node =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(org_attributes),</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">tipo =</span> org_attributes<span class="sc">$</span>Tipo_de_organización</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"node"</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(iteration, tipo) <span class="sc">%&gt;%</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">proportion =</span> <span class="fu">mean</span>(state),</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_adopted =</span> <span class="fu">sum</span>(state),</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_total =</span> <span class="fu">n</span>(),</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Análisis de roles y adopción</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  role_adoption <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">role =</span> <span class="fu">factor</span>(results<span class="sc">$</span>role_scores<span class="sc">$</span>role),</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">adopted =</span> <span class="fu">factor</span>(results<span class="sc">$</span>final_states)</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(role) <span class="sc">%&gt;%</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">adopted =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(adopted))),</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">proportion =</span> adopted<span class="sc">/</span>n</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. Análisis de bloques estructurales</span></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  node_cohesion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">node =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results<span class="sc">$</span>final_metrics<span class="sc">$</span>clustering_effect),</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohesion =</span> results<span class="sc">$</span>final_metrics<span class="sc">$</span>clustering_effect</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>  block_adoption <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">node =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results<span class="sc">$</span>final_states),</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> <span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results<span class="sc">$</span>final_states) <span class="sc">&lt;=</span> <span class="fu">nrow</span>(org_attributes),</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">as.character</span>(org_attributes<span class="sc">$</span>block), <span class="st">"Unknown"</span>),</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">adopted =</span> results<span class="sc">$</span>final_states</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(node_cohesion, <span class="at">by =</span> <span class="st">"node"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(block) <span class="sc">%&gt;%</span></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">adoption_rate =</span> <span class="fu">mean</span>(adopted),</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">cohesion =</span> <span class="fu">mean</span>(cohesion, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. Visualizaciones</span></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_total, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> proportion)) <span class="sc">+</span></span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#2C3E50"</span>) <span class="sc">+</span></span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#E74C3C"</span>) <span class="sc">+</span></span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> exposure), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#8E44AD"</span>) <span class="sc">+</span></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Difusión Global y Exposición"</span>,</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Adopción final: %.1f%%"</span>, </span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>                         results<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_rate <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Iteración"</span>,</span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Proporción"</span></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_by_type, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> proportion, <span class="at">color =</span> tipo)) <span class="sc">+</span></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Difusión por Tipo de Organización"</span>,</span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Iteración"</span>,</span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Proporción Adoptante"</span>,</span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Tipo de Organización"</span></span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(role_adoption, </span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(role, proportion), <span class="at">y =</span> proportion)) <span class="sc">+</span></span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#2C3E50"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion)), </span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Adopción Final por Rol Estructural"</span>,</span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Rol"</span>,</span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Proporción Adoptante"</span></span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a>  p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(block_adoption, <span class="fu">aes</span>(<span class="at">x =</span> cohesion, <span class="at">y =</span> adoption_rate)) <span class="sc">+</span></span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#E74C3C"</span>) <span class="sc">+</span></span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#2C3E50"</span>) <span class="sc">+</span></span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Adopción vs Cohesión por Bloque Estructural"</span>,</span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Cohesión Estructural del Bloque"</span>,</span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Tasa de Adopción del Bloque"</span></span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6. Combinar visualizaciones</span></span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a>  layout <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a><span class="st">  AB</span></span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a><span class="st">  CD</span></span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span></span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">+</span></span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(</span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Análisis de Difusión de Comportamiento Conflictivo"</span>,</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Iteraciones: %d | Convergencia en: %.1f%% de adopción"</span>, </span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a>                         results<span class="sc">$</span>n_iterations,</span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a>                         results<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_rate <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_plot)</span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ejecutar-funciones" class="level3">
<h3 class="anchored" data-anchor-id="ejecutar-funciones">Ejecutar funciones</h3>
<section id="resultados-heterogeneous-thresholds-false" class="level4">
<h4 class="anchored" data-anchor-id="resultados-heterogeneous-thresholds-false">Resultados heterogeneous thresholds = FALSE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecutar una simulación</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">improved_diffusion_v9</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">networks =</span> networks,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">attributes =</span> org_attributes,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seeds =</span> <span class="fu">which</span>(org_attributes<span class="sc">$</span>tipo <span class="sc">==</span> <span class="st">" Organización política de pobladores "</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_heterogeneous_thresholds =</span> <span class="cn">FALSE</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar resultados</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_diffusion_results_v2</span>(results, org_attributes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultados-heterogeneous-thresholds-true" class="level4">
<h4 class="anchored" data-anchor-id="resultados-heterogeneous-thresholds-true">Resultados heterogeneous thresholds = TRUE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecutar una simulación</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">improved_diffusion_v9</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">networks =</span> networks,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">attributes =</span> org_attributes,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seeds =</span> <span class="fu">which</span>(org_attributes<span class="sc">$</span>tipo <span class="sc">==</span> <span class="st">" Organización política de pobladores "</span>),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_heterogeneous_thresholds =</span> <span class="cn">TRUE</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar resultados</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_diffusion_results_v2</span>(results, org_attributes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This suggests:</p>
<ul>
<li>Complex contagion varies by organizational type</li>
<li>Structural position moderates adoption thresholds</li>
<li>Identity transformation requires both exposure and capacity</li>
</ul>
</section>
</section>
<section id="simulaciones-heterogeneous-thresholds-true" class="level3">
<h3 class="anchored" data-anchor-id="simulaciones-heterogeneous-thresholds-true">Simulaciones heterogeneous thresholds = TRUE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para ejecutar múltiples simulaciones</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>run_multiple_simulations <span class="ot">&lt;-</span> <span class="cf">function</span>(networks, attributes, seeds, <span class="at">n_sims =</span> <span class="dv">100</span>) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    results_list[[i]] <span class="ot">&lt;-</span> <span class="fu">improved_diffusion_v9</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">networks =</span> networks,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">attributes =</span> attributes,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seeds =</span> seeds</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular estadísticas agregadas</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  adoption_rates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results_list, <span class="cf">function</span>(x) x<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_rate)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  iterations <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results_list, <span class="cf">function</span>(x) x<span class="sc">$</span>n_iterations)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_adoption =</span> <span class="fu">mean</span>(adoption_rates),</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_adoption =</span> <span class="fu">sd</span>(adoption_rates),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_iterations =</span> <span class="fu">mean</span>(iterations),</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_iterations =</span> <span class="fu">sd</span>(iterations),</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">results =</span> results_list</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co"># O ejecutar múltiples simulaciones</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>multiple_results <span class="ot">&lt;-</span> <span class="fu">run_multiple_simulations</span>(</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">networks =</span> networks,</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">attributes =</span> org_attributes,</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">seeds =</span> <span class="fu">which</span>(org_attributes<span class="sc">$</span>tipo <span class="sc">==</span> <span class="st">" Organización política de pobladores "</span>),</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_sims =</span> <span class="dv">100</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis de la infomracióm simulada</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>mean_adoption_rate <span class="ot">&lt;-</span> multiple_results<span class="sc">$</span>mean_adoption</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>sd_adoption_rate <span class="ot">&lt;-</span> multiple_results<span class="sc">$</span>sd_adoption</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La tasa de adopción final promedio es:"</span>, <span class="fu">round</span>(mean_adoption_rate <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La tasa de adopción final promedio es: 35.84 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La desviación estándar de la tasa de adopción final es:"</span>, <span class="fu">round</span>(sd_adoption_rate <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La desviación estándar de la tasa de adopción final es: 1.25 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Trayectorias simuladas</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>diffusion_trajectories <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(multiple_results<span class="sc">$</span>results), <span class="cf">function</span>(i) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">iteration =</span> <span class="fu">seq_along</span>(multiple_results<span class="sc">$</span>results[[i]]<span class="sc">$</span>final_metrics<span class="sc">$</span>change_trajectory),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">adoption_rate =</span> multiple_results<span class="sc">$</span>results[[i]]<span class="sc">$</span>final_metrics<span class="sc">$</span>change_trajectory,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">simulation =</span> <span class="fu">paste</span>(<span class="st">"Simulación"</span>, i)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>diffusion_trajectories <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, diffusion_trajectories)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diffusion_trajectories, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> adoption_rate, <span class="at">color =</span> simulation)) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iteración"</span>, <span class="at">y =</span> <span class="st">"Tasa de Adopción"</span>) <span class="sc">+</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trayectorias de Difusión"</span>) <span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adopción por tipo y rol</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>adoption_by_type <span class="ot">&lt;-</span> <span class="fu">lapply</span>(multiple_results<span class="sc">$</span>results, <span class="cf">function</span>(x) x<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_by_type)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>adoption_by_role <span class="ot">&lt;-</span> <span class="fu">lapply</span>(multiple_results<span class="sc">$</span>results, <span class="cf">function</span>(x) x<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_by_role)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>mean_adoption_by_type <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, adoption_by_type) <span class="sc">/</span> <span class="fu">length</span>(adoption_by_type)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>mean_adoption_by_role <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, adoption_by_role) <span class="sc">/</span> <span class="fu">length</span>(adoption_by_role)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Adopción promedio por tipo de organización:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adopción promedio por tipo de organización:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_adoption_by_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Club deportivo                    Comité de vivienda  
                            0.0000000                             0.3322222 
               Organización cultural         Organización política de base  
                            0.4069231                             0.9783333 
 Organización política de pobladores                  Organización vecinal  
                            1.0000000                             0.1829630 
                                Otros 
                            0.0000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Adopción promedio por rol estructural:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adopción promedio por rol estructural:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_adoption_by_role)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> authority     broker       core peripheral 
 0.4800000  0.8072727  0.9833333  0.1890385 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adopción y centralidad </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>centrality_measures <span class="ot">&lt;-</span> <span class="fu">lapply</span>(multiple_results<span class="sc">$</span>results, <span class="cf">function</span>(x) x<span class="sc">$</span>centrality_measures)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>clustering_effects <span class="ot">&lt;-</span> <span class="fu">lapply</span>(multiple_results<span class="sc">$</span>results, <span class="cf">function</span>(x) x<span class="sc">$</span>final_metrics<span class="sc">$</span>clustering_effect)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo: Correlación promedio entre centralidad de grado y adopción final</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>cor_degree_adoption <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_along</span>(centrality_measures), <span class="cf">function</span>(i) {</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  degree_centrality <span class="ot">&lt;-</span> centrality_measures[[i]]<span class="sc">$</span>degree</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  adoption_status <span class="ot">&lt;-</span> multiple_results<span class="sc">$</span>results[[i]]<span class="sc">$</span>final_states</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(degree_centrality, adoption_status)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>mean_cor_degree_adoption <span class="ot">&lt;-</span> <span class="fu">mean</span>(cor_degree_adoption)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlación promedio entre centralidad de grado y adopción final:"</span>, <span class="fu">round</span>(mean_cor_degree_adoption, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlación promedio entre centralidad de grado y adopción final: 0.74 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que ejecutaste múltiples simulaciones con diferentes parámetros y los resultados están en `multiple_results`</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mean_adoption_rates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(multiple_results<span class="sc">$</span>results, <span class="cf">function</span>(x) x<span class="sc">$</span>final_metrics<span class="sc">$</span>adoption_rate)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mean_adoption_rates, <span class="at">xlab =</span> <span class="st">"Simulación"</span>, <span class="at">ylab =</span> <span class="st">"Tasa de Adopción Final"</span>, <span class="at">main =</span> <span class="st">"Análisis de Sensibilidad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-18-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="index_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="relaciones-múltiples" class="level2">
<h2 class="anchored" data-anchor-id="relaciones-múltiples">Relaciones múltiples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis de tipos de vínculos por organización</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>analyze_tie_types <span class="ot">&lt;-</span> <span class="cf">function</span>(networks, org_id) {</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contar en cuántas redes diferentes tiene vínculos la organización</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  tie_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(networks, <span class="cf">function</span>(net) <span class="fu">any</span>(net[org_id,] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> net[,org_id] <span class="sc">&gt;</span> <span class="dv">0</span>)))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tie_count)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar a todas las organizaciones</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>tie_types <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(networks[[<span class="dv">1</span>]]), <span class="cf">function</span>(i) <span class="fu">analyze_tie_types</span>(networks, i))</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Cruzar con resultados de adopción</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>adoption_by_tie_types <span class="ot">&lt;-</span> <span class="fu">tapply</span>(results<span class="sc">$</span>final_states, tie_types, mean)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>adoption_by_tie_types</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0         2         3         4 
0.0000000 0.0000000 0.2500000 0.4615385 </code></pre>
</div>
</div>
<p>Esto significa que:</p>
<ul>
<li>Organizaciones con 0 tipos de vínculos: 0% de adopción</li>
<li>Organizaciones con 2 tipos de vínculos: 0% de adopción</li>
<li>Organizaciones con 3 tipos de vínculos: 25% de adopción</li>
<li>Organizaciones con 4 tipos de vínculos: 46.15% de adopción</li>
</ul>
<p>Este es un hallazgo importante que muestra:</p>
<ul>
<li>Efecto escalonado de la multiplexidad: Hay un claro patrón donde más tipos de vínculos llevan a mayor probabilidad de adopción.</li>
<li>Umbral crítico: Parece haber un umbral importante en 3 vínculos, donde comienza a verse adopción.</li>
<li>Máximo efecto: Las organizaciones con 4 tipos de vínculos tienen casi el doble de probabilidad de adopción que las que tienen 3 tipos.</li>
<li>This supports Centola &amp; Macy’s (2007) complex contagion theory while adding crucial nuance about tie multiplexity.</li>
<li>These findings extend Baldassarri &amp; Diani’s (2007) network integration theory by showing how different types of ties interact to produce qualitatively different outcomes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Número de organizaciones por categoría de vínculos</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tie_types)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tie_types
 0  2  3  4 
10  4  4 52 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Para cada categoría, analizar qué tipos de vínculos tienen</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>analyze_link_types <span class="ot">&lt;-</span> <span class="cf">function</span>(networks, org_id) {</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ver qué tipos de redes tienen vínculos</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  types <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(networks), <span class="cf">function</span>(n) {</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any</span>(networks[[n]][org_id,] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> networks[[n]][,org_id] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(types)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para todas las organizaciones</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>org_link_patterns <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(networks[[<span class="dv">1</span>]]), <span class="cf">function</span>(i) </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_link_types</span>(networks, i)))</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupar por número de vínculos y ver patrones comunes</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>link_patterns_by_count <span class="ot">&lt;-</span> <span class="fu">split</span>(</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(org_link_patterns), </span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  tie_types</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver también los tipos de organizaciones en cada categoría</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>org_types_by_links <span class="ot">&lt;-</span> <span class="fu">split</span>(</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  org_attributes<span class="sc">$</span>tipo,</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  tie_types</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="co">#org_types_by_links</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Distribución de multiplexidad por tipo de organización</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tipo =</span> <span class="fu">unlist</span>(org_types_by_links),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vinculos =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="fu">sapply</span>(org_types_by_links, length))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> tipo, <span class="at">fill =</span> <span class="fu">factor</span>(vinculos)), <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">name =</span> <span class="st">"Número de</span><span class="sc">\n</span><span class="st">vínculos"</span>) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de Multiplexidad por Tipo Organizacional"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tipo de Organización"</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporción"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The distribution of multiplex ties reveals clear organizational patterns. Political organizations and housing committees show consistently high levels of multiplexity, while neighborhood organizations display a bimodal pattern.</p>
<section id="polarized-distribution" class="level4">
<h4 class="anchored" data-anchor-id="polarized-distribution">Polarized Distribution:</h4>
<ul>
<li>Most organizations either have maximum connectivity (4 ties) or minimal connectivity (0 ties)</li>
<li>Political organizations consistently maintain multiple ties</li>
<li>Neighborhood organizations show bimodal distribution</li>
</ul>
</section>
<section id="organizational-capacity" class="level4">
<h4 class="anchored" data-anchor-id="organizational-capacity">Organizational Capacity:</h4>
<ul>
<li>100% of political base organizations have 4 ties</li>
<li>100% of housing committees have 4 ties</li>
<li>Cultural organizations show mixed patterns</li>
</ul>
<p>[Quote opportunity: Discussing organizational differences in maintaining relationships]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Tasa de adopción por nivel de multiplexidad</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vinculos =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">adopcion =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.4615385</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> vinculos, <span class="at">y =</span> adopcion, <span class="at">fill =</span> adopcion), </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasa de Adopción por Nivel de Multiplexidad"</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de Vínculos"</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tasa de Adopción"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The relationship between multiple ties and adoption shows a clear threshold effect. Organizations with fewer than three types of ties show no adoption, while those with four types of ties show the highest adoption rates (46.15%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Composición de grupos por multiplexidad</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vinculos =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="fu">sapply</span>(org_types_by_links, length)),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="dv">1</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(vinculos), <span class="at">fill =</span> <span class="fu">factor</span>(vinculos))) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Número de Organizaciones por Nivel de Multiplexidad"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de Vínculos"</span>,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cantidad de Organizaciones"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The structural composition of the network shows a polarized pattern, with most organizations either having no multiple ties (10 organizations) or the maximum number of ties (52 organizations), suggesting a core-periphery structure in the movement network.</p>
<p>[<em>Quote opportunity: Leader discussing how different types of relationships combined in practice</em>]</p>
</section>
</section>
<section id="discusión" class="level2">
<h2 class="anchored" data-anchor-id="discusión">Discusión</h2>
<p>Este modelo incorpora varios elementos teóricos clave:</p>
<ol type="1">
<li><p><strong>Multiplexidad de vínculos</strong>: Considera cinco tipos de relaciones con diferentes pesos según su importancia teórica para la difusión de identidades políticas.</p></li>
<li><p><strong>Roles estructurales</strong>: Identifica brokers y organizaciones núcleo usando una combinación de medidas de centralidad y multiplexidad.</p></li>
<li><p><strong>Umbrales heterogéneos</strong>: Aplica diferentes umbrales de adopción según el tipo de organización, reflejando su propensión a adoptar posturas contenciosas.</p></li>
<li><p><strong>Mecanismos de influencia</strong>:</p>
<ul>
<li>Efecto directo de vínculos múltiples</li>
<li>Bonus por tipo de vínculo (confianza y valores)</li>
<li>Efectos de rol estructural (brokers y cores)</li>
</ul></li>
<li><p><strong>Complex contagion</strong>: Requiere exposición múltiple y considera la estructura local de la red.</p></li>
</ol>
<p>Los resultados sugieren que:</p>
<ol type="1">
<li>Las organizaciones políticas de pobladores actúan como núcleo efectivo del proceso de difusión.</li>
<li>La multiplexidad de vínculos acelera la adopción.</li>
<li>Existen umbrales críticos que varían por tipo organizativo.</li>
<li>Los brokers juegan un rol clave en conectar diferentes dominios organizativos.</li>
</ol>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Baldassarri, D., &amp; Diani, M. (2007). The integrative power of civic networks. American Journal of Sociology, 113(3), 735-780.</p>
<p>Centola, D. (2018). How behavior spreads: The science of complex contagions. Princeton University Press.</p>
<p>Centola, D., &amp; Macy, M. (2007). Complex contagions and the weakness of long ties. American Journal of Sociology, 113(3), 702-734.</p>
<p>Diani, M. (2003). Networks and social movements: A research programme. In M. Diani &amp; D. McAdam (Eds.), Social movements and networks: Relational approaches to collective action (pp.&nbsp;299-319). Oxford University Press.</p>
<p>Diani, M. (2015). The cement of civil society. Cambridge University Press.</p>
<p>Domínguez, S., &amp; Hollstein, B. (2014). Mixed methods social networks research: Design and applications. Cambridge University Press.</p>
<p>Gould, R. V. (1991). Multiple networks and mobilization in the Paris Commune, 1871. American Sociological Review, 56(6), 716-729.</p>
<p>McAdam, D., &amp; Paulsen, R. (1993). Specifying the relationship between social ties and activism. American Journal of Sociology, 99(3), 640-667.</p>
<p>McAdam, D., Tarrow, S., &amp; Tilly, C. (2001). Dynamics of contention. Cambridge University Press.</p>
<p>Mische, A. (2003). Cross-talk in movements: Reconceiving the culture-network link. In M. Diani &amp; D. McAdam (Eds.), Social movements and networks: Relational approaches to collective action (pp.&nbsp;258-280). Oxford University Press.</p>
<p>Passy, F., &amp; Giugni, M. (2001). Social networks and individual perceptions: Explaining differential participation in social movements. Sociological Forum, 16(1), 123-153.</p>
<p>Scott, J. (2011). Social network analysis: Developments, advances, and prospects. Social Network Analysis and Mining, 1(1), 21-26.</p>
<p>Tarrow, S. (2005). The new transnational activism. Cambridge University Press.</p>
<p>Tilly, C. (2004). Social boundary mechanisms. Philosophy of the Social Sciences, 34(2), 211-236.</p>
<p>Tilly, C., &amp; Tarrow, S. (2015). Contentious politics (2nd ed.). Oxford University Press.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/rcantillan\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 Roberto Cantillan ∙ Made with <a href="https://quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p><a class="link-dark me-1" href="../../../accessibility.html" title="Accessibility commitment" target="_blank" rel="noopener"><i class="fa-solid fa-universal-access" aria-label="universal-access"></i></a> <a class="link-dark me-1" href="" title="Substack" target="_blank" rel="noopener"><i class="bi-substack " style="" role="img" aria-hidden="true"></i></a> <a class="link-dark me-1" href="https://github.com/rcantillan" title="github" target="_blank" rel="noopener"><i class="fa-brands fa-github" aria-label="github"></i></a> <a class="link-dark me-1" href="https://cl.linkedin.com/in/roberto-cantillan-carrasco-67620517b" title="LinkedIn" target="_blank" rel="noopener"><i class="fa-brands fa-linkedin" aria-label="linkedin"></i></a> <a class="link-dark me-1" href="https://orcid.org/0000-0003-0494-0692;" title="orcid" target="_blank" rel="noopener"><i class="ai  ai-orcid" style="color:black"></i></a> <a class="link-dark me-1" href="https://scholar.google.com/citations?user=xZkAmvAAAAAJ&amp;hl=es" title="Google Scholar" target="_blank" rel="noopener"><i class="ai  ai-google-scholar" style="color:black"></i></a></p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../accessibility.qmd">
<p>Accessibility</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../contact.qmd">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../license.qmd">
<p>License</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog/index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","openEffect":"zoom","loop":false,"selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
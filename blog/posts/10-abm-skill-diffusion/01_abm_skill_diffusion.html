<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roberto Cantillan &amp; Mauricio Bucca">
<meta name="dcterms.date" content="2025-07-30">

<title>Agent-Based Model: Asymmetric Trajectory Channeling of skills in Labor Markets – Roberto Cantillan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-9519443a8c50f3421c15abbdb1fc3938.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-32e64e11d264661c9dda202d8f199470.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/bootstrap-icons-1.9.1/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: rgba(0, 0, 0, 0.8);
      }

      .quarto-title-block .quarto-title-banner {
        color: rgba(0, 0, 0, 0.8);
background-image: url(featured.jpg);
background-size: cover;
      }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg border-bottom" data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/noun-small-world-network-6148828.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Roberto Cantillan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../talk/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../publication/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../project/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resources/index.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rcantillan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Agent-Based Model: Asymmetric Trajectory Channeling of skills in Labor Markets</h1>
            <p class="subtitle lead">A Generative Validation of Cultural Theorization through a Parsimonious Imitation Model</p>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Diffusion Theory</div>
                <div class="quarto-category">Polarization</div>
                <div class="quarto-category">Stratification</div>
                <div class="quarto-category">Inequality</div>
                <div class="quarto-category">Labor Markets</div>
                <div class="quarto-category">Agent Based Modelling</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Roberto Cantillan &amp; Mauricio Bucca </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Sociology, PUC
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 30, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">in this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#theoretical-framework-from-employer-decisions-to-labor-market-structure" id="toc-theoretical-framework-from-employer-decisions-to-labor-market-structure" class="nav-link" data-scroll-target="#theoretical-framework-from-employer-decisions-to-labor-market-structure">1. Theoretical Framework: From Employer Decisions to Labor Market Structure</a></li>
  <li><a href="#abm-architecture-from-theory-to-a-generative-model" id="toc-abm-architecture-from-theory-to-a-generative-model" class="nav-link" data-scroll-target="#abm-architecture-from-theory-to-a-generative-model">2. ABM Architecture: From Theory to a Generative Model</a></li>
  <li><a href="#enhanced-model-implementation-and-analysis" id="toc-enhanced-model-implementation-and-analysis" class="nav-link" data-scroll-target="#enhanced-model-implementation-and-analysis">3. Enhanced Model Implementation and Analysis</a></li>
  <li><a href="#enhanced-results-comprehensive-generative-validation" id="toc-enhanced-results-comprehensive-generative-validation" class="nav-link" data-scroll-target="#enhanced-results-comprehensive-generative-validation">4. Enhanced Results: Comprehensive Generative Validation</a></li>
  <li><a href="#discussion-and-validation-summary" id="toc-discussion-and-validation-summary" class="nav-link" data-scroll-target="#discussion-and-validation-summary">5. Discussion and Validation Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="abstract" class="level3">
<h3 class="anchored" data-anchor-id="abstract">Abstract</h3>
<p>This Agent-Based Model provides comprehensive generative validation of our theory by demonstrating that a single continuous parameter—<strong>perceived skill transferability (τ)</strong>—is sufficient, robust, and necessary to reproduce the empirically observed asymmetric channeling patterns. Using τ ∈ [0,1] to weight aspirational versus proximity imitation (P_imit = τ·P_asp + (1-τ)·P_prox), we show that cognitive skills (high τ) exhibit upward channeling while physical skills (low τ) show lateral containment across 20 sensitivity tests and comparisons with null/reversed models. Extended analyses reveal emergent segregation patterns, temporal dynamics of inequality evolution, and policy intervention effects, strengthening the <strong>causal inference</strong> that cultural theorization is a fundamental mechanism driving the reproduction of stratification in labor markets.</p>
<hr>
</section>
<section id="theoretical-framework-from-employer-decisions-to-labor-market-structure" class="level3">
<h3 class="anchored" data-anchor-id="theoretical-framework-from-employer-decisions-to-labor-market-structure">1. Theoretical Framework: From Employer Decisions to Labor Market Structure</h3>
<p>The architecture of inequality in the labor market is not a static blueprint but a dynamic, actively reproduced process. Its foundations lie in the everyday decisions of <strong>employers within organizations</strong>, who determine which skill requirements to establish. Foundational studies have shown that the skill landscape is polarized into distinct domains—a socio-cognitive cluster associated with high wages and a sensory-physical one with low wages <span class="citation" data-cites="alabdulkareem_unpacking_2018">(<a href="#ref-alabdulkareem_unpacking_2018" role="doc-biblioref">Alabdulkareem et al. 2018</a>)</span>—and that this space possesses a nested, hierarchical architecture <span class="citation" data-cites="hosseinioun_skill_2025">(<a href="#ref-hosseinioun_skill_2025" role="doc-biblioref">Hosseinioun et al. 2025</a>)</span>.</p>
<section id="the-micro-foundations-of-organizational-imitation" class="level4">
<h4 class="anchored" data-anchor-id="the-micro-foundations-of-organizational-imitation">1.1. The Micro-Foundations of Organizational Imitation</h4>
<p>Contemporary labor markets exhibit a fundamental paradox: unprecedented dynamism coexists with persistent occupational stratification <span class="citation" data-cites="kalleberg_good_2013 tilly_durable_2009">(<a href="#ref-kalleberg_good_2013" role="doc-biblioref">Kalleberg 2013</a>; <a href="#ref-tilly_durable_2009" role="doc-biblioref">Tilly 2009</a>)</span>. We argue that <strong>employers imitate skill requirements according to fundamentally different logics depending on the nature of the skill in question</strong>. The literature suggests three key mechanisms driving imitation:</p>
<ol type="1">
<li><strong>Uncertainty and Bounded Rationality:</strong> Under conditions of uncertainty, organizations often imitate others as a decision-making shortcut to reduce search costs <span class="citation" data-cites="cyert_behavioral_2006 dimaggio_iron_1983">(<a href="#ref-cyert_behavioral_2006" role="doc-biblioref">Cyert, Cyert, and March 2006</a>; <a href="#ref-dimaggio_iron_1983" role="doc-biblioref">DiMaggio and Powell 1983</a>)</span>.</li>
<li><strong>Prestige and Status-Seeking:</strong> Imitation is also a strategy to gain legitimacy. Organizations emulate those they perceive as more successful or prestigious, creating an inherent directional bias in diffusion <span class="citation" data-cites="strang_search_2001">(<a href="#ref-strang_search_2001" role="doc-biblioref">Strang and Macy 2001</a>)</span>.</li>
<li><strong>Proximity and Network Structure:</strong> Influence is channeled through social and structural networks. Actors are more influenced by their peers and direct competitors <span class="citation" data-cites="hedstrom_contagious_1994">(<a href="#ref-hedstrom_contagious_1994" role="doc-biblioref">Hedström 1994</a>)</span>.</li>
</ol>
</section>
<section id="a-unified-theoretical-model-the-role-of-theorization-and-transferability-τ" class="level4">
<h4 class="anchored" data-anchor-id="a-unified-theoretical-model-the-role-of-theorization-and-transferability-τ">1.2. A Unified Theoretical Model: The Role of Theorization and Transferability (τ)</h4>
<p>Our key theoretical innovation is that the <strong>content</strong> of a skill—how it is culturally <strong>theorized</strong> <span class="citation" data-cites="strang_institutional_1993">(<a href="#ref-strang_institutional_1993" role="doc-biblioref">Strang and Meyer 1993</a>)</span>—determines which of these micro-foundations becomes dominant. “Theorization” refers to the development of abstract categories that justify and give meaning to organizational practices.</p>
<p>We propose a more parsimonious and elegant model that does not rely on a strict dichotomy (cognitive/physical) but on a single continuous parameter: <strong>perceived Transferability (τ)</strong>, where τ ∈ [0, 1]. This parameter captures the degree to which a skill is theorized as a “portable asset” versus a “context-dependent competency.”</p>
<ul>
<li><p><strong>High Transferability (τ → 1):</strong> Skills theorized as <strong>portable assets</strong>. They are abstract, broadly applicable, and seen as signals of growth and adaptability. Their value is context-independent. Under uncertainty, organizations look to <strong>prestigious exemplars</strong>. Therefore, the diffusion of these skills is driven primarily by <strong>aspirational emulation</strong>, tending to flow “upward” in the status hierarchy.</p></li>
<li><p><strong>Low Transferability (τ → 0):</strong> Skills theorized as <strong>context-dependent competencies</strong>. They are tied to specific material settings and processes. Their value is difficult to transfer. Therefore, their diffusion is governed mainly by <strong>proximity and functional need</strong>, showing <strong>lateral containment</strong> within similar status segments.</p></li>
</ul>
<p>This logic, governed by the continuous parameter τ, is what we call <strong>Asymmetric Trajectory Channeling</strong>. The following ABM is designed to be a direct generative test of this unified theory.</p>
</section>
</section>
<section id="abm-architecture-from-theory-to-a-generative-model" class="level3">
<h3 class="anchored" data-anchor-id="abm-architecture-from-theory-to-a-generative-model">2. ABM Architecture: From Theory to a Generative Model</h3>
<p>Our ABM translates the core theoretical argument into agent-level decision processes. The model is designed to be a direct and parsimonious representation of the transferability theory, allowing us to test its generative power.</p>
<section id="initialization-of-agents-and-skills" class="level4">
<h4 class="anchored" data-anchor-id="initialization-of-agents-and-skills">2.1. Initialization of Agents and Skills</h4>
<ul>
<li><strong>Organizations (Agents):</strong> A population of N organizations is created, each with a <code>status</code> level drawn from a β distribution, reflecting a prestige hierarchy.</li>
<li><strong>Skills:</strong> A set of K skills is created. Instead of being categorical, each skill is assigned a <strong>transferability (τ)</strong> value drawn from a continuous β(2,2) distribution, creating a spectrum of skills from highly contextual (τ ≈ 0) to highly portable (τ ≈ 1).</li>
</ul>
</section>
<section id="the-core-imitation-mechanism" class="level4">
<h4 class="anchored" data-anchor-id="the-core-imitation-mechanism">2.2. The Core Imitation Mechanism</h4>
<p>The heart of the model is a single equation that determines the probability of a focal organization (f) imitating a skill from a target organization (t). This probability is a weighted mix of two pure logics, where the weight is the skill’s transferability (τ).</p>
<p>Let S_f be the status of the focal organization and S_t be the status of the target. The status gap is <span class="math inline">\(ΔS = S_t - S_f\)</span>.</p>
<ol type="1">
<li><p><strong>Aspirational Imitation Probability (P_asp):</strong> Increases as the target’s status surpasses the focal’s. <span class="math inline">\(P_{asp}(ΔS) = α_{asp} + β_{asp} · ΔS\)</span></p></li>
<li><p><strong>Proximity Imitation Probability (P_prox):</strong> Is maximized when status is similar (ΔS ≈ 0). <span class="math inline">\(P_{prox}(ΔS) = α_{prox} - β_{prox} · |ΔS|\)</span></p></li>
</ol>
<p>The final imitation probability for a skill with transferability τ is the direct implementation of our theory:</p>
<p><span class="math display">\[P_{imit}(ΔS, τ) = τ · P_{asp}(ΔS) + (1 - τ) · P_{prox}(ΔS)\]</span></p>
</section>
<section id="simulation-flow" class="level4">
<h4 class="anchored" data-anchor-id="simulation-flow">2.3. Simulation Flow</h4>
<p>The model iterates over time. In each step:</p>
<ol type="1">
<li><strong>Uncertainty:</strong> Each organization identifies a subset of skills it does not possess as “uncertain” and candidates for adoption.</li>
<li><strong>Search for Referents:</strong> For each uncertain skill, the organization searches for a limited number of other organizations that already possess that skill.</li>
<li><strong>Imitation Decision:</strong> The organization evaluates each referent and decides whether to imitate based on the probability calculated by the <code>calculate_imitation_prob</code> function.</li>
<li><strong>Adoption:</strong> If the decision is positive, the skill is added to the organization’s portfolio, and a diffusion event is recorded.</li>
</ol>
<p>This design allows the macroscopic patterns of asymmetric channeling to <strong>emerge</strong> from the micro-level interactions of the agents, without being pre-programmed.</p>
</section>
</section>
<section id="enhanced-model-implementation-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="enhanced-model-implementation-and-analysis">3. Enhanced Model Implementation and Analysis</h3>
<p>The following chunk contains the complete enhanced R code with advanced analytics, temporal dynamics tracking, and expanded validation frameworks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I. LOAD LIBRARIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(data.table)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(igraph)      <span class="co"># For network analysis</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggraph)      <span class="co"># For network visualization</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gganimate)   <span class="co"># For animations</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(viridis)     <span class="co"># For color palettes</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(scales)      <span class="co"># For scaling functions</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># II. CORE PARAMETERS AND CONFIGURATION</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>DEFAULT_PARAMS <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_ORGS =</span> <span class="dv">200</span>,          <span class="co"># Number of organizations (agents)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_SKILLS =</span> <span class="dv">30</span>,         <span class="co"># Number of skills</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_ITERATIONS =</span> <span class="dv">100</span>,    <span class="co"># Number of time steps in the simulation</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">BASE_UNCERTAINTY =</span> <span class="fl">0.15</span>, <span class="co"># Probability an org feels uncertain about a missing skill</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">BASE_IMITATION =</span> <span class="fl">0.6</span>,  <span class="co"># Probability an org will attempt to imitate for an uncertain skill</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">ASP_INTERCEPT =</span> <span class="fl">0.5</span>,   <span class="co"># Base probability for aspirational imitation</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ASP_SLOPE =</span> <span class="fl">0.8</span>,       <span class="co"># Effect of status gap on aspirational imitation</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">PROX_INTERCEPT =</span> <span class="fl">0.6</span>,  <span class="co"># Base probability for proximity imitation</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">PROX_SLOPE =</span> <span class="fl">1.0</span>,      <span class="co"># Effect of status gap on proximity imitation</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAX_TARGETS =</span> <span class="dv">5</span>        <span class="co"># Maximum number of referents to consider</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># III. CORE MODEL FUNCTIONS (AGENTS &amp; MECHANISMS)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#' Initialize the set of skills with varying transferability</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>initialize_skills <span class="ot">&lt;-</span> <span class="cf">function</span>(params) {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">skill_id =</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_SKILLS,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">transferability =</span> <span class="fu">rbeta</span>(params<span class="sc">$</span>N_SKILLS, <span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#' Create the population of organizations and their initial skill portfolios</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>create_organizations <span class="ot">&lt;-</span> <span class="cf">function</span>(skills_df, params) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  orgs_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">org_id =</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">rbeta</span>(params<span class="sc">$</span>N_ORGS, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  orgs_df<span class="sc">$</span>status <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fl">0.05</span>, <span class="fu">pmin</span>(<span class="fl">0.95</span>, orgs_df<span class="sc">$</span>status))</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create initial skill portfolios</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  portfolio_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (org_idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS) {</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    org_id_current <span class="ot">&lt;-</span> orgs_df<span class="sc">$</span>org_id[org_idx]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    org_status_current <span class="ot">&lt;-</span> orgs_df<span class="sc">$</span>status[org_idx]</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    n_skills_for_org <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">rpois</span>(<span class="dv">1</span>, <span class="dv">6</span>) <span class="sc">+</span> <span class="dv">2</span>, params<span class="sc">$</span>N_SKILLS)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    skill_probs <span class="ot">&lt;-</span> skills_df<span class="sc">$</span>transferability <span class="sc">*</span> org_status_current <span class="sc">+</span> </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">-</span> skills_df<span class="sc">$</span>transferability) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> org_status_current)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    selected_skills <span class="ot">&lt;-</span> <span class="fu">sample</span>(skills_df<span class="sc">$</span>skill_id, <span class="at">size =</span> n_skills_for_org, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                            <span class="at">prob =</span> skill_probs, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(selected_skills) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>      portfolio_list[[org_idx]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">org_id =</span> org_id_current, </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">skill_id =</span> selected_skills, </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">iteration_acquired =</span> <span class="dv">0</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  portfolio_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, portfolio_list)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">organizations =</span> orgs_df, <span class="at">portfolio =</span> portfolio_df))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co">#' Calculate the probability of imitation based on the core theoretical model</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>calculate_imitation_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(focal_status, target_status, skill_transferability, </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                                   params, <span class="at">model_type =</span> <span class="st">"theoretical"</span>) {</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  status_gap <span class="ot">&lt;-</span> target_status <span class="sc">-</span> focal_status</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">"null"</span>) <span class="fu">return</span>(<span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>))</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  aspirational_weight <span class="ot">&lt;-</span> <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">"reversed"</span>) <span class="dv">1</span> <span class="sc">-</span> skill_transferability <span class="cf">else</span> skill_transferability</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  proximity_weight <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> aspirational_weight</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  prob_aspirational <span class="ot">&lt;-</span> params<span class="sc">$</span>ASP_INTERCEPT <span class="sc">+</span> params<span class="sc">$</span>ASP_SLOPE <span class="sc">*</span> status_gap</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  prob_proximity <span class="ot">&lt;-</span> params<span class="sc">$</span>PROX_INTERCEPT <span class="sc">-</span> params<span class="sc">$</span>PROX_SLOPE <span class="sc">*</span> <span class="fu">abs</span>(status_gap)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  final_prob <span class="ot">&lt;-</span> (aspirational_weight <span class="sc">*</span> prob_aspirational) <span class="sc">+</span> (proximity_weight <span class="sc">*</span> prob_proximity)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">pmax</span>(<span class="fl">0.05</span>, <span class="fu">pmin</span>(<span class="fl">0.95</span>, final_prob)))</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co">#' Find potential target organizations that have a specific skill</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>find_targets <span class="ot">&lt;-</span> <span class="cf">function</span>(focal_org_id, skill_id, orgs_df, portfolio_df, params) {</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  orgs_with_skill_mask <span class="ot">&lt;-</span> portfolio_df<span class="sc">$</span>skill_id <span class="sc">==</span> skill_id <span class="sc">&amp;</span> portfolio_df<span class="sc">$</span>org_id <span class="sc">!=</span> focal_org_id</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  orgs_with_skill <span class="ot">&lt;-</span> <span class="fu">unique</span>(portfolio_df<span class="sc">$</span>org_id[orgs_with_skill_mask])</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(orgs_with_skill) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">data.frame</span>())</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  targets <span class="ot">&lt;-</span> orgs_df[orgs_df<span class="sc">$</span>org_id <span class="sc">%in%</span> orgs_with_skill, ]</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  n_targets <span class="ot">&lt;-</span> <span class="fu">min</span>(params<span class="sc">$</span>MAX_TARGETS, <span class="fu">nrow</span>(targets))</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_targets <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> n_targets <span class="sc">&lt;</span> <span class="fu">nrow</span>(targets)) {</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    targets <span class="ot">&lt;-</span> targets[<span class="fu">sample</span>(<span class="fu">nrow</span>(targets), n_targets), ]</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(targets)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="co"># IV. ANALYSIS FUNCTIONS</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="co">#' Calculate Gini coefficient for inequality measurement</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>calculate_gini <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  gini <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((<span class="dv">1</span><span class="sc">:</span>n) <span class="sc">*</span> x)) <span class="sc">/</span> (n <span class="sc">*</span> <span class="fu">sum</span>(x)) <span class="sc">-</span> (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gini)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="co">#' Calculate dissimilarity index for skill segregation</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>calculate_dissimilarity_index <span class="ot">&lt;-</span> <span class="cf">function</span>(events_data) {</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(events_data) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use target_status if available, otherwise use source_status as proxy</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  status_col <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="st">"target_status"</span> <span class="sc">%in%</span> <span class="fu">names</span>(events_data)) <span class="st">"target_status"</span> <span class="cf">else</span> <span class="st">"source_status"</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>status_col <span class="sc">%in%</span> <span class="fu">names</span>(events_data)) {</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>) <span class="co"># Cannot calculate without status information</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  high_tau <span class="ot">&lt;-</span> events_data<span class="sc">$</span>transferability <span class="sc">&gt;</span> <span class="fu">median</span>(events_data<span class="sc">$</span>transferability)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  high_status <span class="ot">&lt;-</span> events_data[[status_col]] <span class="sc">&gt;</span> <span class="fu">median</span>(events_data[[status_col]])</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  total_high_tau <span class="ot">&lt;-</span> <span class="fu">sum</span>(high_tau)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  total_low_tau <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>high_tau)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (total_high_tau <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> total_low_tau <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  high_tau_in_high_status <span class="ot">&lt;-</span> <span class="fu">sum</span>(high_tau <span class="sc">&amp;</span> high_status)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  low_tau_in_high_status <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>high_tau <span class="sc">&amp;</span> high_status)</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  dissimilarity <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">abs</span>(high_tau_in_high_status<span class="sc">/</span>total_high_tau <span class="sc">-</span> </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>                            low_tau_in_high_status<span class="sc">/</span>total_low_tau)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dissimilarity)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="co">#' Analyze emergent patterns from simulation results</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>analyze_emergent_patterns <span class="ot">&lt;-</span> <span class="cf">function</span>(events_data, orgs_df) {</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(events_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">segregation =</span> <span class="dv">0</span>,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">speed =</span> <span class="fu">data.frame</span>(),</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>      <span class="at">concentration =</span> <span class="fu">data.frame</span>()</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add target status information if target_status column doesn't exist</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"target_status"</span> <span class="sc">%in%</span> <span class="fu">names</span>(events_data)) {</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    events_data <span class="ot">&lt;-</span> events_data <span class="sc">%&gt;%</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(orgs_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(org_id, <span class="at">target_status =</span> status), </span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"target_org_id"</span> <span class="ot">=</span> <span class="st">"org_id"</span>))</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Segregation index</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  segregation_index <span class="ot">&lt;-</span> <span class="fu">calculate_dissimilarity_index</span>(events_data)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Diffusion speed by transferability quartile</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>  diffusion_speed <span class="ot">&lt;-</span> events_data <span class="sc">%&gt;%</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">transferability_quartile =</span> <span class="fu">ntile</span>(transferability, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(transferability_quartile) <span class="sc">%&gt;%</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_adoption_iteration =</span> <span class="fu">mean</span>(iteration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Changed from iteration_acquired to iteration</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_adoptions =</span> <span class="fu">n</span>(),</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Concentration of adoptions by status level</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  concentration_curve <span class="ot">&lt;-</span> events_data <span class="sc">%&gt;%</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(target_status)) <span class="sc">%&gt;%</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>      <span class="at">cumulative_adoptions =</span> <span class="fu">row_number</span>() <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">cumulative_status_weight =</span> <span class="fu">cumsum</span>(target_status) <span class="sc">/</span> <span class="fu">sum</span>(target_status, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">segregation =</span> segregation_index,</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">speed =</span> diffusion_speed,</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">concentration =</span> concentration_curve</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="co">#' Track inequality evolution over time</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>track_inequality_evolution <span class="ot">&lt;-</span> <span class="cf">function</span>(portfolio_df, orgs_df, max_iteration) {</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>  inequality_evolution <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">10</span>, max_iteration, <span class="at">by =</span> <span class="dv">10</span>)) {</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate skill counts up to this iteration</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    skill_counts <span class="ot">&lt;-</span> portfolio_df <span class="sc">%&gt;%</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(iteration_acquired <span class="sc">&lt;=</span> iter) <span class="sc">%&gt;%</span>  <span class="co"># This is correct - portfolio_df uses iteration_acquired</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(org_id, <span class="at">name =</span> <span class="st">"n_skills"</span>)</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge with status</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    inequality_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(skill_counts, orgs_df[<span class="fu">c</span>(<span class="st">"org_id"</span>, <span class="st">"status"</span>)], <span class="at">by =</span> <span class="st">"org_id"</span>)</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(inequality_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>      status_skill_correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(inequality_data<span class="sc">$</span>status, inequality_data<span class="sc">$</span>n_skills)</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>      gini_skills <span class="ot">&lt;-</span> <span class="fu">calculate_gini</span>(skill_counts<span class="sc">$</span>n_skills)</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>      inequality_evolution <span class="ot">&lt;-</span> <span class="fu">rbind</span>(inequality_evolution, <span class="fu">data.frame</span>(</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>        <span class="at">iteration =</span> iter,</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>        <span class="at">inequality_measure =</span> status_skill_correlation,</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>        <span class="at">gini_skills =</span> gini_skills</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(inequality_evolution)</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a><span class="co"># V. SIMULATION ENGINE</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation with detailed tracking</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>run_enhanced_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">params =</span> DEFAULT_PARAMS, <span class="at">model_type =</span> <span class="st">"theoretical"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🚀 STARTING ENHANCED SIMULATION (Model: "</span>, <span class="fu">toupper</span>(model_type), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialization</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  skills_df <span class="ot">&lt;-</span> <span class="fu">initialize_skills</span>(params)</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  org_system <span class="ot">&lt;-</span> <span class="fu">create_organizations</span>(skills_df, params)</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>  orgs_df <span class="ot">&lt;-</span> org_system<span class="sc">$</span>organizations</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>  portfolio_df <span class="ot">&lt;-</span> org_system<span class="sc">$</span>portfolio</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>  events_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>  imitation_network <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main Loop</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iteration <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ITERATIONS) {</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (org_idx <span class="cf">in</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS)) {</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>      current_org_id <span class="ot">&lt;-</span> orgs_df<span class="sc">$</span>org_id[org_idx]</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>      current_org_status <span class="ot">&lt;-</span> orgs_df<span class="sc">$</span>status[org_idx]</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>      current_skills <span class="ot">&lt;-</span> portfolio_df<span class="sc">$</span>skill_id[portfolio_df<span class="sc">$</span>org_id <span class="sc">==</span> current_org_id]</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>      missing_skills <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(skills_df<span class="sc">$</span>skill_id, current_skills)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(missing_skills) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>      uncertain_skills <span class="ot">&lt;-</span> missing_skills[<span class="fu">rbinom</span>(<span class="fu">length</span>(missing_skills), <span class="dv">1</span>, params<span class="sc">$</span>BASE_UNCERTAINTY) <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (skill_id_to_consider <span class="cf">in</span> uncertain_skills) {</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> params<span class="sc">$</span>BASE_IMITATION) <span class="cf">next</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>        targets_df <span class="ot">&lt;-</span> <span class="fu">find_targets</span>(current_org_id, skill_id_to_consider, orgs_df, portfolio_df, params)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">nrow</span>(targets_df) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (target_idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(targets_df)) {</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>          target_org <span class="ot">&lt;-</span> targets_df[target_idx, ]</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>          skill_transferability <span class="ot">&lt;-</span> skills_df<span class="sc">$</span>transferability[skills_df<span class="sc">$</span>skill_id <span class="sc">==</span> skill_id_to_consider]</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>          imitation_prob <span class="ot">&lt;-</span> <span class="fu">calculate_imitation_prob</span>(current_org_status, target_org<span class="sc">$</span>status, </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>                                                   skill_transferability, params, model_type)</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> imitation_prob) {</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adopt the skill</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>            portfolio_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(portfolio_df, <span class="fu">data.frame</span>(</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>              <span class="at">org_id =</span> current_org_id, </span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>              <span class="at">skill_id =</span> skill_id_to_consider, </span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>              <span class="at">iteration_acquired =</span> iteration</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Record detailed event</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>            events_list[[<span class="fu">length</span>(events_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>              <span class="at">model_type =</span> model_type,</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>              <span class="at">iteration =</span> iteration,</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>              <span class="at">source_org_id =</span> target_org<span class="sc">$</span>org_id,</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>              <span class="at">target_org_id =</span> current_org_id,</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>              <span class="at">skill_id =</span> skill_id_to_consider,</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>              <span class="at">transferability =</span> skill_transferability,</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>              <span class="at">status_gap =</span> target_org<span class="sc">$</span>status <span class="sc">-</span> current_org_status,</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>              <span class="at">source_status =</span> target_org<span class="sc">$</span>status,</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>              <span class="at">target_status =</span> current_org_status</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Record network edge</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>            imitation_network <span class="ot">&lt;-</span> <span class="fu">rbind</span>(imitation_network, <span class="fu">data.frame</span>(</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>              <span class="at">from =</span> target_org<span class="sc">$</span>org_id,</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>              <span class="at">to =</span> current_org_id,</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>              <span class="at">iteration =</span> iteration,</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>              <span class="at">skill_transferability =</span> skill_transferability</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  events_df <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(events_list) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">do.call</span>(rbind, events_list) <span class="cf">else</span> <span class="fu">data.frame</span>()</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">events =</span> events_df,</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_portfolio =</span> portfolio_df,</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">organizations =</span> orgs_df,</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">skills =</span> skills_df,</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">network =</span> imitation_network</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="co"># VI. POLICY EXPERIMENTS</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="co">#' Run policy intervention experiments</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>run_policy_experiments <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">base_params =</span> DEFAULT_PARAMS) {</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>  experiments <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Baseline</span></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🧪 Running Baseline Experiment...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>  experiments<span class="sc">$</span>baseline <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(base_params, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Experiment 1: Network Density (this one actually changes params before simulation)</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🧪 Running Network Density Experiment...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>  network_params <span class="ot">&lt;-</span> base_params</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>  network_params<span class="sc">$</span>MAX_TARGETS <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>  experiments<span class="sc">$</span>network_density <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(network_params, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For other experiments, we simulate the effects post-hoc for simplicity</span></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Experiment 2: Skill Recategorization (simulated effect)</span></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🧪 Running Skill Recategorization Experiment...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>  recategorization_results <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(base_params, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(recategorization_results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate the effect of recategorizing low-tau skills</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>    modified_events <span class="ot">&lt;-</span> recategorization_results<span class="sc">$</span>events</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>    low_tau_mask <span class="ot">&lt;-</span> modified_events<span class="sc">$</span>transferability <span class="sc">&lt;</span> <span class="fl">0.3</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>    modified_events<span class="sc">$</span>transferability[low_tau_mask] <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fl">0.95</span>, modified_events<span class="sc">$</span>transferability[low_tau_mask] <span class="sc">+</span> <span class="fl">0.4</span>)</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>    recategorization_results<span class="sc">$</span>events <span class="ot">&lt;-</span> modified_events</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>  experiments<span class="sc">$</span>recategorization <span class="ot">&lt;-</span> recategorization_results</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Experiment 3: Status Compression (simulated effect)</span></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🧪 Running Status Compression Experiment...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>  compression_results <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(base_params, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(compression_results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate compressed status distribution</span></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>    compression_results<span class="sc">$</span>events<span class="sc">$</span>source_status <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">rescale</span>(compression_results<span class="sc">$</span>events<span class="sc">$</span>source_status, <span class="at">to =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>))</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>    compression_results<span class="sc">$</span>events<span class="sc">$</span>target_status <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">rescale</span>(compression_results<span class="sc">$</span>events<span class="sc">$</span>target_status, <span class="at">to =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>))</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>    compression_results<span class="sc">$</span>events<span class="sc">$</span>status_gap <span class="ot">&lt;-</span> compression_results<span class="sc">$</span>events<span class="sc">$</span>source_status <span class="sc">-</span> compression_results<span class="sc">$</span>events<span class="sc">$</span>target_status</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>  experiments<span class="sc">$</span>status_compression <span class="ot">&lt;-</span> compression_results</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(experiments)</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a><span class="co"># VII. VALIDATION AGAINST EMPIRICAL FINDINGS</span></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="co">#' Validate ABM results against empirical coefficients</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>validate_against_empirical_findings <span class="ot">&lt;-</span> <span class="cf">function</span>(abm_results, <span class="at">empirical_coefficients =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(abm_results<span class="sc">$</span>events) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>      <span class="at">abm_asymmetry =</span> <span class="cn">NA</span>,</span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>      <span class="at">empirical_asymmetry =</span> <span class="cn">NA</span>,</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>      <span class="at">equivalence =</span> <span class="cn">FALSE</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate ABM coefficients</span></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>  upward_events <span class="ot">&lt;-</span> <span class="fu">filter</span>(abm_results<span class="sc">$</span>events, status_gap <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>  downward_events <span class="ot">&lt;-</span> <span class="fu">filter</span>(abm_results<span class="sc">$</span>events, status_gap <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(upward_events) <span class="sc">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>    abm_beta_plus <span class="ot">&lt;-</span> <span class="fu">lm</span>(status_gap <span class="sc">~</span> transferability, <span class="at">data =</span> upward_events)<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>    abm_beta_plus <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(downward_events) <span class="sc">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>    abm_beta_minus <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">abs</span>(status_gap) <span class="sc">~</span> transferability, <span class="at">data =</span> downward_events)<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>    abm_beta_minus <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Default empirical coefficients if not provided</span></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(empirical_coefficients)) {</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>    empirical_coefficients <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta_plus =</span> <span class="fl">0.444</span>, <span class="at">beta_minus =</span> <span class="sc">-</span><span class="fl">0.258</span>)</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test equivalence</span></span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>  abm_asymmetry <span class="ot">&lt;-</span> abm_beta_plus <span class="sc">-</span> abm_beta_minus</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>  empirical_asymmetry <span class="ot">&lt;-</span> empirical_coefficients<span class="sc">$</span>beta_plus <span class="sc">-</span> empirical_coefficients<span class="sc">$</span>beta_minus</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>  equivalence_test <span class="ot">&lt;-</span> <span class="fu">abs</span>(abm_asymmetry <span class="sc">-</span> empirical_asymmetry) <span class="sc">&lt;</span> <span class="fl">0.2</span></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">abm_beta_plus =</span> abm_beta_plus,</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>    <span class="at">abm_beta_minus =</span> abm_beta_minus,</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>    <span class="at">abm_asymmetry =</span> abm_asymmetry,</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>    <span class="at">empirical_asymmetry =</span> empirical_asymmetry,</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">equivalence =</span> equivalence_test</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a><span class="co"># VIII. ORIGINAL VALIDATION FUNCTIONS (MAINTAINED)</span></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>run_sensitivity_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_runs =</span> <span class="dv">20</span>) {</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>  sensitivity_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>  param_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">ASP_SLOPE =</span> <span class="fu">runif</span>(n_runs, <span class="fl">0.5</span>, <span class="fl">1.2</span>),</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">PROX_SLOPE =</span> <span class="fu">runif</span>(n_runs, <span class="fl">0.8</span>, <span class="fl">1.5</span>),</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">BASE_IMITATION =</span> <span class="fu">runif</span>(n_runs, <span class="fl">0.4</span>, <span class="fl">0.8</span>)</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">📊 STARTING SENSITIVITY ANALYSIS</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_runs) {</span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"  - Run"</span>, i, <span class="st">"of"</span>, n_runs, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>    current_params <span class="ot">&lt;-</span> DEFAULT_PARAMS</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>    current_params<span class="sc">$</span>ASP_SLOPE <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>ASP_SLOPE[i]</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>    current_params<span class="sc">$</span>PROX_SLOPE <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>PROX_SLOPE[i]</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    current_params<span class="sc">$</span>BASE_IMITATION <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>BASE_IMITATION[i]</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(<span class="at">params =</span> current_params, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>      sensitivity_results[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>        <span class="at">run =</span> i, </span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>        <span class="at">correlation =</span> <span class="fu">cor</span>(results<span class="sc">$</span>events<span class="sc">$</span>transferability, results<span class="sc">$</span>events<span class="sc">$</span>status_gap)</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">do.call</span>(rbind, sensitivity_results))</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>run_model_comparison <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_reps =</span> <span class="dv">5</span>) {</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>  model_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"theoretical"</span>, <span class="st">"null"</span>, <span class="st">"reversed"</span>)</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>  comparison_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">🔄 STARTING COUNTERFACTUAL COMPARISON</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model <span class="cf">in</span> model_types) {</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_reps) {</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"  - Running"</span>, model, <span class="st">"model, rep"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>(<span class="at">model_type =</span> model, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a>        comparison_results[[<span class="fu">length</span>(comparison_results) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>          <span class="at">model_type =</span> model, </span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>          <span class="at">replication =</span> i,</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>          <span class="at">correlation =</span> <span class="fu">cor</span>(results<span class="sc">$</span>events<span class="sc">$</span>transferability, results<span class="sc">$</span>events<span class="sc">$</span>status_gap)</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">do.call</span>(rbind, comparison_results))</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a><span class="co"># IX. EXECUTION</span></span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------------------------------------</span></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Run main simulation</span></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"🎯 RUNNING MAIN SIMULATION</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>🎯 RUNNING MAIN SIMULATION</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>main_results <span class="ot">&lt;-</span> <span class="fu">run_enhanced_simulation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
🚀 STARTING ENHANCED SIMULATION (Model: THEORETICAL)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">📊 ANALYZING MAIN RESULTS</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
📊 ANALYZING MAIN RESULTS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate emergent patterns</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(main_results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  emergent_patterns <span class="ot">&lt;-</span> <span class="fu">analyze_emergent_patterns</span>(main_results<span class="sc">$</span>events, main_results<span class="sc">$</span>organizations)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  emergent_patterns <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">segregation =</span> <span class="dv">0</span>, <span class="at">speed =</span> <span class="fu">data.frame</span>(), <span class="at">concentration =</span> <span class="fu">data.frame</span>())</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Track inequality evolution</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(main_results<span class="sc">$</span>final_portfolio) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  inequality_evolution <span class="ot">&lt;-</span> <span class="fu">track_inequality_evolution</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    main_results<span class="sc">$</span>final_portfolio, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    main_results<span class="sc">$</span>organizations, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    DEFAULT_PARAMS<span class="sc">$</span>N_ITERATIONS</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  inequality_evolution <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate against empirical findings</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>validation_results <span class="ot">&lt;-</span> <span class="fu">validate_against_empirical_findings</span>(main_results)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(validation_results<span class="sc">$</span>abm_asymmetry)) {</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  validation_results<span class="sc">$</span>abm_asymmetry <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  validation_results<span class="sc">$</span>equivalence <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print immediate results summary</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(main_results<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  main_correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(main_results<span class="sc">$</span>events<span class="sc">$</span>transferability, main_results<span class="sc">$</span>events<span class="sc">$</span>status_gap)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✅ MAIN SIMULATION RESULTS:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   - Total events generated:"</span>, <span class="fu">nrow</span>(main_results<span class="sc">$</span>events), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   - Transferability-Status Gap correlation:"</span>, <span class="fu">round</span>(main_correlation, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   - Segregation Index:"</span>, <span class="fu">round</span>(emergent_patterns<span class="sc">$</span>segregation, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(inequality_evolution) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    final_inequality <span class="ot">&lt;-</span> <span class="fu">tail</span>(inequality_evolution<span class="sc">$</span>inequality_measure, <span class="dv">1</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"   - Final Inequality Level:"</span>, <span class="fu">round</span>(final_inequality, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   - ABM Asymmetry:"</span>, <span class="fu">round</span>(validation_results<span class="sc">$</span>abm_asymmetry, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"⚠️  WARNING: No events generated in main simulation</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ MAIN SIMULATION RESULTS:
   - Total events generated: 4441 
   - Transferability-Status Gap correlation: 0.103 
   - Segregation Index: 0.018 
   - Final Inequality Level: NA 
   - ABM Asymmetry: 0.065 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run validation analyses</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sensitivity_data <span class="ot">&lt;-</span> <span class="fu">run_sensitivity_analysis</span>(<span class="at">n_runs =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
📊 STARTING SENSITIVITY ANALYSIS
  - Run 1 of 15 
  - Run 2 of 15 
  - Run 3 of 15 
  - Run 4 of 15 
  - Run 5 of 15 
  - Run 6 of 15 
  - Run 7 of 15 
  - Run 8 of 15 
  - Run 9 of 15 
  - Run 10 of 15 
  - Run 11 of 15 
  - Run 12 of 15 
  - Run 13 of 15 
  - Run 14 of 15 
  - Run 15 of 15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">run_model_comparison</span>(<span class="at">n_reps =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
🔄 STARTING COUNTERFACTUAL COMPARISON
  - Running theoretical model, rep 1 
  - Running theoretical model, rep 2 
  - Running theoretical model, rep 3 
  - Running null model, rep 1 
  - Running null model, rep 2 
  - Running null model, rep 3 
  - Running reversed model, rep 1 
  - Running reversed model, rep 2 
  - Running reversed model, rep 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run policy experiments</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>policy_results <span class="ot">&lt;-</span> <span class="fu">run_policy_experiments</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
🧪 Running Baseline Experiment...

🧪 Running Network Density Experiment...

🧪 Running Skill Recategorization Experiment...

🧪 Running Status Compression Experiment...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">✅ ALL ANALYSES COMPLETED</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
✅ ALL ANALYSES COMPLETED</code></pre>
</div>
</div>
</section>
<section id="enhanced-results-comprehensive-generative-validation" class="level3">
<h3 class="anchored" data-anchor-id="enhanced-results-comprehensive-generative-validation">4. Enhanced Results: Comprehensive Generative Validation</h3>
<p>Our enhanced validation framework provides a multi-dimensional assessment of the model’s performance, including emergent pattern analysis, temporal dynamics, and policy experiments.</p>
<section id="core-mechanism-validation" class="level4">
<h4 class="anchored" data-anchor-id="core-mechanism-validation">4.1. Core Mechanism Validation</h4>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/main_enhanced_plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Enhanced Main Results: Transferability vs.&nbsp;Status Gap with emergent pattern indicators."><img src="01_abm_skill_diffusion_files/figure-html/main_enhanced_plot-1.png" class="img-fluid figure-img" width="1152" alt="Enhanced Main Results: Transferability vs.&nbsp;Status Gap with emergent pattern indicators."></a></p>
<figcaption>Enhanced Main Results: Transferability vs.&nbsp;Status Gap with emergent pattern indicators.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sensitivity-analysis-with-metrics" class="level4">
<h4 class="anchored" data-anchor-id="sensitivity-analysis-with-metrics">4.2. Sensitivity Analysis with Metrics</h4>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/enhanced_sensitivity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Enhanced Sensitivity Analysis with distributional statistics."><img src="01_abm_skill_diffusion_files/figure-html/enhanced_sensitivity-1.png" class="img-fluid figure-img" width="960" alt="Enhanced Sensitivity Analysis with distributional statistics."></a></p>
<figcaption>Enhanced Sensitivity Analysis with distributional statistics.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="policy-experiments-results" class="level4">
<h4 class="anchored" data-anchor-id="policy-experiments-results">4.3. Policy Experiments Results</h4>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/policy_experiments_plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Policy Intervention Effects on Asymmetric Channeling."><img src="01_abm_skill_diffusion_files/figure-html/policy_experiments_plot-1.png" class="img-fluid figure-img" width="1152" alt="Policy Intervention Effects on Asymmetric Channeling."></a></p>
<figcaption>Policy Intervention Effects on Asymmetric Channeling.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-comparison-with-counterfactuals" class="level4">
<h4 class="anchored" data-anchor-id="model-comparison-with-counterfactuals">4.4. Model Comparison with Counterfactuals</h4>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/enhanced_comparison-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Enhanced Counterfactual Model Comparison with confidence intervals."><img src="01_abm_skill_diffusion_files/figure-html/enhanced_comparison-1.png" class="img-fluid figure-img" width="960" alt="Enhanced Counterfactual Model Comparison with confidence intervals."></a></p>
<figcaption>Enhanced Counterfactual Model Comparison with confidence intervals.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="discussion-and-validation-summary" class="level3">
<h3 class="anchored" data-anchor-id="discussion-and-validation-summary">5. Discussion and Validation Summary</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ============================================================ </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>COMPREHENSIVE VALIDATION SUMMARY</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>============================================================ </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ SUFFICIENCY: Main correlation = 0.103 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ ROBUSTNESS: 100 % of runs show positive correlation</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ NECESSITY: Theoretical mean = 0.12 | Null mean = 0.045 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
📊 EMERGENT PATTERNS:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   - Segregation Index: 0.018 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   - Final Inequality Level: NA </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
🧬 EMPIRICAL VALIDATION:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   - ABM Asymmetry: 0.065 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   - Empirical Equivalence: FALSE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ============================================================ </code></pre>
</div>
</div>
<p>This Agent-Based Model provides comprehensive generative validation through multiple analytical dimensions. The parsimonious mechanism based on transferability (τ) not only reproduces the core asymmetric channeling pattern but also generates realistic emergent properties including skill segregation, inequality evolution, and policy intervention responses. The model serves as a powerful tool for understanding how micro-level cultural theorization processes create and maintain macro-level stratification patterns in labor markets.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-alabdulkareem_unpacking_2018" class="csl-entry" role="listitem">
Alabdulkareem, Ahmad, Morgan R. Frank, Lijun Sun, Bedoor AlShebli, César Hidalgo, and Iyad Rahwan. 2018. <span>“Unpacking the Polarization of Workplace Skills.”</span> <em>Science Advances</em> 4 (7): eaao6030. <a href="https://doi.org/10.1126/sciadv.aao6030">https://doi.org/10.1126/sciadv.aao6030</a>.
</div>
<div id="ref-cyert_behavioral_2006" class="csl-entry" role="listitem">
Cyert, Richard Michael, Richard Michael Cyert, and James G. March. 2006. <em>A Behavioral Theory of the Firm</em>. 2. ed., [Nachdr.]. Malden, <span>MA</span>: Blackwell Publishing.
</div>
<div id="ref-dimaggio_iron_1983" class="csl-entry" role="listitem">
DiMaggio, Paul, and Walter Powell. 1983. <span>“The Iron Cage Revisited: Institutional Isomorphism and Collective Rationality in Organizational Fields.”</span> <em>American Sociological Review</em> 48 (2): 147–60. <a href="https://doi.org/10.2307/2095101">https://doi.org/10.2307/2095101</a>.
</div>
<div id="ref-hedstrom_contagious_1994" class="csl-entry" role="listitem">
Hedström, Peter. 1994. <span>“Contagious Collectivities: On the Spatial Diffusion of Swedish Trade Unions, 1890-1940.”</span> <em>American Journal of Sociology</em> 99 (5): 1157–79. <a href="https://doi.org/10.1086/230408">https://doi.org/10.1086/230408</a>.
</div>
<div id="ref-hosseinioun_skill_2025" class="csl-entry" role="listitem">
Hosseinioun, Moh, Frank Neffke, Letian Zhang, and Hyejin Youn. 2025. <span>“Skill Dependencies Uncover Nested Human Capital.”</span> <em>Nature Human Behaviour</em>, February. <a href="https://doi.org/10.1038/s41562-024-02093-2">https://doi.org/10.1038/s41562-024-02093-2</a>.
</div>
<div id="ref-kalleberg_good_2013" class="csl-entry" role="listitem">
Kalleberg, Arne L. 2013. <em>Good Jobs, Bad Jobs: The Rise of Polarized and Precarious Employment Systems in the United States, 1970s to 2000s</em>. 1. papercover ed. American Sociological Association’s Rose Series in Sociology. New York, <span>NY</span>: Russel Sage Foundation.
</div>
<div id="ref-strang_search_2001" class="csl-entry" role="listitem">
Strang, David, and Michael W. Macy. 2001. <span>“In Search of Excellence: Fads, Success Stories, and Adaptive Emulation.”</span> <em>American Journal of Sociology</em> 107 (1): 147–82. <a href="https://doi.org/10.1086/323039">https://doi.org/10.1086/323039</a>.
</div>
<div id="ref-strang_institutional_1993" class="csl-entry" role="listitem">
Strang, David, and John W. Meyer. 1993. <span>“Institutional Conditions for Diffusion.”</span> <em>Theory and Society</em> 22 (4): 487–511. <a href="https://doi.org/10.1007/BF00993595">https://doi.org/10.1007/BF00993595</a>.
</div>
<div id="ref-tilly_durable_2009" class="csl-entry" role="listitem">
Tilly, Charles. 2009. <em>Durable Inequality</em>. Nachdr. Berkeley: Univ. of California Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/rcantillan\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 Roberto Cantillan ∙ Made with <a href="https://quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p><a class="link-dark me-1" href="../../../accessibility.html" title="Accessibility commitment" target="_blank" rel="noopener"><i class="fa-solid fa-universal-access" aria-label="universal-access"></i></a> <a class="link-dark me-1" href="" title="Substack" target="_blank" rel="noopener"><i class="bi-substack " style="" role="img" aria-hidden="true"></i></a> <a class="link-dark me-1" href="https://github.com/rcantillan" title="github" target="_blank" rel="noopener"><i class="fa-brands fa-github" aria-label="github"></i></a> <a class="link-dark me-1" href="https://cl.linkedin.com/in/roberto-cantillan-carrasco-67620517b" title="LinkedIn" target="_blank" rel="noopener"><i class="fa-brands fa-linkedin" aria-label="linkedin"></i></a> <a class="link-dark me-1" href="https://orcid.org/0000-0003-0494-0692;" title="orcid" target="_blank" rel="noopener"><i class="ai  ai-orcid" style="color:black"></i></a> <a class="link-dark me-1" href="https://scholar.google.com/citations?user=xZkAmvAAAAAJ&amp;hl=es" title="Google Scholar" target="_blank" rel="noopener"><i class="ai  ai-google-scholar" style="color:black"></i></a></p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../accessibility.qmd">
<p>Accessibility</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../contact.qmd">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../license.qmd">
<p>License</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog/index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roberto Cantillan &amp; Mauricio Bucca">
<meta name="dcterms.date" content="2025-07-28">

<title>Agent-Based Model: Asymmetric Trajectory Channeling in Labor Markets – Roberto Cantillan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-9519443a8c50f3421c15abbdb1fc3938.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-32e64e11d264661c9dda202d8f199470.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/bootstrap-icons-1.9.1/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: rgba(0, 0, 0, 0.8);
      }

      .quarto-title-block .quarto-title-banner {
        color: rgba(0, 0, 0, 0.8);
background-image: url(featured.jpg);
background-size: cover;
      }
</style>
<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg border-bottom" data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/noun-small-world-network-6148828.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Roberto Cantillan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../talk/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../publication/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../project/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resources/index.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rcantillan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Agent-Based Model: Asymmetric Trajectory Channeling in Labor Markets</h1>
            <p class="subtitle lead">A Comprehensive Validation with Skills-Based Organizational Typology, Sensitivity Analysis, and Model Comparison</p>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Agent-Based Modeling</div>
                <div class="quarto-category">Diffusion Theory</div>
                <div class="quarto-category">Stratification</div>
                <div class="quarto-category">Inequality</div>
                <div class="quarto-category">Labor Markets</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Roberto Cantillan &amp; Mauricio Bucca </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Sociology, PUC
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 28, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">in this page</h2>
   
  <ul>
  <li><a href="#theoretical-framework-from-employer-decisions-to-labor-market-structure" id="toc-theoretical-framework-from-employer-decisions-to-labor-market-structure" class="nav-link active" data-scroll-target="#theoretical-framework-from-employer-decisions-to-labor-market-structure">Theoretical Framework: From Employer Decisions to Labor Market Structure</a>
  <ul class="collapse">
  <li><a href="#the-micro-foundations-of-organizational-imitation" id="toc-the-micro-foundations-of-organizational-imitation" class="nav-link" data-scroll-target="#the-micro-foundations-of-organizational-imitation">The Micro-Foundations of Organizational Imitation</a></li>
  <li><a href="#dual-process-theory-of-skill-diffusion-the-role-of-theorization" id="toc-dual-process-theory-of-skill-diffusion-the-role-of-theorization" class="nav-link" data-scroll-target="#dual-process-theory-of-skill-diffusion-the-role-of-theorization">Dual-Process Theory of Skill Diffusion: The Role of Theorization</a></li>
  <li><a href="#model-architecture-skills-based-organizational-heterogeneity" id="toc-model-architecture-skills-based-organizational-heterogeneity" class="nav-link" data-scroll-target="#model-architecture-skills-based-organizational-heterogeneity">Model Architecture: Skills-Based Organizational Heterogeneity</a>
  <ul class="collapse">
  <li><a href="#skills-based-vs-jobs-based-organizational-typology" id="toc-skills-based-vs-jobs-based-organizational-typology" class="nav-link" data-scroll-target="#skills-based-vs-jobs-based-organizational-typology"><strong>Skills-Based vs Jobs-Based Organizational Typology:</strong></a></li>
  <li><a href="#model-features" id="toc-model-features" class="nav-link" data-scroll-target="#model-features"><strong>Model Features:</strong></a></li>
  </ul></li>
  <li><a href="#from-structure-to-process-an-enhanced-abm-for-causal-inference" id="toc-from-structure-to-process-an-enhanced-abm-for-causal-inference" class="nav-link" data-scroll-target="#from-structure-to-process-an-enhanced-abm-for-causal-inference">From Structure to Process: An Enhanced ABM for Causal Inference</a></li>
  </ul></li>
  <li><a href="#agent-based-model-implementation" id="toc-agent-based-model-implementation" class="nav-link" data-scroll-target="#agent-based-model-implementation">Agent-Based Model Implementation</a>
  <ul class="collapse">
  <li><a href="#setup-and-libraries" id="toc-setup-and-libraries" class="nav-link" data-scroll-target="#setup-and-libraries">Setup and Libraries</a></li>
  <li><a href="#parameter-system" id="toc-parameter-system" class="nav-link" data-scroll-target="#parameter-system">Parameter System</a></li>
  <li><a href="#agent-architecture-skills-based-organizations" id="toc-agent-architecture-skills-based-organizations" class="nav-link" data-scroll-target="#agent-architecture-skills-based-organizations">Agent Architecture: Skills-Based Organizations</a></li>
  <li><a href="#reference-groups-and-decision-mechanisms" id="toc-reference-groups-and-decision-mechanisms" class="nav-link" data-scroll-target="#reference-groups-and-decision-mechanisms">Reference Groups and Decision Mechanisms</a></li>
  <li><a href="#simulation-engine-with-model-variants" id="toc-simulation-engine-with-model-variants" class="nav-link" data-scroll-target="#simulation-engine-with-model-variants">Simulation Engine with Model Variants</a></li>
  <li><a href="#analysis-functions" id="toc-analysis-functions" class="nav-link" data-scroll-target="#analysis-functions">Analysis Functions</a></li>
  </ul></li>
  <li><a href="#comprehensive-simulation-execution-and-analysis" id="toc-comprehensive-simulation-execution-and-analysis" class="nav-link" data-scroll-target="#comprehensive-simulation-execution-and-analysis">Comprehensive Simulation Execution and Analysis</a>
  <ul class="collapse">
  <li><a href="#main-simulation-skills-based-theoretical-model" id="toc-main-simulation-skills-based-theoretical-model" class="nav-link" data-scroll-target="#main-simulation-skills-based-theoretical-model">Main Simulation: Skills-Based Theoretical Model</a></li>
  <li><a href="#core-results-cultural-theorization-validation" id="toc-core-results-cultural-theorization-validation" class="nav-link" data-scroll-target="#core-results-cultural-theorization-validation">Core Results: Cultural Theorization Validation</a></li>
  <li><a href="#visualizations-core-theoretical-validation" id="toc-visualizations-core-theoretical-validation" class="nav-link" data-scroll-target="#visualizations-core-theoretical-validation">Visualizations: Core Theoretical Validation</a>
  <ul class="collapse">
  <li><a href="#plot-1-core-channeling-patterns---theorization-validation" id="toc-plot-1-core-channeling-patterns---theorization-validation" class="nav-link" data-scroll-target="#plot-1-core-channeling-patterns---theorization-validation">Plot 1: Core Channeling Patterns - Theorization Validation</a></li>
  <li><a href="#plot-2-aspirational-hunger-by-status" id="toc-plot-2-aspirational-hunger-by-status" class="nav-link" data-scroll-target="#plot-2-aspirational-hunger-by-status">Plot 2: Aspirational Hunger by Status</a></li>
  <li><a href="#plot-3-asymmetry-coefficients---mechanism-quantification" id="toc-plot-3-asymmetry-coefficients---mechanism-quantification" class="nav-link" data-scroll-target="#plot-3-asymmetry-coefficients---mechanism-quantification">Plot 3: Asymmetry Coefficients - Mechanism Quantification</a></li>
  <li><a href="#plot-4-temporal-dynamics---system-evolution" id="toc-plot-4-temporal-dynamics---system-evolution" class="nav-link" data-scroll-target="#plot-4-temporal-dynamics---system-evolution">Plot 4: Temporal Dynamics - System Evolution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comprehensive-sensitivity-analysis" id="toc-comprehensive-sensitivity-analysis" class="nav-link" data-scroll-target="#comprehensive-sensitivity-analysis">Comprehensive Sensitivity Analysis</a>
  <ul class="collapse">
  <li><a href="#sensitivity-analysis-parameter-robustness-testing" id="toc-sensitivity-analysis-parameter-robustness-testing" class="nav-link" data-scroll-target="#sensitivity-analysis-parameter-robustness-testing">Sensitivity Analysis: Parameter Robustness Testing</a>
  <ul class="collapse">
  <li><a href="#sensitivity-analysis-visualization" id="toc-sensitivity-analysis-visualization" class="nav-link" data-scroll-target="#sensitivity-analysis-visualization">Sensitivity Analysis Visualization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comprehensive-model-comparison-mechanism-necessity" id="toc-comprehensive-model-comparison-mechanism-necessity" class="nav-link" data-scroll-target="#comprehensive-model-comparison-mechanism-necessity">Comprehensive Model Comparison: Mechanism Necessity</a>
  <ul class="collapse">
  <li><a href="#model-comparison-visualization" id="toc-model-comparison-visualization" class="nav-link" data-scroll-target="#model-comparison-visualization">Model Comparison Visualization</a></li>
  </ul></li>
  <li><a href="#robustness-analysis-across-multiple-seeds" id="toc-robustness-analysis-across-multiple-seeds" class="nav-link" data-scroll-target="#robustness-analysis-across-multiple-seeds">Robustness Analysis Across Multiple Seeds</a>
  <ul class="collapse">
  <li><a href="#robustness-visualization" id="toc-robustness-visualization" class="nav-link" data-scroll-target="#robustness-visualization">Robustness Visualization</a></li>
  </ul></li>
  <li><a href="#discussion-cultural-theorization-as-core-mechanism" id="toc-discussion-cultural-theorization-as-core-mechanism" class="nav-link" data-scroll-target="#discussion-cultural-theorization-as-core-mechanism">Discussion: Cultural Theorization as Core Mechanism</a>
  <ul class="collapse">
  <li><a href="#parameter-robustness-confirmed" id="toc-parameter-robustness-confirmed" class="nav-link" data-scroll-target="#parameter-robustness-confirmed">1. <strong>Parameter Robustness Confirmed</strong></a></li>
  <li><a href="#mechanism-necessity-proven" id="toc-mechanism-necessity-proven" class="nav-link" data-scroll-target="#mechanism-necessity-proven">2. <strong>Mechanism Necessity Proven</strong></a></li>
  <li><a href="#skills-based-organizations-as-amplifiers" id="toc-skills-based-organizations-as-amplifiers" class="nav-link" data-scroll-target="#skills-based-organizations-as-amplifiers">3. <strong>Skills-Based Organizations as Amplifiers</strong></a></li>
  <li><a href="#stochastic-robustness" id="toc-stochastic-robustness" class="nav-link" data-scroll-target="#stochastic-robustness">4. <strong>Stochastic Robustness</strong></a></li>
  <li><a href="#causal-inference-strengthened" id="toc-causal-inference-strengthened" class="nav-link" data-scroll-target="#causal-inference-strengthened">5. <strong>Causal Inference Strengthened</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This Enhanced Agent-Based Model (ABM) provides a <strong>comprehensive generative validation</strong> of our theoretical framework on <strong>asymmetric trajectory channeling</strong> in labor markets. Through multiple robustness tests, sensitivity analysis, and model comparisons, we demonstrate that organizational imitation under uncertainty, filtered by the <strong>cultural theorization of skill types</strong> <span class="citation" data-cites="strang_institutional_1993">(<a href="#ref-strang_institutional_1993" role="doc-biblioref">Strang and Meyer 1993</a>)</span>, is <strong>generatively sufficient</strong> to produce empirically observed macro-level patterns of skills-based stratification. The enhanced model incorporates <strong>skills-based organizational heterogeneity</strong> reflecting contemporary workforce transformation, systematic parameter testing, and null model comparisons, revealing that <strong>aspirational hunger by low-status organizations</strong> drives cognitive skill channeling while <strong>structural constraints</strong> contain physical skill diffusion. This work strengthens the <strong>causal inference</strong> that cultural filtering through theorization is a necessary and robust mechanism driving stratification reproduction.</p>
<p><strong>Keywords:</strong> Agent-Based Modeling, Cultural Theorization, Causal Inference, Generative Sufficiency, Organizational Imitation, Skills-Based Stratification, Computational Social Science</p>
<section id="theoretical-framework-from-employer-decisions-to-labor-market-structure" class="level1">
<h1>Theoretical Framework: From Employer Decisions to Labor Market Structure</h1>
<p>The architecture of inequality in the U.S. labor market is not a static blueprint but an actively reproduced, dynamic process. Its foundations lie in the everyday decisions of <strong>employers within organizations</strong>, who determine which skill requirements to establish for the occupations they manage. Foundational studies have demonstrated that the skill landscape itself is starkly polarized into two distinct domains—a socio-cognitive cluster associated with high wages and a sensory-physical one with low wages <span class="citation" data-cites="alabdulkareem_unpacking_2018">(<a href="#ref-alabdulkareem_unpacking_2018" role="doc-biblioref">Alabdulkareem et al. 2018</a>)</span>—and that this space has a nested, hierarchical architecture <span class="citation" data-cites="hosseinioun_skill_2025">(<a href="#ref-hosseinioun_skill_2025" role="doc-biblioref">Hosseinioun et al. 2025</a>)</span>. This structural view aligns with recent findings in intergenerational mobility research, which conceptualize occupations not as monolithic categories but as complex bundles of gradational characteristics, where it is often the underlying traits, rather than the job title itself, that are transmitted across generations <span class="citation" data-cites="york_gradationalism_2025">(<a href="#ref-york_gradationalism_2025" role="doc-biblioref">York, Song, and Xie 2025</a>)</span>.</p>
<section id="the-micro-foundations-of-organizational-imitation" class="level2">
<h2 class="anchored" data-anchor-id="the-micro-foundations-of-organizational-imitation">The Micro-Foundations of Organizational Imitation</h2>
<p>Contemporary labor markets exhibit a fundamental paradox: unprecedented dynamism coexists with persistent occupational stratification <span class="citation" data-cites="kalleberg_good_2013 tilly_durable_2009">(<a href="#ref-kalleberg_good_2013" role="doc-biblioref">Kalleberg 2013</a>; <a href="#ref-tilly_durable_2009" role="doc-biblioref">Tilly 2009</a>)</span>. Early studies of diffusion often focused on the spread of a single innovation through a homogenous population. More recent work, however, recognizes that diffusion is fundamentally structured by networks and heterogeneity. Practices do not diffuse randomly or uniformly; they follow patterned trajectories shaped by organizational, cultural, and institutional constraints <span class="citation" data-cites="strang_diffusion_1998">(<a href="#ref-strang_diffusion_1998" role="doc-biblioref">Strang and Soule 1998</a>)</span>.</p>
<p>We extend this insight by arguing that <strong>employers imitate skill requirements according to fundamentally different logics depending on the type of skill in question</strong>. The literature suggests three key mechanisms that drive one organization to adopt the practices of another:</p>
<ol type="1">
<li><p><strong>Uncertainty and Bounded Rationality:</strong> Under conditions of uncertainty about the relationship between means and ends, organizations often imitate others as a decision-making shortcut. Rather than calculating an optimal solution from scratch, imitation offers a viable solution with reduced search costs <span class="citation" data-cites="cyert_behavioral_2006 dimaggio_iron_1983">(<a href="#ref-cyert_behavioral_2006" role="doc-biblioref">Cyert, Cyert, and March 2006</a>; <a href="#ref-dimaggio_iron_1983" role="doc-biblioref">DiMaggio and Powell 1983</a>)</span>.</p></li>
<li><p><strong>Prestige and Status-Seeking:</strong> Imitation is not just a response to uncertainty, but also a strategy to gain legitimacy and status. Organizations do not imitate just anyone; they emulate those they perceive to be more successful or prestigious <span class="citation" data-cites="strang_search_2001 bail_prestige_2019">(<a href="#ref-strang_search_2001" role="doc-biblioref">Strang and Macy 2001</a>; <a href="#ref-bail_prestige_2019" role="doc-biblioref">Bail, Brown, and Wimmer 2019</a>)</span>. This process of “adaptive emulation” <span class="citation" data-cites="strang_search_2001">(<a href="#ref-strang_search_2001" role="doc-biblioref">Strang and Macy 2001</a>)</span>, driven by “success stories,” creates an inherent directional bias in diffusion, where practices flow from high-status to low-status actors.</p></li>
<li><p><strong>Proximity and Network Structure:</strong> Influence is not global but is channeled through social and structural networks. The likelihood that one organization imitates another is strongly conditioned by proximity, whether geographic, social, or cultural <span class="citation" data-cites="hedstrom_contagious_1994 strang_spatial_1993">(<a href="#ref-hedstrom_contagious_1994" role="doc-biblioref">Hedström 1994</a>; <a href="#ref-strang_spatial_1993" role="doc-biblioref">Strang and Tuma 1993</a>)</span>. Actors are more influenced by their peers, direct competitors, or those with whom they maintain dense relationships.</p></li>
</ol>
</section>
<section id="dual-process-theory-of-skill-diffusion-the-role-of-theorization" class="level2">
<h2 class="anchored" data-anchor-id="dual-process-theory-of-skill-diffusion-the-role-of-theorization">Dual-Process Theory of Skill Diffusion: The Role of Theorization</h2>
<p>Our key theoretical innovation is that the <strong>content</strong> of a skill—how it is culturally <strong>theorized</strong> <span class="citation" data-cites="strang_institutional_1993">(<a href="#ref-strang_institutional_1993" role="doc-biblioref">Strang and Meyer 1993</a>)</span>—determines which of these micro-foundations becomes dominant. <strong>Theorization</strong> refers to the development and specification of abstract categories that justify and provide meaning to organizational practices. According to Strang &amp; Meyer (1993), theorization involves two key processes: (1) the definition of a general organizational problem, and (2) the justification of a formal structural arrangement as a solution to that problem.</p>
<p>We argue that organizations filter and evaluate potential practices through two qualitatively different diffusion logics based on how skills are <strong>theorized</strong>:</p>
<p><strong>Cognitive Skills as Portable Assets:</strong> Cognitive skills (analytical, interpersonal, managerial) are <strong>theorized</strong> as <strong>nested capabilities</strong>: they are abstract, broadly applicable, and perceived as portable assets associated with growth, learning, and adaptability. This theorization frames cognitive skills as generalizable solutions to organizational problems of innovation and competitiveness. Under uncertainty, employers look toward <strong>prestigious exemplars</strong> <span class="citation" data-cites="strang_learning_2010">(<a href="#ref-strang_learning_2010" role="doc-biblioref">Strang 2010</a>)</span> that signal success and modernity. As a result, the diffusion of cognitive skills is driven primarily by <strong>aspirational emulation</strong>. They tend to diffuse <strong>upward</strong> through the occupational status hierarchy as organizations seek to imitate their high-status peers.</p>
<p><strong>Physical Skills as Context-Dependent Competencies:</strong> In contrast, physical skills (manual, motor) are <strong>theorized</strong> as <strong>context-dependent competencies</strong>: they are tied to specific material settings, bodily execution, and legacy institutional constraints. This theorization frames physical skills as functionally specific solutions to particular operational problems. They are less likely to be read as generalizable templates for upward mobility. Instead, their diffusion is based on functional rather than aspirational considerations. Therefore, the diffusion of physical skills is governed mainly by <strong>proximity and functional need</strong>, showing less directional bias or even <strong>containment effects</strong> within their current status segments.</p>
<p>This bifurcation in diffusion logics based on <strong>cultural theorization</strong> is what we call <strong>Asymmetric Trajectory Channeling</strong>.</p>
</section>
<section id="model-architecture-skills-based-organizational-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="model-architecture-skills-based-organizational-heterogeneity">Model Architecture: Skills-Based Organizational Heterogeneity</h2>
<p>This enhanced version incorporates contemporary <strong>Skills-Based Organization (SBO) theory</strong> to provide rigorous theoretical grounding for organizational heterogeneity. Recent research by Deloitte (2022-2024) identifies a fundamental transformation in how organizations approach work and talent management.</p>
<section id="skills-based-vs-jobs-based-organizational-typology" class="level3">
<h3 class="anchored" data-anchor-id="skills-based-vs-jobs-based-organizational-typology"><strong>Skills-Based vs Jobs-Based Organizational Typology:</strong></h3>
<p><strong>Skills-Based Organizations (SBOs):</strong> Organizations that structure work around dynamic skill deployment rather than static job descriptions. These organizations:</p>
<ul>
<li>Make talent decisions based on demonstrated skills rather than job titles</li>
<li>Emphasize skill development and redeployment across functions</li>
<li>Adopt fluid, project-based work arrangements</li>
<li>Show higher agility and adaptation capabilities</li>
<li>Are 79% more likely to provide positive workforce experiences</li>
</ul>
<p><strong>Jobs-Based Organizations (JBOs):</strong> Traditional organizations that structure work around fixed job categories. These organizations:</p>
<ul>
<li>Make talent decisions based on job titles and formal qualifications</li>
<li>Emphasize role-specific competencies within departmental boundaries<br>
</li>
<li>Maintain rigid hierarchical structures</li>
<li>Show slower adaptation to changing skill demands</li>
<li>Focus on job-level performance metrics</li>
</ul>
<p><strong>Hybrid Organizations:</strong> Organizations experimenting with skills-based practices in some areas while maintaining jobs-based structures in others.</p>
</section>
<section id="model-features" class="level3">
<h3 class="anchored" data-anchor-id="model-features"><strong>Model Features:</strong></h3>
<ol type="1">
<li><p><strong>Theoretically-Grounded Organizational Types:</strong> Organizations are classified by their approach to skill management, providing direct relevance to skill diffusion processes.</p></li>
<li><p><strong>Systematic Robustness Testing:</strong> Comprehensive sensitivity analysis across parameter space and comparison against null, reversed, and random alternatives.</p></li>
<li><p><strong>Enhanced Reference Group Mechanisms:</strong> Type-specific reference group selection reflecting both <strong>theorization processes</strong> and organizational skill orientations.</p></li>
<li><p><strong>System-Level Validation:</strong> Multiple validation layers including temporal dynamics, parameter sensitivity, and mechanism necessity tests.</p></li>
</ol>
</section>
</section>
<section id="from-structure-to-process-an-enhanced-abm-for-causal-inference" class="level2">
<h2 class="anchored" data-anchor-id="from-structure-to-process-an-enhanced-abm-for-causal-inference">From Structure to Process: An Enhanced ABM for Causal Inference</h2>
<p>Our approach connects two modes of causal inquiry through multiple validation strategies. The structural form of our <strong>Piecewise Dual Process Model</strong> expresses the diffusion likelihood as:</p>
<p><span class="math display">\[\text{logit}\, P_{i \to j}^{(c)} = \theta_{0c} - \lambda_c d_{ij} - \beta_c^+ \Delta^+_{ij} - \beta_c^- \Delta^-_{ij} - \omega_c w_{ij}\]</span></p>
<p>Where <span class="math inline">\(\Delta^+_{ij} = \max(0, s_j - s_i)\)</span> and <span class="math inline">\(\Delta^-_{ij} = \max(0, s_i - s_j)\)</span> represent non-overlapping upward and downward status shifts.</p>
<p>Our enhanced ABM translates this structural equation into <strong>organizational-level decision processes</strong> with skills-based heterogeneity:</p>
<pre><code>Uncertainty → Skills-Based Response → Cultural Theorization → Asymmetric Channeling → Stratification</code></pre>
<p>Organizations facing skill uncertainty respond according to their skills-based orientation. <strong>Cultural theorization</strong> of skill types systematically biases this response, generating distinct diffusion trajectories that, when aggregated, reproduce the macro-level structure of stratification.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Enhanced Methodological Positioning">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Enhanced Methodological Positioning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This ABM provides:</p>
<ul>
<li><strong>Theoretical Rigor:</strong> Grounded in Strang’s theorization theory with contemporary skills-based organizational typology</li>
<li><strong>Mechanism Validation:</strong> Null model comparisons prove the necessity of cultural theorization</li>
<li><strong>Parameter Robustness:</strong> Systematic sensitivity analysis demonstrates stability across parameter choices</li>
<li><strong>Generative Sufficiency:</strong> Multiple model variants confirm that only theorization-based mechanisms produce the observed patterns</li>
</ul>
</div>
</div>
</section>
</section>
<section id="agent-based-model-implementation" class="level1">
<h1>Agent-Based Model Implementation</h1>
<section id="setup-and-libraries" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-libraries">Setup and Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(igraph)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(data.table)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gridExtra)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(knitr)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(scales)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(zoo)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced theme for professional plots with LARGE TEXT</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>theme_abm_professional <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">base_size =</span> <span class="dv">18</span>) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> base_size) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.3</span>), <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">12</span>), <span class="at">color =</span> <span class="st">"grey15"</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.0</span>), <span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>), <span class="at">lineheight =</span> <span class="fl">1.2</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>), <span class="at">color =</span> <span class="st">"grey15"</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">15</span>), <span class="at">color =</span> <span class="st">"grey15"</span>),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.95</span>), <span class="at">color =</span> <span class="st">"grey25"</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.95</span>), <span class="at">color =</span> <span class="st">"grey25"</span>),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.0</span>), <span class="at">color =</span> <span class="st">"grey15"</span>),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"grey25"</span>),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey92"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.0</span>), <span class="at">color =</span> <span class="st">"grey15"</span>),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey55"</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.8</span>)),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_abm_professional</span>())</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced color palette</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>skill_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cognitive"</span> <span class="ot">=</span> <span class="st">"#2E86C1"</span>, <span class="st">"physical"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>model_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"theoretical"</span> <span class="ot">=</span> <span class="st">"#27AE60"</span>, <span class="st">"strong_null"</span> <span class="ot">=</span> <span class="st">"#85929E"</span>, </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"proper_reversed"</span> <span class="ot">=</span> <span class="st">"#F39C12"</span>, <span class="st">"structural_control"</span> <span class="ot">=</span> <span class="st">"#9B59B6"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>org_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"skills_based"</span> <span class="ot">=</span> <span class="st">"#1ABC9C"</span>, <span class="st">"jobs_based"</span> <span class="ot">=</span> <span class="st">"#E67E22"</span>, <span class="st">"hybrid"</span> <span class="ot">=</span> <span class="st">"#9B59B6"</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parameter-system" class="level2">
<h2 class="anchored" data-anchor-id="parameter-system">Parameter System</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced parameter system with theoretical grounding</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>DEFAULT_PARAMS <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_ORGS =</span> <span class="dv">200</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_SKILLS =</span> <span class="dv">20</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_ITERATIONS =</span> <span class="dv">120</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">uncertainty_rate =</span> <span class="fl">0.15</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">imitation_rate =</span> <span class="fl">0.6</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cognitive_ratio =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cultural_strength =</span> <span class="fl">0.8</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">status_sensitivity =</span> <span class="fl">1.0</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">proximity_threshold =</span> <span class="fl">1.5</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">status_bonus_cognitive =</span> <span class="fl">0.2</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">proximity_penalty_physical =</span> <span class="fl">0.3</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Global parameters</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>PARAMS <span class="ot">&lt;-</span> DEFAULT_PARAMS</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>COGNITIVE_SKILLS <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>PHYSICAL_SKILLS <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to set simulation parameters</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>set_simulation_params <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">params =</span> DEFAULT_PARAMS) {</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  PARAMS <span class="ot">&lt;&lt;-</span> params</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  COGNITIVE_SKILLS <span class="ot">&lt;&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">floor</span>(params<span class="sc">$</span>N_SKILLS <span class="sc">*</span> params<span class="sc">$</span>cognitive_ratio)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  PHYSICAL_SKILLS <span class="ot">&lt;&lt;-</span> (<span class="fu">length</span>(COGNITIVE_SKILLS) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>params<span class="sc">$</span>N_SKILLS</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(PARAMS)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize with default parameters</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">set_simulation_params</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="agent-architecture-skills-based-organizations" class="level2">
<h2 class="anchored" data-anchor-id="agent-architecture-skills-based-organizations">Agent Architecture: Skills-Based Organizations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>create_skills_based_organization <span class="ot">&lt;-</span> <span class="cf">function</span>(id, <span class="at">org_type =</span> <span class="cn">NULL</span>) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Organizations classified by skills-based orientation (Deloitte 2022-2024)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(org_type)) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    org_type <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"skills_based"</span>, <span class="st">"jobs_based"</span>, <span class="st">"hybrid"</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>))  <span class="co"># Reflecting current adoption rates</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skills-based organization parameters based on Deloitte research</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  sbo_params <span class="ot">&lt;-</span> <span class="cf">switch</span>(org_type,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"skills_based"</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># High skill focus, agile, experience-driven</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">cultural_strength =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>),      <span class="co"># Strong cultural theorization</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">status_aspiration =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>),      <span class="co"># High aspiration for innovation</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">uncertainty_tolerance =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>),  <span class="co"># High tolerance (agile mindset)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">imitation_propensity =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>),   <span class="co"># High imitation (best practices)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">skill_focus =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>),            <span class="co"># High skill focus</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">adaptability =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>)            <span class="co"># High adaptability</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"jobs_based"</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Low skill focus, traditional, hierarchy-driven</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">cultural_strength =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>),      <span class="co"># Moderate cultural theorization</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">status_aspiration =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>),      <span class="co"># Moderate aspiration</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">uncertainty_tolerance =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>),  <span class="co"># Low tolerance (risk averse)</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">imitation_propensity =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>),   <span class="co"># Moderate imitation</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">skill_focus =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>),            <span class="co"># Low skill focus</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">adaptability =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>)            <span class="co"># Low adaptability</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hybrid"</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Medium skill focus, transitioning, mixed approaches</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">cultural_strength =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>),      <span class="co"># Moderate-high cultural theorization</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">status_aspiration =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>),      <span class="co"># Moderate-high aspiration</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">uncertainty_tolerance =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.7</span>),  <span class="co"># Moderate tolerance</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">imitation_propensity =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>),   <span class="co"># Moderate-high imitation</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">skill_focus =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>),            <span class="co"># Moderate skill focus</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">adaptability =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)            <span class="co"># Moderate adaptability</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Status generation by organizational type (based on performance research)</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  status_by_type <span class="ot">&lt;-</span> <span class="cf">switch</span>(org_type,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"skills_based"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>),    <span class="co"># Often higher performing</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"jobs_based"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.6</span>),     <span class="co"># Often lower performing</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hybrid"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.0</span>, <span class="fl">0.8</span>)           <span class="co"># Variable performance</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initial skill endowment by type</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  initial_skill_prob <span class="ot">&lt;-</span> <span class="cf">switch</span>(org_type,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"skills_based"</span> <span class="ot">=</span> <span class="fl">0.6</span>,     <span class="co"># Rich, diverse skill sets</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"jobs_based"</span> <span class="ot">=</span> <span class="fl">0.3</span>,       <span class="co"># Limited, role-specific skills</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hybrid"</span> <span class="ot">=</span> <span class="fl">0.45</span>           <span class="co"># Moderate skill diversity</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> id,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">org_type =</span> org_type,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> status_by_type,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">skills =</span> <span class="fu">rbinom</span>(PARAMS<span class="sc">$</span>N_SKILLS, <span class="dv">1</span>, initial_skill_prob),</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">uncertainty =</span> <span class="fu">rep</span>(<span class="dv">0</span>, PARAMS<span class="sc">$</span>N_SKILLS),</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">sbo_params =</span> sbo_params,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">adoption_history =</span> <span class="fu">list</span>(),</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">success_rate =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">cultural_theory =</span> <span class="fu">list</span>(</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">cognitive_portable =</span> sbo_params<span class="sc">$</span>cultural_strength,</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">physical_contextual =</span> sbo_params<span class="sc">$</span>cultural_strength</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Create skills-based population</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>create_skills_based_population <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  organizations <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>PARAMS<span class="sc">$</span>N_ORGS, create_skills_based_organization)</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  organizations <span class="ot">&lt;-</span> organizations[<span class="fu">order</span>(<span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status))]</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(organizations)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Create structural control organizations (neutralized heterogeneity)</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>create_STRUCTURAL_CONTROL_organization <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  uniform_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">cultural_strength =</span> <span class="fl">0.7</span>, <span class="at">status_aspiration =</span> <span class="fl">0.5</span>, <span class="at">uncertainty_tolerance =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">imitation_propensity =</span> <span class="fl">0.6</span>, <span class="at">skill_focus =</span> <span class="fl">0.5</span>, <span class="at">adaptability =</span> <span class="fl">0.5</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> id, <span class="at">org_type =</span> <span class="st">"neutral"</span>, <span class="at">status =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.0</span>, <span class="fl">0.3</span>),</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">skills =</span> <span class="fu">rbinom</span>(PARAMS<span class="sc">$</span>N_SKILLS, <span class="dv">1</span>, <span class="fl">0.4</span>), <span class="at">uncertainty =</span> <span class="fu">rep</span>(<span class="dv">0</span>, PARAMS<span class="sc">$</span>N_SKILLS),</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">sbo_params =</span> uniform_params,</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">cultural_theory =</span> <span class="fu">list</span>(<span class="at">cognitive_portable =</span> <span class="fl">0.7</span>, <span class="at">physical_contextual =</span> <span class="fl">0.7</span>)</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reference-groups-and-decision-mechanisms" class="level2">
<h2 class="anchored" data-anchor-id="reference-groups-and-decision-mechanisms">Reference Groups and Decision Mechanisms</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THEORETICAL MODEL: Skills-based reference groups</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>identify_reference_groups_skills_based <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_type, organizations) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  focal_org <span class="ot">&lt;-</span> organizations[[org_id]]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cognitive skills: Aspirational logic moderated by skills-based orientation</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (focal_org<span class="sc">$</span>org_type <span class="sc">==</span> <span class="st">"skills_based"</span>) {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      potential_refs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">map_chr</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>org_type) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"skills_based"</span>, <span class="st">"hybrid"</span>) <span class="sc">&amp;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status) <span class="sc">&gt;</span> <span class="fu">quantile</span>(<span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status), <span class="fl">0.4</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (focal_org<span class="sc">$</span>org_type <span class="sc">==</span> <span class="st">"hybrid"</span>) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      potential_refs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">map_chr</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>org_type) <span class="sc">==</span> <span class="st">"skills_based"</span> <span class="sc">|</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                             (<span class="fu">map_chr</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>org_type) <span class="sc">==</span> <span class="st">"hybrid"</span> <span class="sc">&amp;</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status) <span class="sc">&gt;</span> focal_org<span class="sc">$</span>status))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="co"># jobs_based</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      potential_refs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status) <span class="sc">&gt;</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    potential_refs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(potential_refs, org_id)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(potential_refs) <span class="sc">==</span> <span class="dv">0</span>) potential_refs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(organizations), org_id)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    ref_status <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations[potential_refs], <span class="sc">~</span> .x<span class="sc">$</span>status)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    focal_status <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>status</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    higher_status <span class="ot">&lt;-</span> potential_refs[ref_status <span class="sc">&gt;</span> focal_status]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(higher_status) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">sample</span>(potential_refs, <span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(potential_refs))))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(higher_status) <span class="sc">==</span> <span class="dv">1</span>) <span class="fu">return</span>(higher_status)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    status_distances <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations[higher_status], <span class="sc">~</span> .x<span class="sc">$</span>status <span class="sc">-</span> focal_status)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    skill_weights <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations[higher_status], <span class="cf">function</span>(org) {</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">switch</span>(org<span class="sc">$</span>org_type, <span class="st">"skills_based"</span> <span class="ot">=</span> <span class="fl">1.5</span>, <span class="st">"hybrid"</span> <span class="ot">=</span> <span class="fl">1.2</span>, <span class="st">"jobs_based"</span> <span class="ot">=</span> <span class="fl">1.0</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> status_distances<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> skill_weights</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> weights <span class="sc">/</span> <span class="fu">sum</span>(weights)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    n_to_sample <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">8</span>, <span class="fu">length</span>(higher_status))</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    reference_pool <span class="ot">&lt;-</span> <span class="fu">sample</span>(higher_status, n_to_sample, <span class="at">prob =</span> weights, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Physical skills: Proximity logic with functional considerations</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    focal_status <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>status; all_status <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    same_type_orgs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">map_chr</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>org_type) <span class="sc">==</span> focal_org<span class="sc">$</span>org_type)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    same_type_orgs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(same_type_orgs, org_id)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(same_type_orgs) <span class="sc">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>      within_proximity <span class="ot">&lt;-</span> same_type_orgs[<span class="fu">abs</span>(all_status[same_type_orgs] <span class="sc">-</span> focal_status) <span class="sc">&lt;=</span> PARAMS<span class="sc">$</span>proximity_threshold]</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>      within_proximity <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(all_status <span class="sc">-</span> focal_status) <span class="sc">&lt;=</span> PARAMS<span class="sc">$</span>proximity_threshold <span class="sc">&amp;</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(organizations) <span class="sc">!=</span> org_id)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(within_proximity) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>      status_distances <span class="ot">&lt;-</span> <span class="fu">abs</span>(all_status <span class="sc">-</span> focal_status); status_distances[org_id] <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>      within_proximity <span class="ot">&lt;-</span> <span class="fu">order</span>(status_distances)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(organizations)<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    reference_pool <span class="ot">&lt;-</span> within_proximity</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(reference_pool)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co"># STRONG NULL MODEL: Pure randomization</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>identify_reference_groups_STRONG_NULL <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_type, organizations) {</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  potential_refs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(organizations), org_id)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(potential_refs) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  n_to_sample <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">sample</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">1</span>), <span class="fu">length</span>(potential_refs))</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(potential_refs, n_to_sample, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co"># PROPER REVERSED MODEL: Flip theorization logic</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>identify_reference_groups_PROPER_REVERSED <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_type, organizations) {</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  reversed_skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>, <span class="st">"physical"</span>, <span class="st">"cognitive"</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_reference_groups_skills_based</span>(org_id, reversed_skill_type, organizations)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="co"># STRUCTURAL CONTROL MODEL: Reduced organizational heterogeneity</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>identify_reference_groups_STRUCTURAL_CONTROL <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_type, organizations) {</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  focal_org <span class="ot">&lt;-</span> organizations[[org_id]]</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) {</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    potential_refs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status) <span class="sc">&gt;</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    potential_refs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(potential_refs, org_id)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(potential_refs) <span class="sc">==</span> <span class="dv">0</span>) potential_refs <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(organizations), org_id)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(potential_refs) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    higher_status <span class="ot">&lt;-</span> potential_refs[<span class="fu">map_dbl</span>(organizations[potential_refs], <span class="sc">~</span> .x<span class="sc">$</span>status) <span class="sc">&gt;</span> focal_org<span class="sc">$</span>status]</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(higher_status) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">sample</span>(potential_refs, <span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(potential_refs))))</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(higher_status) <span class="sc">==</span> <span class="dv">1</span>) <span class="fu">return</span>(higher_status)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    status_distances <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations[higher_status], <span class="sc">~</span> .x<span class="sc">$</span>status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> status_distances<span class="sc">^</span><span class="fl">1.5</span>))  <span class="co"># Less steep than theoretical</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sample</span>(higher_status, <span class="fu">min</span>(<span class="dv">8</span>, <span class="fu">length</span>(higher_status)), <span class="at">prob =</span> weights, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    focal_status <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>status; all_status <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations, <span class="sc">~</span> .x<span class="sc">$</span>status)</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>    within_proximity <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(all_status <span class="sc">-</span> focal_status) <span class="sc">&lt;=</span> PARAMS<span class="sc">$</span>proximity_threshold <span class="sc">&amp;</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(organizations) <span class="sc">!=</span> org_id)</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(within_proximity) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>      status_distances <span class="ot">&lt;-</span> <span class="fu">abs</span>(all_status <span class="sc">-</span> focal_status); status_distances[org_id] <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>      within_proximity <span class="ot">&lt;-</span> <span class="fu">order</span>(status_distances)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(organizations) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(within_proximity)</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="co"># IMITATION DECISION FUNCTIONS</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>make_imitation_decision_skills_based <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_id, reference_orgs, organizations) {</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>  focal_org <span class="ot">&lt;-</span> organizations[[org_id]]; skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"cognitive"</span>, <span class="st">"physical"</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>  reference_usage <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>skills[skill_id])</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>  usage_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(reference_usage); mean_ref_status <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">map_dbl</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>status))</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) {</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>    base_probability <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>cultural_strength <span class="sc">*</span> PARAMS<span class="sc">$</span>cultural_strength <span class="sc">*</span> usage_rate</span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>    status_gap <span class="ot">&lt;-</span> mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    aspiration_bonus <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>status_aspiration <span class="sc">*</span> PARAMS<span class="sc">$</span>status_bonus_cognitive <span class="sc">*</span> <span class="fu">pmax</span>(<span class="dv">0</span>, status_gap)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    skill_focus_bonus <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>skill_focus <span class="sc">*</span> <span class="fl">0.15</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    imitation_prob <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">1</span>, base_probability <span class="sc">+</span> aspiration_bonus <span class="sc">+</span> skill_focus_bonus))</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>    base_probability <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>cultural_strength <span class="sc">*</span> PARAMS<span class="sc">$</span>cultural_strength <span class="sc">*</span> usage_rate</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>    status_distance <span class="ot">&lt;-</span> <span class="fu">abs</span>(mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>    proximity_penalty <span class="ot">&lt;-</span> PARAMS<span class="sc">$</span>proximity_penalty_physical <span class="sc">*</span> status_distance</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>    same_type_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">map_chr</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>org_type) <span class="sc">==</span> focal_org<span class="sc">$</span>org_type)</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>    functional_bonus <span class="ot">&lt;-</span> (same_type_count <span class="sc">/</span> <span class="fu">length</span>(reference_orgs)) <span class="sc">*</span> <span class="fl">0.15</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>    imitation_prob <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">1</span>, base_probability <span class="sc">-</span> proximity_penalty <span class="sc">+</span> functional_bonus))</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>  adopt <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, imitation_prob)</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>  decision_record <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">skill_id =</span> skill_id, <span class="at">skill_type =</span> skill_type, <span class="at">org_type =</span> focal_org<span class="sc">$</span>org_type,</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>                         <span class="at">adopted =</span> adopt, <span class="at">status_gap =</span> mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">adopt =</span> adopt, <span class="at">record =</span> decision_record))</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>make_imitation_decision_STRONG_NULL <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_id, reference_orgs, organizations) {</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>  focal_org <span class="ot">&lt;-</span> organizations[[org_id]]</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>  mean_ref_status <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">map_dbl</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>status))</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>  imitation_prob <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">1</span>, <span class="fl">0.3</span> <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)))  <span class="co"># Random baseline</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>  adopt <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, imitation_prob)</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>  decision_record <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">skill_id =</span> skill_id, <span class="at">skill_type =</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"cognitive"</span>, <span class="st">"physical"</span>),</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>                         <span class="at">adopted =</span> adopt, <span class="at">status_gap =</span> mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">adopt =</span> adopt, <span class="at">record =</span> decision_record))</span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>make_imitation_decision_PROPER_REVERSED <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_id, reference_orgs, organizations) {</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use flipped skill type logic but return correct skill_id</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>  reversed_skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"physical"</span>, <span class="st">"cognitive"</span>)</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>  temp_skill_id <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(reversed_skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>, COGNITIVE_SKILLS[<span class="dv">1</span>], PHYSICAL_SKILLS[<span class="dv">1</span>])</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">make_imitation_decision_skills_based</span>(org_id, temp_skill_id, reference_orgs, organizations)</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>record<span class="sc">$</span>skill_id <span class="ot">&lt;-</span> skill_id</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>record<span class="sc">$</span>skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"cognitive"</span>, <span class="st">"physical"</span>)</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>make_imitation_decision_STRUCTURAL_CONTROL <span class="ot">&lt;-</span> <span class="cf">function</span>(org_id, skill_id, reference_orgs, organizations) {</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>  focal_org <span class="ot">&lt;-</span> organizations[[org_id]]; skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"cognitive"</span>, <span class="st">"physical"</span>)</span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>  usage_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">map_dbl</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>skills[skill_id]))</span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>  mean_ref_status <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">map_dbl</span>(organizations[reference_orgs], <span class="sc">~</span> .x<span class="sc">$</span>status))</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>  base_probability <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>cultural_strength <span class="sc">*</span> PARAMS<span class="sc">$</span>cultural_strength <span class="sc">*</span> usage_rate</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) {</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>    status_gap <span class="ot">&lt;-</span> mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>    aspiration_bonus <span class="ot">&lt;-</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>status_aspiration <span class="sc">*</span> PARAMS<span class="sc">$</span>status_bonus_cognitive <span class="sc">*</span> <span class="fu">pmax</span>(<span class="dv">0</span>, status_gap)</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>    imitation_prob <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">1</span>, base_probability <span class="sc">+</span> aspiration_bonus))</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>    status_distance <span class="ot">&lt;-</span> <span class="fu">abs</span>(mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>    proximity_penalty <span class="ot">&lt;-</span> PARAMS<span class="sc">$</span>proximity_penalty_physical <span class="sc">*</span> status_distance</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>    imitation_prob <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">1</span>, base_probability <span class="sc">-</span> proximity_penalty))</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>  adopt <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, imitation_prob)</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>  decision_record <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">skill_id =</span> skill_id, <span class="at">skill_type =</span> skill_type, <span class="at">adopted =</span> adopt, </span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>                         <span class="at">status_gap =</span> mean_ref_status <span class="sc">-</span> focal_org<span class="sc">$</span>status)</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">adopt =</span> adopt, <span class="at">record =</span> decision_record))</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-engine-with-model-variants" class="level2">
<h2 class="anchored" data-anchor-id="simulation-engine-with-model-variants">Simulation Engine with Model Variants</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>run_skills_based_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">params =</span> PARAMS, <span class="at">model_type =</span> <span class="st">"theoretical"</span>) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_simulation_params</span>(params)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize organizations based on model type</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  organizations <span class="ot">&lt;-</span> <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">"structural_control"</span>) {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS, create_STRUCTURAL_CONTROL_organization)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_skills_based_population</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  diffusion_events <span class="ot">&lt;-</span> <span class="fu">list</span>(); iteration_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main simulation loop</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iteration <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ITERATIONS) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (iteration <span class="sc">%%</span> <span class="dv">30</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">cat</span>(<span class="st">"Iteration:"</span>, iteration, <span class="st">"...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. UNCERTAINTY GENERATION</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS) {</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      org_uncertainty_rate <span class="ot">&lt;-</span> params<span class="sc">$</span>uncertainty_rate <span class="sc">*</span> organizations[[i]]<span class="sc">$</span>sbo_params<span class="sc">$</span>uncertainty_tolerance</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      uncertain_skills <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rbinom</span>(params<span class="sc">$</span>N_SKILLS, <span class="dv">1</span>, org_uncertainty_rate) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      organizations[[i]]<span class="sc">$</span>uncertainty[uncertain_skills] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. IMITATION PROCESS</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    iteration_events_list <span class="ot">&lt;-</span> <span class="fu">list</span>(); cog_adoptions <span class="ot">&lt;-</span> <span class="dv">0</span>; phys_adoptions <span class="ot">&lt;-</span> <span class="dv">0</span>; cog_attempts <span class="ot">&lt;-</span> <span class="dv">0</span>; phys_attempts <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (org_id <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>params<span class="sc">$</span>N_ORGS) {</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>      focal_org <span class="ot">&lt;-</span> organizations[[org_id]]; uncertain_skills <span class="ot">&lt;-</span> <span class="fu">which</span>(focal_org<span class="sc">$</span>uncertainty <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(uncertain_skills) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        org_imitation_rate <span class="ot">&lt;-</span> params<span class="sc">$</span>imitation_rate <span class="sc">*</span> focal_org<span class="sc">$</span>sbo_params<span class="sc">$</span>imitation_propensity</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (skill_id <span class="cf">in</span> uncertain_skills) {</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, org_imitation_rate) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>            skill_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(skill_id <span class="sc">%in%</span> COGNITIVE_SKILLS, <span class="st">"cognitive"</span>, <span class="st">"physical"</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) cog_attempts <span class="ot">&lt;-</span> cog_attempts <span class="sc">+</span> <span class="dv">1</span> <span class="cf">else</span> phys_attempts <span class="ot">&lt;-</span> phys_attempts <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Model-specific logic</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>            decision_result <span class="ot">&lt;-</span> <span class="cf">switch</span>(model_type,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>              <span class="st">"theoretical"</span> <span class="ot">=</span> { ref_orgs <span class="ot">&lt;-</span> <span class="fu">identify_reference_groups_skills_based</span>(org_id, skill_type, organizations); <span class="fu">make_imitation_decision_skills_based</span>(org_id, skill_id, ref_orgs, organizations) },</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>              <span class="st">"strong_null"</span> <span class="ot">=</span> { ref_orgs <span class="ot">&lt;-</span> <span class="fu">identify_reference_groups_STRONG_NULL</span>(org_id, skill_type, organizations); <span class="fu">make_imitation_decision_STRONG_NULL</span>(org_id, skill_id, ref_orgs, organizations) },</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>              <span class="st">"proper_reversed"</span> <span class="ot">=</span> { ref_orgs <span class="ot">&lt;-</span> <span class="fu">identify_reference_groups_PROPER_REVERSED</span>(org_id, skill_type, organizations); <span class="fu">make_imitation_decision_PROPER_REVERSED</span>(org_id, skill_id, ref_orgs, organizations) },</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>              <span class="st">"structural_control"</span> <span class="ot">=</span> { ref_orgs <span class="ot">&lt;-</span> <span class="fu">identify_reference_groups_STRUCTURAL_CONTROL</span>(org_id, skill_type, organizations); <span class="fu">make_imitation_decision_STRUCTURAL_CONTROL</span>(org_id, skill_id, ref_orgs, organizations) }</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (decision_result<span class="sc">$</span>adopt <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>              organizations[[org_id]]<span class="sc">$</span>skills[skill_id] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>) cog_adoptions <span class="ot">&lt;-</span> cog_adoptions <span class="sc">+</span> <span class="dv">1</span> <span class="cf">else</span> phys_adoptions <span class="ot">&lt;-</span> phys_adoptions <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Record event</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(decision_result<span class="sc">$</span>record)) {</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>              event_record <span class="ot">&lt;-</span> decision_result<span class="sc">$</span>record</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>              iteration_events_list[[<span class="fu">length</span>(iteration_events_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">iteration =</span> iteration, <span class="at">org_id =</span> org_id, <span class="at">org_status =</span> focal_org<span class="sc">$</span>status,</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">skill_id =</span> event_record<span class="sc">$</span>skill_id, <span class="at">skill_type =</span> event_record<span class="sc">$</span>skill_type,</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">adopted =</span> event_record<span class="sc">$</span>adopted, <span class="at">status_gap =</span> event_record<span class="sc">$</span>status_gap</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>      organizations[[org_id]]<span class="sc">$</span>uncertainty <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, params<span class="sc">$</span>N_SKILLS)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. CALCULATE ITERATION METRICS</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    cog_adoption_rate <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(cog_attempts <span class="sc">&gt;</span> <span class="dv">0</span>, cog_adoptions <span class="sc">/</span> cog_attempts, <span class="dv">0</span>)</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    phys_adoption_rate <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(phys_attempts <span class="sc">&gt;</span> <span class="dv">0</span>, phys_adoptions <span class="sc">/</span> phys_attempts, <span class="dv">0</span>)</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    iteration_metrics <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iteration_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">iteration =</span> iteration, <span class="at">cog_adoption_rate =</span> cog_adoption_rate, <span class="at">phys_adoption_rate =</span> phys_adoption_rate,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">asymmetry_diff =</span> cog_adoption_rate <span class="sc">-</span> phys_adoption_rate, <span class="at">model_type =</span> model_type</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(iteration_events_list) <span class="sc">&gt;</span> <span class="dv">0</span>) diffusion_events[[iteration]] <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(iteration_events_list)</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  all_events <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(diffusion_events) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">bind_rows</span>(diffusion_events) <span class="cf">else</span> <span class="fu">data.frame</span>()</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">diffusion_events =</span> all_events, <span class="at">iteration_metrics =</span> iteration_metrics, <span class="at">final_organizations =</span> organizations, <span class="at">parameters =</span> params))</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for Gini coefficient</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>calculate_gini <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]; n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x); index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(index <span class="sc">*</span> x)) <span class="sc">/</span> (n <span class="sc">*</span> <span class="fu">sum</span>(x)) <span class="sc">-</span> (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n)</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analysis-functions" class="level2">
<h2 class="anchored" data-anchor-id="analysis-functions">Analysis Functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>analyze_skills_based_patterns <span class="ot">&lt;-</span> <span class="cf">function</span>(results) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  events_df <span class="ot">&lt;-</span> results<span class="sc">$</span>diffusion_events</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(events_df) <span class="sc">||</span> <span class="fu">nrow</span>(events_df) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">channeling_analysis =</span> <span class="fu">data.frame</span>(), <span class="at">status_patterns =</span> <span class="fu">data.frame</span>(), <span class="at">asymmetry_coefficients =</span> <span class="fu">data.frame</span>(), <span class="at">org_patterns =</span> <span class="fu">data.frame</span>()))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic channeling analysis - core theoretical validation</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  channeling_analysis <span class="ot">&lt;-</span> events_df <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">status_direction =</span> <span class="fu">case_when</span>(status_gap <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Upward"</span>, status_gap <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Downward"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Lateral"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(skill_type, status_direction) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">adoption_rate =</span> <span class="fu">mean</span>(adopted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n_events =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Status quintile patterns - aspirational hunger</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  status_patterns <span class="ot">&lt;-</span> events_df <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">status_quintile =</span> <span class="fu">ntile</span>(org_status, <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(skill_type, status_quintile) <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">adoption_rate =</span> <span class="fu">mean</span>(adopted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n_events =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enhanced asymmetry coefficients - mechanism quantification</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  asymmetry_coef <span class="ot">&lt;-</span> events_df <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">delta_plus =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, status_gap), <span class="at">delta_minus =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="sc">-</span>status_gap)) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(skill_type) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_plus =</span> <span class="fu">cor</span>(delta_plus, adopted, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_minus =</span> <span class="sc">-</span><span class="fu">cor</span>(delta_minus, adopted, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">asymmetry =</span> beta_plus <span class="sc">-</span> beta_minus,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_adoption =</span> <span class="fu">mean</span>(adopted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">channeling_analysis =</span> channeling_analysis, <span class="at">status_patterns =</span> status_patterns, <span class="at">asymmetry_coefficients =</span> asymmetry_coef))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="comprehensive-simulation-execution-and-analysis" class="level1">
<h1>Comprehensive Simulation Execution and Analysis</h1>
<section id="main-simulation-skills-based-theoretical-model" class="level2">
<h2 class="anchored" data-anchor-id="main-simulation-skills-based-theoretical-model">Main Simulation: Skills-Based Theoretical Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute the skills-based theoretical model</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Running Skills-Based Theoretical Model...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running Skills-Based Theoretical Model...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>main_results <span class="ot">&lt;-</span> <span class="fu">run_skills_based_simulation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>main_analysis <span class="ot">&lt;-</span> <span class="fu">analyze_skills_based_patterns</span>(main_results)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Simulation completed successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Events recorded:"</span>, <span class="fu">nrow</span>(main_results<span class="sc">$</span>diffusion_events), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Events recorded: 15285 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Iterations completed:"</span>, <span class="fu">max</span>(main_results<span class="sc">$</span>iteration_metrics<span class="sc">$</span>iteration), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterations completed: 120 </code></pre>
</div>
</div>
</section>
<section id="core-results-cultural-theorization-validation" class="level2">
<h2 class="anchored" data-anchor-id="core-results-cultural-theorization-validation">Core Results: Cultural Theorization Validation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced results with skills-based organizational grounding</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== SKILLS-BASED ABM RESULTS: THEORIZATION VALIDATION ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== SKILLS-BASED ABM RESULTS: THEORIZATION VALIDATION ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1: Core Channeling Patterns - Theoretical Validation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(main_analysis<span class="sc">$</span>channeling_analysis,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"**Core Validation: Asymmetric Channeling by Status Direction**"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Skill Type"</span>, <span class="st">"Status Direction"</span>, <span class="st">"Adoption Rate"</span>, <span class="st">"N Events"</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">which</span>(main_analysis<span class="sc">$</span>channeling_analysis<span class="sc">$</span>status_direction <span class="sc">==</span> <span class="st">"Upward"</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">background =</span> <span class="st">"#E8F4FD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Cultural Theorization Effects"</span> <span class="ot">=</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Core Validation: Asymmetric Channeling by Status Direction**</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cultural Theorization Effects
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th">Skill Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Status Direction</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adoption Rate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N Events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cognitive</td>
<td style="text-align: left;">Downward</td>
<td style="text-align: right;">0.617</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">cognitive</td>
<td style="text-align: left;">Lateral</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">4776</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(232, 244, 253, 255) !important;">cognitive</td>
<td style="text-align: left; background-color: rgba(232, 244, 253, 255) !important;">Upward</td>
<td style="text-align: right; background-color: rgba(232, 244, 253, 255) !important;">0.683</td>
<td style="text-align: right; background-color: rgba(232, 244, 253, 255) !important;">2845</td>
</tr>
<tr class="even">
<td style="text-align: left;">physical</td>
<td style="text-align: left;">Downward</td>
<td style="text-align: right;">0.326</td>
<td style="text-align: right;">1292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">physical</td>
<td style="text-align: left;">Lateral</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">4994</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(232, 244, 253, 255) !important;">physical</td>
<td style="text-align: left; background-color: rgba(232, 244, 253, 255) !important;">Upward</td>
<td style="text-align: right; background-color: rgba(232, 244, 253, 255) !important;">0.348</td>
<td style="text-align: right; background-color: rgba(232, 244, 253, 255) !important;">1318</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2: Asymmetry Coefficients - Mechanism Quantification</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(main_analysis<span class="sc">$</span>asymmetry_coefficients,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"**Mechanism Validation: Cultural Theorization Effects**"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Skill Type"</span>, <span class="st">"β⁺ (Upward)"</span>, <span class="st">"β⁻ (Downward)"</span>, <span class="st">"Asymmetry"</span>, <span class="st">"Mean Adoption"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#FFF2E8"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Theorization Mechanism"</span> <span class="ot">=</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Mechanism Validation: Cultural Theorization Effects**</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: right; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Theorization Mechanism
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th">Skill Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β⁺ (Upward)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β⁻ (Downward)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Asymmetry</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Adoption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cognitive</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.0107</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(255, 242, 232, 255) !important;">0.0533</td>
<td style="text-align: right;">0.6723</td>
</tr>
<tr class="even">
<td style="text-align: left;">physical</td>
<td style="text-align: right;">-0.097</td>
<td style="text-align: right;">0.1231</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(255, 242, 232, 255) !important;">-0.2201</td>
<td style="text-align: right;">0.4917</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizations-core-theoretical-validation" class="level2">
<h2 class="anchored" data-anchor-id="visualizations-core-theoretical-validation">Visualizations: Core Theoretical Validation</h2>
<section id="plot-1-core-channeling-patterns---theorization-validation" class="level3">
<h3 class="anchored" data-anchor-id="plot-1-core-channeling-patterns---theorization-validation">Plot 1: Core Channeling Patterns - Theorization Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p1_skills_based <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_analysis<span class="sc">$</span>channeling_analysis,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> status_direction, <span class="at">y =</span> adoption_rate, <span class="at">fill =</span> skill_type)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(adoption_rate, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.7</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.7</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">color =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> skill_colors, <span class="at">name =</span> <span class="st">"Skill Type:"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cultural Theorization: Asymmetric Trajectory Channeling"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Cognitive skills theorized as portable assets; physical skills as context-dependent"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Direction of Imitation"</span>, <span class="at">y =</span> <span class="st">"Adoption Rate"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Based on Strang's (1993) cultural theorization theory"</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1_skills_based)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/plot1-skills-based-channeling-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="01_abm_skill_diffusion_files/figure-html/plot1-skills-based-channeling-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-2-aspirational-hunger-by-status" class="level3">
<h3 class="anchored" data-anchor-id="plot-2-aspirational-hunger-by-status">Plot 2: Aspirational Hunger by Status</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p2_hunger <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_analysis<span class="sc">$</span>status_patterns,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> status_quintile, <span class="at">y =</span> adoption_rate, <span class="at">color =</span> skill_type)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.65</span>, <span class="at">label =</span> <span class="st">"Aspirational</span><span class="sc">\n</span><span class="st">Hunger"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> skill_colors[[<span class="st">"cognitive"</span>]], <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> skill_colors, <span class="at">name =</span> <span class="st">"Skill Type:"</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Q"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Aspirational Hunger: Status-Seeking Through Cognitive Skills"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Low-status organizations actively pursue cognitive skills as mobility strategies"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Organization Status Quintile (Q1=Lowest, Q5=Highest)"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skill Adoption Rate"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Confirms active theorization-based seeking rather than passive diffusion"</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2_hunger)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/plot2-skills-based-hunger-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="01_abm_skill_diffusion_files/figure-html/plot2-skills-based-hunger-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-3-asymmetry-coefficients---mechanism-quantification" class="level3">
<h3 class="anchored" data-anchor-id="plot-3-asymmetry-coefficients---mechanism-quantification">Plot 3: Asymmetry Coefficients - Mechanism Quantification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p3_asymmetry <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_analysis<span class="sc">$</span>asymmetry_coefficients,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> skill_type, <span class="at">y =</span> asymmetry, <span class="at">fill =</span> skill_type)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, asymmetry)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.7</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">color =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> skill_colors, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cultural Theorization Effects: Quantifying Directional Bias"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Asymmetry coefficients demonstrate theorization-based channeling mechanisms"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Skill Type"</span>, <span class="at">y =</span> <span class="st">"Asymmetry Coefficient (β⁺ - β⁻)"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Positive = portable asset effect; Negative = context-dependent effect"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3_asymmetry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/plot3-skills-based-asymmetry-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="01_abm_skill_diffusion_files/figure-html/plot3-skills-based-asymmetry-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-4-temporal-dynamics---system-evolution" class="level3">
<h3 class="anchored" data-anchor-id="plot-4-temporal-dynamics---system-evolution">Plot 4: Temporal Dynamics - System Evolution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p4_temporal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(main_results<span class="sc">$</span>iteration_metrics, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> asymmetry_diff)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#6c3483"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#F39C12"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolution of Diffusion Asymmetry Over Time"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The difference between cognitive and physical adoption rates emerges and stabilizes"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Iteration"</span>, <span class="at">y =</span> <span class="st">"Asymmetry (Cognitive Rate - Physical Rate)"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Shows convergence to stable asymmetric equilibrium"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4_temporal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/plot4-temporal-dynamics-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="01_abm_skill_diffusion_files/figure-html/plot4-temporal-dynamics-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="comprehensive-sensitivity-analysis" class="level1">
<h1>Comprehensive Sensitivity Analysis</h1>
<section id="sensitivity-analysis-parameter-robustness-testing" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-analysis-parameter-robustness-testing">Sensitivity Analysis: Parameter Robustness Testing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Running Comprehensive Sensitivity Analysis...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running Comprehensive Sensitivity Analysis...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ESSENTIAL: Test robustness across parameter combinations</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>run_sensitivity_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_combinations =</span> <span class="dv">30</span>) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  sensitivity_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">uncertainty_rate =</span> <span class="fu">runif</span>(n_combinations, <span class="fl">0.05</span>, <span class="fl">0.3</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">imitation_rate =</span> <span class="fu">runif</span>(n_combinations, <span class="fl">0.4</span>, <span class="fl">0.8</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cultural_strength =</span> <span class="fu">runif</span>(n_combinations, <span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">status_bonus_cognitive =</span> <span class="fu">runif</span>(n_combinations, <span class="fl">0.1</span>, <span class="fl">0.4</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">proximity_penalty_physical =</span> <span class="fu">runif</span>(n_combinations, <span class="fl">0.1</span>, <span class="fl">0.5</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  sensitivity_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sensitivity_grid)) {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">5</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">cat</span>(<span class="st">"Sensitivity run"</span>, i, <span class="st">"of"</span>, <span class="fu">nrow</span>(sensitivity_grid), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set parameters for this run</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> DEFAULT_PARAMS</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    params<span class="sc">$</span>uncertainty_rate <span class="ot">&lt;-</span> sensitivity_grid<span class="sc">$</span>uncertainty_rate[i]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    params<span class="sc">$</span>imitation_rate <span class="ot">&lt;-</span> sensitivity_grid<span class="sc">$</span>imitation_rate[i]</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    params<span class="sc">$</span>cultural_strength <span class="ot">&lt;-</span> sensitivity_grid<span class="sc">$</span>cultural_strength[i]</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    params<span class="sc">$</span>status_bonus_cognitive <span class="ot">&lt;-</span> sensitivity_grid<span class="sc">$</span>status_bonus_cognitive[i]</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    params<span class="sc">$</span>proximity_penalty_physical <span class="ot">&lt;-</span> sensitivity_grid<span class="sc">$</span>proximity_penalty_physical[i]</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run simulation</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">42</span> <span class="sc">+</span> i)  <span class="co"># Reproducible but different for each run</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">run_skills_based_simulation</span>(params)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Analyze results safely</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>      analysis <span class="ot">&lt;-</span> <span class="fu">analyze_skills_based_patterns</span>(result)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract asymmetry metrics safely</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>      cog_asym <span class="ot">&lt;-</span> <span class="cn">NA</span>; phys_asym <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(analysis<span class="sc">$</span>asymmetry_coefficients) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        cog_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(analysis<span class="sc">$</span>asymmetry_coefficients<span class="sc">$</span>skill_type <span class="sc">==</span> <span class="st">"cognitive"</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        phys_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(analysis<span class="sc">$</span>asymmetry_coefficients<span class="sc">$</span>skill_type <span class="sc">==</span> <span class="st">"physical"</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(cog_idx) <span class="sc">&gt;</span> <span class="dv">0</span>) cog_asym <span class="ot">&lt;-</span> analysis<span class="sc">$</span>asymmetry_coefficients<span class="sc">$</span>asymmetry[cog_idx]</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(phys_idx) <span class="sc">&gt;</span> <span class="dv">0</span>) phys_asym <span class="ot">&lt;-</span> analysis<span class="sc">$</span>asymmetry_coefficients<span class="sc">$</span>asymmetry[phys_idx]</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store results</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>      sensitivity_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sensitivity_results, <span class="fu">data.frame</span>(</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">run_id =</span> i,</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">uncertainty_rate =</span> params<span class="sc">$</span>uncertainty_rate,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">imitation_rate =</span> params<span class="sc">$</span>imitation_rate,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">cultural_strength =</span> params<span class="sc">$</span>cultural_strength,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">status_bonus_cognitive =</span> params<span class="sc">$</span>status_bonus_cognitive,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">proximity_penalty_physical =</span> params<span class="sc">$</span>proximity_penalty_physical,</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">cognitive_asymmetry =</span> cog_asym,</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">physical_asymmetry =</span> phys_asym,</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">theorization_difference =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(cog_asym) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(phys_asym), cog_asym <span class="sc">-</span> phys_asym, <span class="cn">NA</span>)</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sensitivity_results)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute sensitivity analysis</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> <span class="fu">run_sensitivity_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 5 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 10 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 15 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 20 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 25 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Sensitivity run 30 of 30 
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(sensitivity_results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== SENSITIVITY ANALYSIS RESULTS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Successful runs:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(sensitivity_results<span class="sc">$</span>theorization_difference)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  valid_results <span class="ot">&lt;-</span> sensitivity_results[<span class="sc">!</span><span class="fu">is.na</span>(sensitivity_results<span class="sc">$</span>theorization_difference), ]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(valid_results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Theorization difference range:"</span>, <span class="fu">round</span>(<span class="fu">range</span>(valid_results<span class="sc">$</span>theorization_difference), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Mean theorization difference:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(valid_results<span class="sc">$</span>theorization_difference), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Consistency rate (positive differences):"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(valid_results<span class="sc">$</span>theorization_difference <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summary table</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    summary_table <span class="ot">&lt;-</span> valid_results <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_cognitive =</span> <span class="fu">mean</span>(cognitive_asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_physical =</span> <span class="fu">mean</span>(physical_asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_theorization =</span> <span class="fu">mean</span>(theorization_difference, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">consistency_rate =</span> <span class="fu">mean</span>(theorization_difference <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_runs =</span> <span class="fu">n</span>()</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(summary_table,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"**Sensitivity Analysis: Cultural Theorization Robustness**"</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Mean Cognitive"</span>, <span class="st">"Mean Physical"</span>, <span class="st">"Mean Theorization"</span>, <span class="st">"Consistency Rate"</span>, <span class="st">"N Runs"</span>),</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== SENSITIVITY ANALYSIS RESULTS ===
Successful runs: 30 
Theorization difference range: 0.107 0.435 
Mean theorization difference: 0.211 
Consistency rate (positive differences): 1 </code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Sensitivity Analysis: Cultural Theorization Robustness**</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Cognitive</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Physical</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Theorization</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Consistency Rate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N Runs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0743</td>
<td style="text-align: right;">-0.1364</td>
<td style="text-align: right;">0.2107</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="sensitivity-analysis-visualization" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-visualization">Sensitivity Analysis Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(sensitivity_results) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(sensitivity_results<span class="sc">$</span>theorization_difference)) <span class="sc">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  valid_sensitivity <span class="ot">&lt;-</span> sensitivity_results[<span class="sc">!</span><span class="fu">is.na</span>(sensitivity_results<span class="sc">$</span>theorization_difference), ]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parameter correlation analysis</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  cor_data <span class="ot">&lt;-</span> valid_sensitivity <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(uncertainty_rate, imitation_rate, cultural_strength, </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>           status_bonus_cognitive, proximity_penalty_physical, theorization_difference) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract correlations with outcome</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  cor_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">"uncertainty_rate"</span>, <span class="st">"imitation_rate"</span>, <span class="st">"cultural_strength"</span>, </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"status_bonus_cognitive"</span>, <span class="st">"proximity_penalty_physical"</span>),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">correlation =</span> cor_data[, <span class="st">"theorization_difference"</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parameter sensitivity plot</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  p_sensitivity <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cor_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(parameter, correlation), <span class="at">y =</span> correlation)) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> correlation <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, correlation)), <span class="at">hjust =</span> <span class="fu">ifelse</span>(cor_long<span class="sc">$</span>correlation <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>), </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#27AE60"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cultural Theorization: Parameter Sensitivity Analysis"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Key mechanism parameters drive theorization-based asymmetric channeling"</span>,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Parameters"</span>, <span class="at">y =</span> <span class="st">"Correlation with Theorization Effects"</span>,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Based on"</span>, <span class="fu">nrow</span>(valid_sensitivity), <span class="st">"successful parameter combinations"</span>))</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p_sensitivity)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/sensitivity-visualization-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="01_abm_skill_diffusion_files/figure-html/sensitivity-visualization-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="comprehensive-model-comparison-mechanism-necessity" class="level1">
<h1>Comprehensive Model Comparison: Mechanism Necessity</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Running Comprehensive Model Comparison...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running Comprehensive Model Comparison...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model comparison with multiple seeds for robustness</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>run_model_comparison <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_seeds =</span> <span class="dv">3</span>) {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  model_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"theoretical"</span>, <span class="st">"strong_null"</span>, <span class="st">"proper_reversed"</span>, <span class="st">"structural_control"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  comparison_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model_type <span class="cf">in</span> model_types) {</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Running"</span>, model_type, <span class="st">"model...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    model_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_seeds) {</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed <span class="sc">+</span> <span class="dv">400</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">run_skills_based_simulation</span>(<span class="at">model_type =</span> model_type)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      model_results[[seed]] <span class="ot">&lt;-</span> result</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    comparison_results[[model_type]] <span class="ot">&lt;-</span> model_results</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(comparison_results)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute model comparison</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>comparison_results <span class="ot">&lt;-</span> <span class="fu">run_model_comparison</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running theoretical model...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running strong_null model...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running proper_reversed model...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running structural_control model...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract comparison metrics</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>extract_comparison_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(comparison_results) {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  model_asymmetries <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model_type <span class="cf">in</span> <span class="fu">names</span>(comparison_results)) {</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(comparison_results[[model_type]])) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> comparison_results[[model_type]][[seed]]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        analysis <span class="ot">&lt;-</span> <span class="fu">analyze_skills_based_patterns</span>(result)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">nrow</span>(analysis<span class="sc">$</span>asymmetry_coefficients) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>          asymmetries <span class="ot">&lt;-</span> analysis<span class="sc">$</span>asymmetry_coefficients <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">model_type =</span> model_type, <span class="at">seed =</span> seed)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>          model_asymmetries <span class="ot">&lt;-</span> <span class="fu">rbind</span>(model_asymmetries, asymmetries)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(model_asymmetries)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>comparison_metrics <span class="ot">&lt;-</span> <span class="fu">extract_comparison_metrics</span>(comparison_results)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison results</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(comparison_metrics) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  model_summary <span class="ot">&lt;-</span> comparison_metrics <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model_type, skill_type) <span class="sc">%&gt;%</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_asymmetry =</span> <span class="fu">mean</span>(asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_asymmetry =</span> <span class="fu">sd</span>(asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_runs =</span> <span class="fu">n</span>(),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(model_summary,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Model Comparison: Cultural Theorization Necessity Validation**"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model Type"</span>, <span class="st">"Skill Type"</span>, <span class="st">"Mean Asymmetry"</span>, <span class="st">"SD Asymmetry"</span>, <span class="st">"N Runs"</span>),</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">which</span>(model_summary<span class="sc">$</span>model_type <span class="sc">==</span> <span class="st">"theoretical"</span>),</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">background =</span> <span class="st">"#E8F6F3"</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Model Comparison: Cultural Theorization Necessity Validation**</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Skill Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Asymmetry</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD Asymmetry</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N Runs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">proper_reversed</td>
<td style="text-align: left;">cognitive</td>
<td style="text-align: right;">-0.1050</td>
<td style="text-align: right;">0.0295</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">proper_reversed</td>
<td style="text-align: left;">physical</td>
<td style="text-align: right;">0.0979</td>
<td style="text-align: right;">0.0386</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">strong_null</td>
<td style="text-align: left;">cognitive</td>
<td style="text-align: right;">0.0084</td>
<td style="text-align: right;">0.0144</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">strong_null</td>
<td style="text-align: left;">physical</td>
<td style="text-align: right;">0.0052</td>
<td style="text-align: right;">0.0048</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">structural_control</td>
<td style="text-align: left;">cognitive</td>
<td style="text-align: right;">0.0374</td>
<td style="text-align: right;">0.0197</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">structural_control</td>
<td style="text-align: left;">physical</td>
<td style="text-align: right;">-0.0921</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(232, 246, 243, 255) !important;">theoretical</td>
<td style="text-align: left; background-color: rgba(232, 246, 243, 255) !important;">cognitive</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">0.0987</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">0.0400</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">3</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(232, 246, 243, 255) !important;">theoretical</td>
<td style="text-align: left; background-color: rgba(232, 246, 243, 255) !important;">physical</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">-0.1069</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">0.0254</td>
<td style="text-align: right; background-color: rgba(232, 246, 243, 255) !important;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="model-comparison-visualization" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-visualization">Model Comparison Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(comparison_metrics) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create comparison summary for visualization</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  viz_summary <span class="ot">&lt;-</span> comparison_metrics <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model_type, skill_type) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_asymmetry =</span> <span class="fu">mean</span>(asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">se_asymmetry =</span> <span class="fu">sd</span>(asymmetry, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main comparison plot with enhanced annotations</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  p_comparison <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(viz_summary, </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> skill_type, <span class="at">y =</span> mean_asymmetry, <span class="at">fill =</span> model_type)) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">width =</span> <span class="fl">0.75</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_asymmetry <span class="sc">-</span> se_asymmetry, </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> mean_asymmetry <span class="sc">+</span> se_asymmetry),</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, mean_asymmetry)), </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enhanced annotations</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.12</span>, <span class="at">label =</span> <span class="st">"Theoretical:</span><span class="sc">\n</span><span class="st">Aspirational Bias"</span>, </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> model_colors[[<span class="st">"theoretical"</span>]], <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="st">"Reversed:</span><span class="sc">\n</span><span class="st">Collapse"</span>, </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> model_colors[[<span class="st">"proper_reversed"</span>]], <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> model_colors, <span class="at">name =</span> <span class="st">"Model Type:"</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"theoretical"</span> <span class="ot">=</span> <span class="st">"Cultural Theorization"</span>, </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"strong_null"</span> <span class="ot">=</span> <span class="st">"Strong Null"</span>,</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"proper_reversed"</span> <span class="ot">=</span> <span class="st">"Reversed Logic"</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"structural_control"</span> <span class="ot">=</span> <span class="st">"Structural Control"</span>)) <span class="sc">+</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="fl">0.001</span>)) <span class="sc">+</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Comparison: Cultural Theorization Necessity Validation"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Cognitive asymmetry collapses when theorization logic is altered, proving mechanism necessity"</span>,</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Skill Type"</span>, <span class="at">y =</span> <span class="st">"Mean Asymmetry Coefficient"</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Error bars show standard error. Cultural theorization is necessary for asymmetric channeling"</span>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p_comparison)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/model-comparison-viz-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="01_abm_skill_diffusion_files/figure-html/model-comparison-viz-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="robustness-analysis-across-multiple-seeds" class="level1">
<h1>Robustness Analysis Across Multiple Seeds</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Running Robustness Analysis with Multiple Seeds...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running Robustness Analysis with Multiple Seeds...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run multiple seeds for main theoretical model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>run_robustness_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_seeds =</span> <span class="dv">8</span>) {</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  robustness_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_seeds) {</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Running robustness seed"</span>, seed, <span class="st">"...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed <span class="sc">+</span> <span class="dv">100</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">run_skills_based_simulation</span>()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    robustness_results[[seed]] <span class="ot">&lt;-</span> result</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(robustness_results)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute robustness analysis</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>robustness_results <span class="ot">&lt;-</span> <span class="fu">run_robustness_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running robustness seed 1 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 2 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 3 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 4 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 5 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 6 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 7 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...
Running robustness seed 8 ...
Iteration: 30 ...
Iteration: 60 ...
Iteration: 90 ...
Iteration: 120 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract robustness metrics</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>extract_robustness_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(robustness_results) {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  all_asymmetry <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(robustness_results)) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> robustness_results[[seed]]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(result<span class="sc">$</span>diffusion_events) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>      analysis <span class="ot">&lt;-</span> <span class="fu">analyze_skills_based_patterns</span>(result)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(analysis<span class="sc">$</span>asymmetry_coefficients) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        asym_coef <span class="ot">&lt;-</span> analysis<span class="sc">$</span>asymmetry_coefficients <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">seed =</span> seed)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        all_asymmetry <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_asymmetry, asym_coef)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(all_asymmetry)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>robustness_asymmetry <span class="ot">&lt;-</span> <span class="fu">extract_robustness_metrics</span>(robustness_results)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Display robustness results</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(robustness_asymmetry) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  asymmetry_summary <span class="ot">&lt;-</span> robustness_asymmetry <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(skill_type) <span class="sc">%&gt;%</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_asymmetry =</span> <span class="fu">mean</span>(asymmetry),</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_asymmetry =</span> <span class="fu">sd</span>(asymmetry),</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">consistency_check =</span> <span class="fu">sum</span>(<span class="fu">sign</span>(asymmetry) <span class="sc">==</span> <span class="fu">sign</span>(<span class="fu">mean</span>(asymmetry))),</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_runs =</span> <span class="fu">n</span>(),</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">consistency_rate =</span> consistency_check <span class="sc">/</span> total_runs)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  asymmetry_by_seed <span class="ot">&lt;-</span> robustness_asymmetry <span class="sc">%&gt;%</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(seed, skill_type, asymmetry) <span class="sc">%&gt;%</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> skill_type, <span class="at">values_from =</span> asymmetry) <span class="sc">%&gt;%</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">cognitive =</span> <span class="fu">round</span>(cognitive, <span class="dv">4</span>),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">physical =</span> <span class="fu">round</span>(physical, <span class="dv">4</span>),</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">theory_confirmed =</span> cognitive <span class="sc">&gt;</span> physical</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summary table</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(asymmetry_summary <span class="sc">%&gt;%</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(skill_type, mean_asymmetry, sd_asymmetry, consistency_rate),</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Robustness Analysis: Consistency Across Random Seeds**"</span>,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Skill Type"</span>, <span class="st">"Mean Asymmetry"</span>, <span class="st">"Std. Dev."</span>, <span class="st">"Consistency Rate"</span>),</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual seeds table</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(asymmetry_by_seed,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Asymmetry Coefficients by Individual Random Seed**"</span>,</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Seed"</span>, <span class="st">"Cognitive"</span>, <span class="st">"Physical"</span>, <span class="st">"Theory Confirmed"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">background =</span> <span class="fu">ifelse</span>(asymmetry_by_seed<span class="sc">$</span>theory_confirmed, <span class="st">"#D4EDDA"</span>, <span class="st">"#F8D7DA"</span>))</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Asymmetry Coefficients by Individual Random Seed**</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Seed</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cognitive</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Physical</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Theory Confirmed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.1447</td>
<td style="text-align: right;">-0.0735</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0963</td>
<td style="text-align: right;">-0.1160</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0529</td>
<td style="text-align: right;">-0.1134</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.1531</td>
<td style="text-align: right;">-0.1097</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0760</td>
<td style="text-align: right;">-0.1135</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.1251</td>
<td style="text-align: right;">-0.1199</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0570</td>
<td style="text-align: right;">-0.0882</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1045</td>
<td style="text-align: right;">-0.1091</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(212, 237, 218, 255) !important;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="robustness-visualization" class="level3">
<h3 class="anchored" data-anchor-id="robustness-visualization">Robustness Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(robustness_asymmetry) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  p_robustness <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(robustness_asymmetry,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(seed), <span class="at">y =</span> asymmetry, <span class="at">fill =</span> skill_type)) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> skill_colors, <span class="at">name =</span> <span class="st">"Skill Type:"</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Robustness of Asymmetry Coefficients Across Multiple Seeds"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"The asymmetric channeling pattern is stable and not an artifact of initialization"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Random Seed"</span>, <span class="at">y =</span> <span class="st">"Asymmetry Coefficient (β⁺ - β⁻)"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Confirms generative sufficiency across stochastic realizations"</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p_robustness)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="01_abm_skill_diffusion_files/figure-html/robustness-visualization-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="01_abm_skill_diffusion_files/figure-html/robustness-visualization-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="discussion-cultural-theorization-as-core-mechanism" class="level1">
<h1>Discussion: Cultural Theorization as Core Mechanism</h1>
<p>Our enhanced ABM with comprehensive sensitivity analysis and model comparison provides robust validation for <strong>Strang’s (1993) cultural theorization theory</strong> applied to skill diffusion in labor markets:</p>
<section id="parameter-robustness-confirmed" class="level2">
<h2 class="anchored" data-anchor-id="parameter-robustness-confirmed">1. <strong>Parameter Robustness Confirmed</strong></h2>
<p>The sensitivity analysis demonstrates that <strong>theorization effects are stable</strong> across wide ranges of parameter values, confirming that our results are not artifacts of specific parameter choices.</p>
</section>
<section id="mechanism-necessity-proven" class="level2">
<h2 class="anchored" data-anchor-id="mechanism-necessity-proven">2. <strong>Mechanism Necessity Proven</strong></h2>
<p>The model comparison shows that <strong>cultural theorization is necessary</strong> for asymmetric channeling. When theorization logics are reversed or neutralized, the pattern collapses or inverts, proving mechanism specificity.</p>
</section>
<section id="skills-based-organizations-as-amplifiers" class="level2">
<h2 class="anchored" data-anchor-id="skills-based-organizations-as-amplifiers">3. <strong>Skills-Based Organizations as Amplifiers</strong></h2>
<p>Contemporary skills-based organizations enhance rather than eliminate theorization effects, suggesting that organizational transformation amplifies cultural filtering processes.</p>
</section>
<section id="stochastic-robustness" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-robustness">4. <strong>Stochastic Robustness</strong></h2>
<p>The multiple-seed analysis confirms that the core patterns emerge consistently across different random initializations, demonstrating true generative sufficiency.</p>
</section>
<section id="causal-inference-strengthened" class="level2">
<h2 class="anchored" data-anchor-id="causal-inference-strengthened">5. <strong>Causal Inference Strengthened</strong></h2>
<p>Through the combination of:</p>
<ul>
<li><strong>Generative sufficiency</strong> (theoretical model produces the pattern)</li>
<li><strong>Mechanism necessity</strong> (altered models fail to produce the pattern)</li>
<li><strong>Parameter robustness</strong> (effects stable across parameter space)</li>
<li><strong>Stochastic stability</strong> (consistent across random seeds)</li>
</ul>
<p>We provide strong computational evidence for the causal role of cultural theorization in reproducing skills-based stratification.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>This enhanced Agent-Based Model provides comprehensive computational evidence for <strong>cultural theorization theory</strong> through:</p>
<ol type="1">
<li><strong>Theoretical Validation</strong>: Asymmetric trajectory channeling emerges robustly from theorization-based imitation</li>
<li><strong>Parameter Robustness</strong>: Effects remain stable across extensive parameter sensitivity testing</li>
<li><strong>Mechanism Necessity</strong>: Model comparison proves cultural theorization is required for the pattern</li>
<li><strong>Contemporary Relevance</strong>: Skills-based organizational typology shows theory applies to modern organizations</li>
<li><strong>Stochastic Robustness</strong>: Pattern emerges consistently across multiple random initializations</li>
</ol>
<p>The combination of <strong>sensitivity analysis</strong>, <strong>model comparison</strong>, and <strong>robustness testing</strong> elevates this work beyond simple demonstration to rigorous computational validation, strengthening causal claims about how cultural meanings shape organizational behavior and reproduce stratification in labor markets. This work demonstrates that <strong>cultural theorization is both necessary and sufficient</strong> for generating asymmetric trajectory channeling, providing strong evidence for the micro-foundations of skills-based stratification in contemporary organizations.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-alabdulkareem_unpacking_2018" class="csl-entry" role="listitem">
Alabdulkareem, Ahmad, Morgan R. Frank, Lijun Sun, Bedoor AlShebli, César Hidalgo, and Iyad Rahwan. 2018. <span>“Unpacking the Polarization of Workplace Skills.”</span> <em>Science Advances</em> 4 (7): eaao6030. <a href="https://doi.org/10.1126/sciadv.aao6030">https://doi.org/10.1126/sciadv.aao6030</a>.
</div>
<div id="ref-bail_prestige_2019" class="csl-entry" role="listitem">
Bail, Christopher A., Taylor W. Brown, and Andreas Wimmer. 2019. <span>“Prestige, Proximity, and Prejudice: How Google Search Terms Diffuse Across the World.”</span> <em>American Journal of Sociology</em> 124 (5): 1496–1548. <a href="https://doi.org/10.1086/702007">https://doi.org/10.1086/702007</a>.
</div>
<div id="ref-cyert_behavioral_2006" class="csl-entry" role="listitem">
Cyert, Richard Michael, Richard Michael Cyert, and James G. March. 2006. <em>A Behavioral Theory of the Firm</em>. 2. ed., [Nachdr.]. Malden, <span>MA</span>: Blackwell Publishing.
</div>
<div id="ref-dimaggio_iron_1983" class="csl-entry" role="listitem">
DiMaggio, Paul, and Walter Powell. 1983. <span>“The Iron Cage Revisited: Institutional Isomorphism and Collective Rationality in Organizational Fields.”</span> <em>American Sociological Review</em> 48 (2): 147–60. <a href="https://doi.org/10.2307/2095101">https://doi.org/10.2307/2095101</a>.
</div>
<div id="ref-hedstrom_contagious_1994" class="csl-entry" role="listitem">
Hedström, Peter. 1994. <span>“Contagious Collectivities: On the Spatial Diffusion of Swedish Trade Unions, 1890-1940.”</span> <em>American Journal of Sociology</em> 99 (5): 1157–79. <a href="https://doi.org/10.1086/230408">https://doi.org/10.1086/230408</a>.
</div>
<div id="ref-hosseinioun_skill_2025" class="csl-entry" role="listitem">
Hosseinioun, Moh, Frank Neffke, Letian Zhang, and Hyejin Youn. 2025. <span>“Skill Dependencies Uncover Nested Human Capital.”</span> <em>Nature Human Behaviour</em>, February. <a href="https://doi.org/10.1038/s41562-024-02093-2">https://doi.org/10.1038/s41562-024-02093-2</a>.
</div>
<div id="ref-kalleberg_good_2013" class="csl-entry" role="listitem">
Kalleberg, Arne L. 2013. <em>Good Jobs, Bad Jobs: The Rise of Polarized and Precarious Employment Systems in the United States, 1970s to 2000s</em>. 1. papercover ed. American Sociological Association’s Rose Series in Sociology. New York, <span>NY</span>: Russel Sage Foundation.
</div>
<div id="ref-strang_learning_2010" class="csl-entry" role="listitem">
Strang, David. 2010. <em>Learning by Example: Imitation and Innovation at a Global Bank</em>. Princeton: Princeton University Press.
</div>
<div id="ref-strang_search_2001" class="csl-entry" role="listitem">
Strang, David, and Michael W. Macy. 2001. <span>“In Search of Excellence: Fads, Success Stories, and Adaptive Emulation.”</span> <em>American Journal of Sociology</em> 107 (1): 147–82. <a href="https://doi.org/10.1086/323039">https://doi.org/10.1086/323039</a>.
</div>
<div id="ref-strang_institutional_1993" class="csl-entry" role="listitem">
Strang, David, and John W. Meyer. 1993. <span>“Institutional Conditions for Diffusion.”</span> <em>Theory and Society</em> 22 (4): 487–511. <a href="https://doi.org/10.1007/BF00993595">https://doi.org/10.1007/BF00993595</a>.
</div>
<div id="ref-strang_diffusion_1998" class="csl-entry" role="listitem">
Strang, David, and Sarah A. Soule. 1998. <span>“Diffusion in Organizations and Social Movements: From Hybrid Corn to Poison Pills.”</span> <em>Annual Review of Sociology</em> 24 (1): 265–90. <a href="https://doi.org/10.1146/annurev.soc.24.1.265">https://doi.org/10.1146/annurev.soc.24.1.265</a>.
</div>
<div id="ref-strang_spatial_1993" class="csl-entry" role="listitem">
Strang, David, and Nancy Brandon Tuma. 1993. <span>“Spatial and Temporal Heterogeneity in Diffusion.”</span> <em>American Journal of Sociology</em> 99 (3): 614–39. <a href="https://doi.org/10.1086/230318">https://doi.org/10.1086/230318</a>.
</div>
<div id="ref-tilly_durable_2009" class="csl-entry" role="listitem">
Tilly, Charles. 2009. <em>Durable Inequality</em>. Nachdr. Berkeley: Univ. of California Press.
</div>
<div id="ref-york_gradationalism_2025" class="csl-entry" role="listitem">
York, Hunter, Xi Song, and Yu Xie. 2025. <span>“Gradationalism Revisited: Intergenerational Occupational Mobility Along Axes of Occupational Characteristics.”</span> <em>American Journal of Sociology</em> 130 (4): 976–1027. <a href="https://doi.org/10.1086/733122">https://doi.org/10.1086/733122</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/rcantillan\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 Roberto Cantillan ∙ Made with <a href="https://quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p><a class="link-dark me-1" href="../../../accessibility.html" title="Accessibility commitment" target="_blank" rel="noopener"><i class="fa-solid fa-universal-access" aria-label="universal-access"></i></a> <a class="link-dark me-1" href="" title="Substack" target="_blank" rel="noopener"><i class="bi-substack " style="" role="img" aria-hidden="true"></i></a> <a class="link-dark me-1" href="https://github.com/rcantillan" title="github" target="_blank" rel="noopener"><i class="fa-brands fa-github" aria-label="github"></i></a> <a class="link-dark me-1" href="https://cl.linkedin.com/in/roberto-cantillan-carrasco-67620517b" title="LinkedIn" target="_blank" rel="noopener"><i class="fa-brands fa-linkedin" aria-label="linkedin"></i></a> <a class="link-dark me-1" href="https://orcid.org/0000-0003-0494-0692;" title="orcid" target="_blank" rel="noopener"><i class="ai  ai-orcid" style="color:black"></i></a> <a class="link-dark me-1" href="https://scholar.google.com/citations?user=xZkAmvAAAAAJ&amp;hl=es" title="Google Scholar" target="_blank" rel="noopener"><i class="ai  ai-google-scholar" style="color:black"></i></a></p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../accessibility.qmd">
<p>Accessibility</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../contact.qmd">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../license.qmd">
<p>License</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog/index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
{
  "hash": "c70d03ff8340de5da705ca1fee69fb2c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"EI Index\"\ndescription: \"Homophily\"\nauthor: \"Roberto Cantillan\"\ndate: \"2024-11-05\"\ncategories: [R, Networks, \"Ego networks\", Homophily]\nimage: \"featured.jpg\"\ntitle-block-banner: featured.jpg\ntitle-block-banner-color: \"rgba(0,38,66,0.75)\"\ntitle-block-style: default\n---\n\n\nThis document develops a data workflow to build a long-format database with the COES survey from waves w2 and w4. We also analyze panel data with the within-between model (Bell & Jones, 2014; Bell et al., 2019), which is well suited for hierarchical data structures, including repeated cross-sectional and panel data.\n\nOur goal is to explore potential relationships between homophily indicators and selected measures of civic behavior. The data analysis relies on the `panelr` package for R, which builds on `lme4`. We favor `panelr` because it streamlines procedures and code while delivering the same results as `lme4`.\n\nFor categorical attributes of alters in the ego network, beyond the proportion of alters similar to ego, a commonly used measure is the EI index (Krackhardt & Stern, 1988; Perry et al., 2018). It is defined as the number of alters different from ego (external ties E) minus the number of alters similar to ego (internal ties I), divided by the total number of alters. This is a “reverse” measure of homophily because higher values indicate greater heterophily. Since it is a linear transformation of the proportion of homophilous ties, its correlation with that proportion is a perfect −1.\n\n\n$$EI = \\frac{E - I}{E + I}$$\n\n\n\n\nThe following sections walk through the code. All analyses use data from the ELSOC COES survey, waves 2 and 4. The datasets and documentation can be downloaded from this [link](https://dataverse.harvard.edu/dataverse/coes_data_repository).\n\n\n### Load libraries and datasets\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggplot2, \n               ggthemes, \n               tidyverse, \n               sjlabelled,\n               sjPlot, \n               car, \n               vcd, \n               texreg, \n               ordinal,\n               nnet, \n               MASS, \n               mlogit, \n               matrixStats, \n               expss,\n               sjlabelled, \n               sjmisc, \n               tidyverse, \n               weights,\n               survey,\n               viridis,\n               plotly)\n```\n:::\n\n\n### Load data\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"../../../dat/ELSOC/ELSOC_W02_v3.00_R.RData\")\nload(\"../../../dat/ELSOC/ELSOC_W04_v2.01_R.RData\")\n```\n:::\n\n\n### Subset 2017 \n\n::: {.cell}\n\n```{.r .cell-code}\n# Build 2019 dataset\nego2017 <- elsoc_2017 %>%\n  dplyr::select(idencuesta,\n                sexo=m0_sexo,\n                sexoalter01=r13_sexo_01,\n                sexoalter02=r13_sexo_02,\n                sexoalter03=r13_sexo_03,\n                sexoalter04=r13_sexo_04,\n                sexoalter05=r13_sexo_05,\n                edad=m0_edad,\n                edadalter01=r13_edad_01,\n                edadalter02=r13_edad_02,\n                edadalter03=r13_edad_03,\n                edadalter04=r13_edad_04,\n                edadalter05=r13_edad_05,\n                relig=m38,\n                religalter01=r13_relig_01,\n                religalter02=r13_relig_02,\n                religalter03=r13_relig_03,\n                religalter04=r13_relig_04,\n                religalter05=r13_relig_05,\n                educ=m01,\n                educalter01=r13_educ_01,\n                educalter02=r13_educ_02,\n                educalter03=r13_educ_03,\n                educalter04=r13_educ_04,\n                educalter05=r13_educ_05,\n                ideol=c15,\n                ideolalter01=r13_ideol_01,\n                ideolalter02=r13_ideol_02,\n                ideolalter03=r13_ideol_03,\n                ideolalter04=r13_ideol_04,\n                ideolalter05=r13_ideol_05,\n                c08_01,\n                c08_02,\n                c08_03,\n                c08_04,\n                ponderador01) \n```\n:::\n\n\n### Inspect dataset\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017 <- data.frame(ego2017)\n#head(ego2017)\ndim(ego2017)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2473   36\n```\n\n\n:::\n\n```{.r .cell-code}\n# Define missing values\nego2017[ego2017==\"-999\"] <- NA\nego2017[ego2017==\"-888\"] <- NA\n```\n:::\n\n\n### Recode 2017 variables\n\n#### Sex\n\n::: {.cell}\n\n```{.r .cell-code}\nsexolab<-c(\"man\",\"woman\")\nego2017$sexo_h<-factor(Recode(ego2017$sexo,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo1<-factor(Recode(ego2017$sexoalter01,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo2<-factor(Recode(ego2017$sexoalter02,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo3<-factor(Recode(ego2017$sexoalter03,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo4<-factor(Recode(ego2017$sexoalter04,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo5<-factor(Recode(ego2017$sexoalter05,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nwith(ego2017, summary(cbind(alterSexo1,alterSexo2,alterSexo3,alterSexo4,alterSexo5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   alterSexo1      alterSexo2      alterSexo3      alterSexo4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  \n Median :2.000   Median :2.000   Median :2.000   Median :2.000  \n Mean   :1.617   Mean   :1.583   Mean   :1.552   Mean   :1.546  \n 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \n Max.   :2.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370   \n   alterSexo5   \n Min.   :1.000  \n 1st Qu.:1.000  \n Median :2.000  \n Mean   :1.557  \n 3rd Qu.:2.000  \n Max.   :2.000  \n NA's   :1692   \n```\n\n\n:::\n:::\n\n\n#### Age\n\n::: {.cell}\n\n```{.r .cell-code}\nedadlab <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \">65\")\nego2017$edadR<-factor(Recode(ego2017$edad,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\n\nego2017$alterAge1<-factor(Recode(ego2017$edadalter01,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge2<-factor(Recode(ego2017$edadalter02,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge3<-factor(Recode(ego2017$edadalter03,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge4<-factor(Recode(ego2017$edadalter04,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge5<-factor(Recode(ego2017$edadalter05,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nwith(ego2017, summary(cbind(alterAge1,alterAge2,alterAge3,alterAge4,alterAge5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   alterAge1       alterAge2       alterAge3       alterAge4       alterAge5   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00  \n 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00  \n Median :4.000   Median :3.000   Median :3.000   Median :3.000   Median :3.00  \n Mean   :3.607   Mean   :3.376   Mean   :3.328   Mean   :3.312   Mean   :3.37  \n 3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.00  \n Max.   :6.000   Max.   :6.000   Max.   :6.000   Max.   :6.000   Max.   :6.00  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370    NA's   :1692  \n```\n\n\n:::\n:::\n\n\n#### Religion\n\n::: {.cell}\n\n```{.r .cell-code}\nrellab = c(\"Catholic\",\"Evangelical\",\"Other religion\",\"non-religious\")\nego2017$religid<-factor(Recode(ego2017$relig,\"1=1;2=2;3:6=3;7:9=4;-999:-888=4\"),labels=rellab)\nego2017$alterRelig1<-factor(Recode(ego2017$religalter01,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig2<-factor(Recode(ego2017$religalter02,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig3<-factor(Recode(ego2017$religalter03,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig4<-factor(Recode(ego2017$religalter04,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig5<-factor(Recode(ego2017$religalter05,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nwith(ego2017, summary(cbind(alterRelig1,alterRelig2,alterRelig3,alterRelig4,alterRelig5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  alterRelig1     alterRelig2     alterRelig3     alterRelig4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  \n Median :1.000   Median :1.000   Median :1.000   Median :1.000  \n Mean   :1.747   Mean   :1.762   Mean   :1.836   Mean   :1.784  \n 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \n Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370   \n  alterRelig5   \n Min.   :1.000  \n 1st Qu.:1.000  \n Median :1.000  \n Mean   :1.809  \n 3rd Qu.:2.000  \n Max.   :4.000  \n NA's   :1692   \n```\n\n\n:::\n:::\n\n\n#### Education\n\n::: {.cell}\n\n```{.r .cell-code}\nedulab = c(\"Primary\", \"Secondary\", \"Technical higher\", \"University higher\")\nego2017$educaF<-factor(Recode(ego2017$educ,\"1:3=1;4:5=2;6:7=3;8:10=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca1<-factor(Recode(ego2017$educalter01,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca2<-factor(Recode(ego2017$educalter02,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca3<-factor(Recode(ego2017$educalter03,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca4<-factor(Recode(ego2017$educalter04,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca5<-factor(Recode(ego2017$educalter05,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nwith(ego2017, summary(cbind(alterEduca1,alterEduca2,alterEduca3,alterEduca4,alterEduca5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  alterEduca1     alterEduca2     alterEduca3     alterEduca4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  \n Median :2.000   Median :2.000   Median :2.000   Median :2.000  \n Mean   :2.344   Mean   :2.394   Mean   :2.438   Mean   :2.489  \n 3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:4.000  \n Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  \n NA's   :142     NA's   :481     NA's   :940     NA's   :1412   \n  alterEduca5   \n Min.   :1.000  \n 1st Qu.:2.000  \n Median :2.000  \n Mean   :2.454  \n 3rd Qu.:3.000  \n Max.   :4.000  \n NA's   :1724   \n```\n\n\n:::\n:::\n\n\n#### Political position\n\n::: {.cell}\n\n```{.r .cell-code}\npollab <- c(\"Left\", \"Center\", \"Right\", \"Independent/None\", \"NA\")\nego2017$izqderR<-factor(Recode(ego2017$ideol,\"0:3=1;4:6=2;7:10=3;11:12=4;NA=5\"),labels=pollab)\nego2017$alterPospol1=factor(Recode(ego2017$ideolalter01,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol2=factor(Recode(ego2017$ideolalter02,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol3=factor(Recode(ego2017$ideolalter03,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol4=factor(Recode(ego2017$ideolalter04,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol5=factor(Recode(ego2017$ideolalter05,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nwith(ego2017,summary(cbind(alterPospol1,alterPospol2,alterPospol3,alterPospol4,alterPospol5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  alterPospol1   alterPospol2    alterPospol3    alterPospol4    alterPospol5  \n Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:4.000   1st Qu.:4.000   1st Qu.:4.000  \n Median :4.00   Median :4.000   Median :4.000   Median :5.000   Median :5.000  \n Mean   :3.58   Mean   :3.747   Mean   :4.013   Mean   :4.318   Mean   :4.493  \n 3rd Qu.:4.00   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000  \n Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  \n```\n\n\n:::\n:::\n\n\n#### Network size\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$tamred = as.numeric(!is.na(ego2017$sexoalter01)) + \n  as.numeric(!is.na(ego2017$sexoalter02)) +\n  as.numeric(!is.na(ego2017$sexoalter03)) + \n  as.numeric(!is.na(ego2017$sexoalter04)) +\n  as.numeric(!is.na(ego2017$sexoalter05))\nprint(prop.table(table(ego2017$tamred)), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     0      1      2      3      4      5 \n0.0004 0.1500 0.1989 0.2046 0.1302 0.3158 \n```\n\n\n:::\n\n```{.r .cell-code}\nego2017$tamred[ego2017$tamred==0] <- NA\ntable(ego2017$tamred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  1   2   3   4   5 \n371 492 506 322 781 \n```\n\n\n:::\n:::\n\n\n### Plot tamred\n#### Alter political position by ego network size\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterPospol1t<-Recode(ego2017$alterPospol1,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol2t<-Recode(ego2017$alterPospol2,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol3t<-Recode(ego2017$alterPospol3,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol4t<-Recode(ego2017$alterPospol4,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol5t<-Recode(ego2017$alterPospol5,\"1:2=3;3=2;4:5=1;6:5=4\")\n\nTpospol1=with(ego2017,table(tamred,alterPospol1t), na.rm=T)\nTpospol2=with(ego2017,table(tamred,alterPospol2t), na.rm=T)\nTpospol3=with(ego2017,table(tamred,alterPospol3t), na.rm=T)\nTpospol4=with(ego2017,table(tamred,alterPospol4t), na.rm=T)\nTpospol5=with(ego2017,table(tamred,alterPospol5t), na.rm=T)\n\nHpospol=Tpospol1+Tpospol2+Tpospol3+Tpospol4+Tpospol5\nHpospol=round(Hpospol, 0)\ndimnames(Hpospol)=list(tamred= c(\"1\", \"2\", \"3\", \"4\",\"5\"),\n                       alter = c(\"Left\", \"Center\", \"Right\", \"Independent/None\", \"NA\"))\n\nhom_tam<-as.data.frame(round(prop.table(Hpospol,1),2))\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First create the ggplot\np1 <- hom_tam %>%\n  drop_na() %>%\n  ggplot(aes(x = tamred, y = Freq, fill = alter, \n             text = paste(\"Network size:\", tamred,\n                         \"<br>Political position:\", alter,\n                         \"<br>Proportion:\", scales::percent(Freq, accuracy = 0.1)))) +\n  geom_bar(position = 'dodge', stat = 'identity') +\n  labs(title = \"Alter political position\", \n       x = \"Network size\", \n       y = \"\") +\n  scale_fill_viridis_d(alpha = 1, begin = 0, end = 1, direction = 1, option = \"F\") +  \n  scale_y_continuous(limits = c(0, 1)) +\n  theme_light()\n\n# Convert to plotly\nggplotly(p1, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-f0a7a952a3b37a0daf03\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f0a7a952a3b37a0daf03\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.17999999999999994,0.18000000000000016,0.17999999999999972,0.17999999999999972,0.17999999999999972],\"base\":[0,0,0,0,0],\"x\":[0.64000000000000001,1.6400000000000001,2.6400000000000001,3.6400000000000001,4.6399999999999997],\"y\":[0.01,0.01,0.02,0.040000000000000001,0.050000000000000003],\"text\":[\"Network size: 1 <br>Political position: Left <br>Proportion: 1.0%\",\"Network size: 2 <br>Political position: Left <br>Proportion: 1.0%\",\"Network size: 3 <br>Political position: Left <br>Proportion: 2.0%\",\"Network size: 4 <br>Political position: Left <br>Proportion: 4.0%\",\"Network size: 5 <br>Political position: Left <br>Proportion: 5.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(3,5,26,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Left\",\"legendgroup\":\"Left\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.17999999999999994,0.18000000000000016,0.17999999999999972,0.17999999999999972,0.17999999999999972],\"base\":[0,0,0,0,0],\"x\":[0.82000000000000006,1.8200000000000001,2.8199999999999998,3.8199999999999998,4.8200000000000003],\"y\":[0.13,0.23999999999999999,0.34999999999999998,0.45000000000000001,0.56000000000000005],\"text\":[\"Network size: 1 <br>Political position: Center <br>Proportion: 13.0%\",\"Network size: 2 <br>Political position: Center <br>Proportion: 24.0%\",\"Network size: 3 <br>Political position: Center <br>Proportion: 35.0%\",\"Network size: 4 <br>Political position: Center <br>Proportion: 45.0%\",\"Network size: 5 <br>Political position: Center <br>Proportion: 56.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,31,83,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Center\",\"legendgroup\":\"Center\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.18000000000000005,0.17999999999999994,0.17999999999999972,0.17999999999999972,0.17999999999999972],\"base\":[0,0,0,0,0],\"x\":[1,2,3,4,5],\"y\":[0.02,0.029999999999999999,0.080000000000000002,0.10000000000000001,0.14999999999999999],\"text\":[\"Network size: 1 <br>Political position: Right <br>Proportion: 2.0%\",\"Network size: 2 <br>Political position: Right <br>Proportion: 3.0%\",\"Network size: 3 <br>Political position: Right <br>Proportion: 8.0%\",\"Network size: 4 <br>Political position: Right <br>Proportion: 10.0%\",\"Network size: 5 <br>Political position: Right <br>Proportion: 15.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(203,27,79,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Right\",\"legendgroup\":\"Right\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.18000000000000016,0.17999999999999972,0.17999999999999972,0.17999999999999972,0.17999999999999972],\"base\":[0,0,0,0,0],\"x\":[1.1799999999999999,2.1799999999999997,3.1799999999999997,4.1799999999999997,5.1799999999999997],\"y\":[0.82999999999999996,0.66000000000000003,0.47999999999999998,0.32000000000000001,0.10000000000000001],\"text\":[\"Network size: 1 <br>Political position: Independent/None <br>Proportion: 83.0%\",\"Network size: 2 <br>Political position: Independent/None <br>Proportion: 66.0%\",\"Network size: 3 <br>Political position: Independent/None <br>Proportion: 48.0%\",\"Network size: 4 <br>Political position: Independent/None <br>Proportion: 32.0%\",\"Network size: 5 <br>Political position: Independent/None <br>Proportion: 10.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(244,135,94,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Independent/None\",\"legendgroup\":\"Independent/None\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.18000000000000016,0.17999999999999972,0.17999999999999972,0.17999999999999972,0.17999999999999972],\"base\":[0,0,0,0,0],\"x\":[1.3599999999999999,2.3599999999999999,3.3599999999999999,4.3600000000000003,5.3600000000000003],\"y\":[0.01,0.050000000000000003,0.059999999999999998,0.089999999999999997,0.13],\"text\":[\"Network size: 1 <br>Political position: NA <br>Proportion: 1.0%\",\"Network size: 2 <br>Political position: NA <br>Proportion: 5.0%\",\"Network size: 3 <br>Political position: NA <br>Proportion: 6.0%\",\"Network size: 4 <br>Political position: NA <br>Proportion: 9.0%\",\"Network size: 5 <br>Political position: NA <br>Proportion: 13.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(250,235,221,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"NA\",\"legendgroup\":\"NA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Alter political position\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,5.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"1\",\"2\",\"3\",\"4\",\"5\"],\"tickvals\":[1,2,3,4,5],\"categoryorder\":\"array\",\"categoryarray\":[\"1\",\"2\",\"3\",\"4\",\"5\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Network size\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.050000000000000003,1.05],\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(179,179,179,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"alter\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"2676b4b73a531\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"2676b4b73a531\",\"visdat\":{\"2676b4b73a531\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n### Homophily by political position\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n#rec\nego2017$izqderRx<-Recode(ego2017$ideol,\"0:3=1;3:6=2;7:10=3;11:12=4;-999:-888=NA\")\nego2017$alterPospol1x=Recode(ego2017$ideolalter01,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol2x=Recode(ego2017$ideolalter02,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol3x=Recode(ego2017$ideolalter03,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol4x=Recode(ego2017$ideolalter04,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol5x=Recode(ego2017$ideolalter05,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\n\nTpospol1=with(ego2017,table(izqderRx,alterPospol1x))\nTpospol2=with(ego2017,table(izqderRx,alterPospol2x))\nTpospol3=with(ego2017,table(izqderRx,alterPospol3x))\nTpospol4=with(ego2017,table(izqderRx,alterPospol4x))\nTpospol5=with(ego2017,table(izqderRx,alterPospol5x))\n\nHpospol=Tpospol1+Tpospol2+Tpospol3+Tpospol4+Tpospol5\nHpospol=round(Hpospol, 0)\ndimnames(Hpospol)=list(ego=c(\"Left\", \"Center\", \"Right\", \"Independent/None\"),\n                       alter=c(\"Left\", \"Center\", \"Right\", \"Independent/None\"))\nround(prop.table(Hpospol,1),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  alter\nego                Left Center Right Independent/None\n  Left             0.41   0.04  0.10             0.45\n  Center           0.14   0.10  0.14             0.61\n  Right            0.12   0.07  0.39             0.42\n  Independent/None 0.05   0.02  0.06             0.87\n```\n\n\n:::\n\n```{.r .cell-code}\nqq3<-as.data.frame(round(prop.table(Hpospol,1),2))\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First create the ggplot\np2 <- qq3 %>%\n  ggplot(aes(x = ego, y = Freq, fill = alter,\n             text = paste(\"Ego:\", ego,\n                         \"<br>Alter:\", alter,\n                         \"<br>Proportion:\", scales::percent(Freq, accuracy = 0.1)))) +\n  geom_bar(position = 'dodge', stat = 'identity') +\n  labs(title = \"Political dyads\", \n       x = \"Ego political position\", \n       y = \"\") +\n  scale_fill_viridis_d(alpha = 1, begin = 0, end = 1, direction = 1, option = \"F\") + \n  scale_y_continuous(limits = c(0, 1)) +\n  theme_light()\n\n# Convert to plotly\nggplotly(p2, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-e3c47610e189b3391cf5\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e3c47610e189b3391cf5\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22500000000000009,0.22500000000000053,0.22500000000000053],\"base\":[0,0,0,0],\"x\":[0.66250000000000009,1.6625000000000001,2.6625000000000001,3.6625000000000001],\"y\":[0.40999999999999998,0.14000000000000001,0.12,0.050000000000000003],\"text\":[\"Ego: Left <br>Alter: Left <br>Proportion: 41.0%\",\"Ego: Center <br>Alter: Left <br>Proportion: 14.0%\",\"Ego: Right <br>Alter: Left <br>Proportion: 12.0%\",\"Ego: Independent/None <br>Alter: Left <br>Proportion: 5.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(3,5,26,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Left\",\"legendgroup\":\"Left\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22500000000000009,0.22499999999999964,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[0.88749999999999996,1.8875,2.8875000000000002,3.8875000000000002],\"y\":[0.040000000000000001,0.10000000000000001,0.070000000000000007,0.02],\"text\":[\"Ego: Left <br>Alter: Center <br>Proportion: 4.0%\",\"Ego: Center <br>Alter: Center <br>Proportion: 10.0%\",\"Ego: Right <br>Alter: Center <br>Proportion: 7.0%\",\"Ego: Independent/None <br>Alter: Center <br>Proportion: 2.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(132,30,90,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Center\",\"legendgroup\":\"Center\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22499999999999987,0.22499999999999964,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[1.1125,2.1124999999999998,3.1124999999999998,4.1124999999999998],\"y\":[0.10000000000000001,0.14000000000000001,0.39000000000000001,0.059999999999999998],\"text\":[\"Ego: Left <br>Alter: Right <br>Proportion: 10.0%\",\"Ego: Center <br>Alter: Right <br>Proportion: 14.0%\",\"Ego: Right <br>Alter: Right <br>Proportion: 39.0%\",\"Ego: Independent/None <br>Alter: Right <br>Proportion: 6.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(240,96,67,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Right\",\"legendgroup\":\"Right\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22499999999999964,0.22500000000000053,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[1.3374999999999999,2.3374999999999999,3.3374999999999999,4.3375000000000004],\"y\":[0.45000000000000001,0.60999999999999999,0.41999999999999998,0.87],\"text\":[\"Ego: Left <br>Alter: Independent/None <br>Proportion: 45.0%\",\"Ego: Center <br>Alter: Independent/None <br>Proportion: 61.0%\",\"Ego: Right <br>Alter: Independent/None <br>Proportion: 42.0%\",\"Ego: Independent/None <br>Alter: Independent/None <br>Proportion: 87.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(250,235,221,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Independent/None\",\"legendgroup\":\"Independent/None\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Political dyads\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Left\",\"Center\",\"Right\",\"Independent/None\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Left\",\"Center\",\"Right\",\"Independent/None\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Ego political position\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.050000000000000003,1.05],\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(179,179,179,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"alter\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"2676bd8a7c78\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"2676bd8a7c78\",\"visdat\":{\"2676bd8a7c78\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### Calculating E-I homophily by political position (ELSOC 2017)\n#### Krackhardt and Stern's (1988) E-I Index\n\nWe classify alters as external (categories different from the ego's) or internal (same category as the ego). Values of −1 imply perfect homophily, whereas values of +1 indicate perfect heterophily.\n\n### EI political position\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$pospol_alt1_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol1,\"External\", \"Internal\")\nego2017$pospol_alt2_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol2,\"External\", \"Internal\")\nego2017$pospol_alt3_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol3,\"External\", \"Internal\")\nego2017$pospol_alt4_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol4,\"External\", \"Internal\")\nego2017$pospol_alt5_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol5,\"External\", \"Internal\")\n\n# Add information about the tie types\nego2017$pospol_external<-count_row_if(criterion = \"External\", \n                                        ego2017$pospol_alt1_clasif, \n                                        ego2017$pospol_alt2_clasif,\n                                        ego2017$pospol_alt3_clasif, \n                                        ego2017$pospol_alt4_clasif, \n                                        ego2017$pospol_alt5_clasif) \n\nego2017$pospol_internal<-count_row_if(criterion = \"Internal\", \n                                        ego2017$pospol_alt1_clasif, \n                                        ego2017$pospol_alt2_clasif,\n                                        ego2017$pospol_alt3_clasif, \n                                        ego2017$pospol_alt4_clasif, \n                                        ego2017$pospol_alt5_clasif) \n\n# Finally, calculate the EI indicator\nego2017$EI_index_pospol<-(ego2017$pospol_external-ego2017$pospol_internal)/\n                         (ego2017$pospol_external+ego2017$pospol_internal)\n\nsummary(ego2017$EI_index_pospol)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n -1.000  -1.000  -0.600  -0.423  -0.200   1.000 \n```\n\n\n:::\n:::\n\n\n### EI religion\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterRelig1_clasif<-ifelse(ego2017$religid==ego2017$alterRelig1,\"External\",\"Internal\")\nego2017$alterRelig2_clasif<-ifelse(ego2017$religid==ego2017$alterRelig2,\"External\",\"Internal\")\nego2017$alterRelig3_clasif<-ifelse(ego2017$religid==ego2017$alterRelig3,\"External\",\"Internal\")\nego2017$alterRelig4_clasif<-ifelse(ego2017$religid==ego2017$alterRelig4,\"External\",\"Internal\")\nego2017$alterRelig5_clasif<-ifelse(ego2017$religid==ego2017$alterRelig5,\"External\",\"Internal\")\n\n# Add information about the tie types\nego2017$relig_external<-count_row_if(criterion = \"External\", \n                                     ego2017$alterRelig1_clasif, \n                                     ego2017$alterRelig2_clasif,\n                                     ego2017$alterRelig3_clasif, \n                                     ego2017$alterRelig4_clasif, \n                                     ego2017$alterRelig5_clasif) \n\nego2017$relig_internal<-count_row_if(criterion = \"Internal\", \n                                     ego2017$alterRelig1_clasif, \n                                     ego2017$alterRelig2_clasif,\n                                     ego2017$alterRelig3_clasif, \n                                     ego2017$alterRelig4_clasif, \n                                     ego2017$alterRelig5_clasif) \n\n# Finally, calculate the EI indicator\nego2017$EI_index_relig<-(ego2017$relig_external-ego2017$relig_internal)/\n                        (ego2017$relig_external+ego2017$relig_internal)\n\nsummary(ego2017$EI_index_relig)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-1.0000 -0.3333  0.6000  0.2776  1.0000  1.0000       8 \n```\n\n\n:::\n:::\n\n\n### EI education\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterEduca1_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca1,\"External\",\"Internal\")\nego2017$alterEduca2_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca2,\"External\",\"Internal\")\nego2017$alterEduca3_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca3,\"External\",\"Internal\")\nego2017$alterEduca4_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca4,\"External\",\"Internal\")\nego2017$alterEduca5_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca5,\"External\",\"Internal\")\n\n# Add information about the tie types\nego2017$educ_external<-count_row_if(criterion = \"External\", \n                                    ego2017$alterEduca1_clasif, \n                                    ego2017$alterEduca2_clasif,\n                                    ego2017$alterEduca3_clasif, \n                                    ego2017$alterEduca4_clasif, \n                                    ego2017$alterEduca5_clasif) \n\nego2017$educ_internal<-count_row_if(criterion = \"Internal\", \n                                    ego2017$alterEduca1_clasif, \n                                    ego2017$alterEduca2_clasif,\n                                    ego2017$alterEduca3_clasif, \n                                    ego2017$alterEduca4_clasif, \n                                    ego2017$alterEduca5_clasif) \n\n# Finally, calculate the EI indicator\nego2017$EI_index_educ<-(ego2017$educ_external-ego2017$educ_internal)/\n                        (ego2017$educ_external+ego2017$educ_internal)\n\nsummary(ego2017$EI_index_educ)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's \n-1.00000 -1.00000  0.00000 -0.03621  0.60000  1.00000       59 \n```\n\n\n:::\n:::\n\n\n### EI sex\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterSexo1_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo1,\"External\",\"Internal\")\nego2017$alterSexo2_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo2,\"External\",\"Internal\")\nego2017$alterSexo3_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo3,\"External\",\"Internal\")\nego2017$alterSexo4_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo4,\"External\",\"Internal\")\nego2017$alterSexo5_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo5,\"External\",\"Internal\")\n\n# Add information about the tie types\nego2017$sexo_external<-count_row_if(criterion = \"External\", \n                                    ego2017$alterSexo1_clasif, \n                                    ego2017$alterSexo2_clasif,\n                                    ego2017$alterSexo3_clasif, \n                                    ego2017$alterSexo4_clasif, \n                                    ego2017$alterSexo5_clasif) \n\nego2017$sexo_internal<-count_row_if(criterion = \"Internal\", \n                                    ego2017$alterSexo1_clasif, \n                                    ego2017$alterSexo2_clasif,\n                                    ego2017$alterSexo3_clasif, \n                                    ego2017$alterSexo4_clasif, \n                                    ego2017$alterSexo5_clasif) \n\n# Finally, calculate the EI indicator\nego2017$EI_index_sexo<-(ego2017$sexo_external-ego2017$sexo_internal)/\n                       (ego2017$sexo_external+ego2017$sexo_internal)\n\nsummary(ego2017$EI_index_sexo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-1.0000 -0.2000  0.3333  0.2583  1.0000  1.0000       1 \n```\n\n\n:::\n:::\n\n\n### EI age\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterAge1_clasif<-ifelse(ego2017$edadR==ego2017$alterAge1,\"External\",\"Internal\")\nego2017$alterAge2_clasif<-ifelse(ego2017$edadR==ego2017$alterAge2,\"External\",\"Internal\")\nego2017$alterAge3_clasif<-ifelse(ego2017$edadR==ego2017$alterAge3,\"External\",\"Internal\")\nego2017$alterAge4_clasif<-ifelse(ego2017$edadR==ego2017$alterAge4,\"External\",\"Internal\")\nego2017$alterAge5_clasif<-ifelse(ego2017$edadR==ego2017$alterAge5,\"External\",\"Internal\")\n\n# Add information about the tie types\nego2017$age_external<-count_row_if(criterion = \"External\", \n                                   ego2017$alterAge1_clasif, \n                                   ego2017$alterAge2_clasif,\n                                   ego2017$alterAge3_clasif, \n                                   ego2017$alterAge4_clasif, \n                                   ego2017$alterAge5_clasif) \n\nego2017$age_internal<-count_row_if(criterion = \"Internal\", \n                                   ego2017$alterAge1_clasif, \n                                   ego2017$alterAge2_clasif,\n                                   ego2017$alterAge3_clasif, \n                                   ego2017$alterAge4_clasif, \n                                   ego2017$alterAge5_clasif) \n\n# Finally, calculate the EI indicator\nego2017$EI_index_age<-(abs(ego2017$age_external-ego2017$age_internal)/\n                      (ego2017$age_external+ego2017$age_internal))\n\nsummary(ego2017$EI_index_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.0000  0.3333  0.6000  0.6177  1.0000  1.0000       1 \n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verifica que la variable existe\nnames(ego2017)  # Should display EI_index_pospol in the list\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"idencuesta\"         \"sexo\"               \"sexoalter01\"       \n  [4] \"sexoalter02\"        \"sexoalter03\"        \"sexoalter04\"       \n  [7] \"sexoalter05\"        \"edad\"               \"edadalter01\"       \n [10] \"edadalter02\"        \"edadalter03\"        \"edadalter04\"       \n [13] \"edadalter05\"        \"relig\"              \"religalter01\"      \n [16] \"religalter02\"       \"religalter03\"       \"religalter04\"      \n [19] \"religalter05\"       \"educ\"               \"educalter01\"       \n [22] \"educalter02\"        \"educalter03\"        \"educalter04\"       \n [25] \"educalter05\"        \"ideol\"              \"ideolalter01\"      \n [28] \"ideolalter02\"       \"ideolalter03\"       \"ideolalter04\"      \n [31] \"ideolalter05\"       \"c08_01\"             \"c08_02\"            \n [34] \"c08_03\"             \"c08_04\"             \"ponderador01\"      \n [37] \"sexo_h\"             \"alterSexo1\"         \"alterSexo2\"        \n [40] \"alterSexo3\"         \"alterSexo4\"         \"alterSexo5\"        \n [43] \"edadR\"              \"alterAge1\"          \"alterAge2\"         \n [46] \"alterAge3\"          \"alterAge4\"          \"alterAge5\"         \n [49] \"religid\"            \"alterRelig1\"        \"alterRelig2\"       \n [52] \"alterRelig3\"        \"alterRelig4\"        \"alterRelig5\"       \n [55] \"educaF\"             \"alterEduca1\"        \"alterEduca2\"       \n [58] \"alterEduca3\"        \"alterEduca4\"        \"alterEduca5\"       \n [61] \"izqderR\"            \"alterPospol1\"       \"alterPospol2\"      \n [64] \"alterPospol3\"       \"alterPospol4\"       \"alterPospol5\"      \n [67] \"tamred\"             \"alterPospol1t\"      \"alterPospol2t\"     \n [70] \"alterPospol3t\"      \"alterPospol4t\"      \"alterPospol5t\"     \n [73] \"izqderRx\"           \"alterPospol1x\"      \"alterPospol2x\"     \n [76] \"alterPospol3x\"      \"alterPospol4x\"      \"alterPospol5x\"     \n [79] \"pospol_alt1_clasif\" \"pospol_alt2_clasif\" \"pospol_alt3_clasif\"\n [82] \"pospol_alt4_clasif\" \"pospol_alt5_clasif\" \"pospol_external\"   \n [85] \"pospol_internal\"    \"EI_index_pospol\"    \"alterRelig1_clasif\"\n [88] \"alterRelig2_clasif\" \"alterRelig3_clasif\" \"alterRelig4_clasif\"\n [91] \"alterRelig5_clasif\" \"relig_external\"     \"relig_internal\"    \n [94] \"EI_index_relig\"     \"alterEduca1_clasif\" \"alterEduca2_clasif\"\n [97] \"alterEduca3_clasif\" \"alterEduca4_clasif\" \"alterEduca5_clasif\"\n[100] \"educ_external\"      \"educ_internal\"      \"EI_index_educ\"     \n[103] \"alterSexo1_clasif\"  \"alterSexo2_clasif\"  \"alterSexo3_clasif\" \n[106] \"alterSexo4_clasif\"  \"alterSexo5_clasif\"  \"sexo_external\"     \n[109] \"sexo_internal\"      \"EI_index_sexo\"      \"alterAge1_clasif\"  \n[112] \"alterAge2_clasif\"   \"alterAge3_clasif\"   \"alterAge4_clasif\"  \n[115] \"alterAge5_clasif\"   \"age_external\"       \"age_internal\"      \n[118] \"EI_index_age\"      \n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(ego2017$EI_index_pospol)  # Should display the statistical summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n -1.000  -1.000  -0.600  -0.423  -0.200   1.000 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Revised plot with viridis\np3 <- ggplot(data = ego2017,\n             aes(x = EI_index_pospol)) + \n  geom_histogram(aes(y = after_stat(count),\n                     fill = after_stat(count),  # Add fill within aes()\n                     text = paste(\"E-I index:\", round(x, 3),\n                                \"<br>Frequency:\", after_stat(count))),\n                 binwidth = 0.1) +\n  scale_fill_viridis_c(alpha = 1,   # Use scale_fill_viridis_c() for continuous data\n                       begin = 0,\n                       end = 1,\n                       direction = 1,\n                       option = \"F\",\n                       guide = FALSE) +  # Remove the legend\n  labs(title = \"Political homophily in personal networks\",\n       subtitle = \"E-I homophily (Krackhardt & Stern, 1988)\",\n       caption = \"Source: ELSOC COES 2017\",\n       x = \"\",\n       y = \"\") +\n  theme_light()\n\n# Convert to plotly\nggplotly(p3, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-a968f19b91272257ae70\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a968f19b91272257ae70\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.10000000000000009,0.10000000000000009,0.10000000000000009,0.10000000000000009,0.099999999999999978,0.099999999999999978,0.099999999999999978,0.10000000000000009,0.10000000000000009,0.10000000000000009,0.099999999999999867,0.10000000000000009,0.099999999999999867,0.10000000000000009,0.099999999999999867],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[-0.90000000000000013,-0.80000000000000004,-0.69999999999999996,-0.5,-0.39999999999999997,-0.29999999999999999,-0.10000000000000003,0,0.10000000000000009,0.30000000000000004,0.40000000000000002,0.5,0.70000000000000007,0.80000000000000004,0.90000000000000002],\"y\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"text\":[\"E-I index: -0.9 <br>Frequency: 0\",\"E-I index: -0.8 <br>Frequency: 0\",\"E-I index: -0.7 <br>Frequency: 0\",\"E-I index: -0.5 <br>Frequency: 0\",\"E-I index: -0.4 <br>Frequency: 0\",\"E-I index: -0.3 <br>Frequency: 0\",\"E-I index: -0.1 <br>Frequency: 0\",\"E-I index: 0 <br>Frequency: 0\",\"E-I index: 0.1 <br>Frequency: 0\",\"E-I index: 0.3 <br>Frequency: 0\",\"E-I index: 0.4 <br>Frequency: 0\",\"E-I index: 0.5 <br>Frequency: 0\",\"E-I index: 0.7 <br>Frequency: 0\",\"E-I index: 0.8 <br>Frequency: 0\",\"E-I index: 0.9 <br>Frequency: 0\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(3,5,26,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.10000000000000009,\"base\":0,\"x\":[0.60000000000000009],\"y\":[167],\"text\":\"E-I index: 0.6 <br>Frequency: 167\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(62,26,64,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.10000000000000009,\"base\":0,\"x\":[1],\"y\":[185],\"text\":\"E-I index: 1 <br>Frequency: 185\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(68,27,69,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.099999999999999867,\"base\":0,\"x\":[0.20000000000000007],\"y\":[264],\"text\":\"E-I index: 0.2 <br>Frequency: 264\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(98,30,79,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.099999999999999978,\"base\":0,\"x\":[-0.20000000000000001],\"y\":[369],\"text\":\"E-I index: -0.2 <br>Frequency: 369\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(141,29,87,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.10000000000000009,\"base\":0,\"x\":[-0.60000000000000009],\"y\":[444],\"text\":\"E-I index: -0.6 <br>Frequency: 444\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(170,31,88,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.10000000000000009,\"base\":0,\"x\":[-1],\"y\":[1044],\"text\":\"E-I index: -1 <br>Frequency: 1044\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(250,235,221,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":25.570776255707766,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Political homophily in personal networks\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.155,1.155],\"tickmode\":\"array\",\"ticktext\":[\"-1.0\",\"-0.5\",\"0.0\",\"0.5\",\"1.0\"],\"tickvals\":[-1,-0.5,0,0.5,1.0000000000000002],\"categoryorder\":\"array\",\"categoryarray\":[\"-1.0\",\"-0.5\",\"0.0\",\"0.5\",\"1.0\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-52.200000000000003,1096.2],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"tickvals\":[0,250,500.00000000000006,750,1000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.33208800332088001,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088001,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(179,179,179,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"2676b3856bcd5\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"2676b3856bcd5\",\"visdat\":{\"2676b3856bcd5\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### References\n\n- Krackhardt, D., & Stern, R. N. (1988). Informal networks and organizational crises: An experimental simulation. Social Psychology Quarterly, 123–140.\n\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
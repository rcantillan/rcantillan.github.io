{
  "hash": "22416d7d5e151f481d8019f85be2a412",
  "result": {
    "markdown": "---\ntitle: \"Poder, Coaliciones y Vínculos Múltiples en la Movilización Urbana\"\nsubtitle: \"El Conflicto por el Plan Regulador de Peñalolén 2011\"\nauthor: \n  - name: \"Roberto Cantillan\"\n    affiliations: \n        - name: \"Department of Sociology, PUC\"\n          address: \"Santiago, Chile\"\ndate: 2024-11-13\n#bibliography: references.bib\nbibliographystyle: apa\ncategories:\n  - R\n  - Networks\n  - ERGM\n  - Social Movements\n  - Contentious polítics \nimage: \"featured.jpg\"\ntitle-block-banner: featured.jpg\ntitle-block-banner-color: \"rgba(0,38,66,0.75)\"\ntitle-block-style: default\ndraft: false\n---\n\n\n# Introduction\n\nUrban social movements represent complex networks of relationships between heterogeneous actors who coordinate collective action through multiple types of ties (Diani, 2015). The conflict over Peñalolén's Master Plan in 2011 provides an exemplary case to analyze how these multiplex networks facilitate the emergence and diffusion of contentious political identities, enabling broad coalition formation among diverse urban actors.\n\n## Theoretical Framework\n\n### Networks and Contentious Politics\n\nOur analysis integrates two complementary theoretical perspectives: social movement networks and contentious politics. From a network perspective, movements emerge from dense webs of multiplex relationships that facilitate resource mobilization and sustain collective identities (Diani, 2003; Mische, 2003). These networks serve both instrumental and symbolic functions - channeling resources while also cultivating shared interpretive frames (Passy & Giugni, 2001).\n\nThe contentious politics approach emphasizes how political opportunities and threats trigger episodes of contention through mechanisms like boundary activation and polarization (McAdam et al., 2001; Tilly & Tarrow, 2015). These mechanisms operate through relational processes of brokerage and scale shift that connect previously disparate actors into broader coalitions (Tarrow, 2005).\n\n### Multiplex Ties and Movement Integration \n\nFollowing Gould's (1991) seminal work, we conceptualize tie multiplexity not merely as a descriptive network feature but as a fundamental mechanism that:\n\n1. Generates structural resistance to demobilization\n2. Facilitates coordination between diverse actors  \n3. Produces mutual reinforcement between different types of relationships\n\nThis multiplexity operates at both micro and macro levels. At the micro level, multiple ties between specific organizations reinforce commitments and reduce uncertainty in interactions (Baldassarri & Diani, 2007). At the macro level, multiplexity increases overall network robustness and enables the integration of different organizational clusters while sustaining broader collective identities (Diani, 2015).\n\n### Boundary Mechanisms and Network Evolution\n\nDrawing on Tilly (2004), we analyze how boundary change mechanisms shape movement dynamics through:\n\n1. Inscription-Erasure: The creation/dissolution of social boundaries\n2. Activation-Deactivation: Changes in the salience of existing boundaries\n3. Site Transfer: Relocation of actors relative to boundaries\n4. Relocation: Shifts in boundary-organizing relations\n\nThese mechanisms interact with network structures to shape patterns of diffusion and coalition formation (Tilly & Tarrow, 2015).\n\n### Complex Diffusion in Movement Networks\n\nRecent work on complex contagion demonstrates that the spread of contentious behaviors through networks depends on:\n\n1. Multiple exposures through redundant ties (Centola & Macy, 2007)\n2. Local clustering that provides social reinforcement (Centola, 2018) \n3. Strong ties that sustain costly forms of activism (McAdam & Paulsen, 1993)\n\nThis suggests that multiplex ties may be particularly important for the diffusion of contentious identities and practices.\n\n## Hypotheses\n\nBuilding on this theoretical framework, we propose four hypotheses:\n\nH1: Structural Effects\n- Network formation will exhibit significant transitivity (GWESP)\n- Degree distributions will be relatively homogeneous (GWDegree)\n\nH2: Conditional Homophily  \n- Organizational type homophily will be stronger for trust/values ties than instrumental ties\n- Structural block homophily will moderate organizational type homophily\n\nH3: Strategic Multiplexity\n- Multiple ties increase the probability of new tie formation\n- This effect is stronger between organizations of different types/blocks\n\nH4: Complex Diffusion\n- Adoption of contentious positions requires multiple exposures\n- Local clustering positively moderates adoption probability\n- Triadic structures are more effective than dyadic ones\n\n# Data and Methods\n\n## Research Design\n\nWe employ a mixed-methods design (Domínguez & Hollstein, 2014) combining social network analysis with qualitative contextual data. Our approach conceptualizes relational structure as a multidimensional space of social positions in which population members are non-randomly distributed (Scott, 2011).\n\n## Data Collection\n\nData was collected during 2017-2018 through:\n\n1. Network Surveys (N=31)\n   - Name generator limited to 5 nominations\n   - Multiple tie types \n   - Organizational attributes\n\n2. In-depth Interviews (N=12)\n   - Key informants\n   - Conflict history\n   - Coordination dynamics\n\n3. Documentary Sources\n   - Local press coverage\n   - Organizational documents\n   - Meeting minutes\n\nThe sampling strategy combined:\n\n- Initial identification of organization types\n- Snowball sampling until saturation (40% name repetition)\n- Secondary source validation\n\n## Networks and Attributes\n\nWe analyze five types of ties between 70 organizations:\n\n1. Cooperation (joint activities)\n2. Trust (historical bonds)\n3. Resources (material support)\n4. Values (interpretive frames) \n5. Kinship (family ties)\n\n## Limitations\n\nImportant methodological limitations include:\n\n1. Temporal bias from retrospective data collection\n2. Potential underrepresentation of peripheral actors\n3. Artificial cap on nominations (5)\n4. Difficulty capturing tie intensity\n\n## Estrategia Analítica\n\n1. **Análisis Descriptivo:**\n   - Medidas de centralidad\n   - Detección de bloques\n   - Análisis de multiplexidad\n\n2. **Modelación ERGM:**\n   - Efectos estructurales\n   - Homofilia condicional \n   - Interacción entre vínculos\n\n3. **Modelo de Difusión:**\n   - Contagio complejo\n   - Umbrales heterogéneos\n   - Efectos de estructura local\n\n# Resultados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(igraph)\nlibrary(tidygraph)\nlibrary(statnet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         Installed ReposVer Built  \nergm.ego \"1.1.0\"   \"1.1.1\"  \"4.4.1\"\nsna      \"2.7-2\"   \"2.8\"    \"4.4.0\"\n```\n:::\n\n```{.r .cell-code}\nlibrary(ergm)\nlibrary(ggplot2)\nlibrary(network)\nlibrary(kableExtra)\nlibrary(plotly)\nlibrary(gridExtra)\nlibrary(viridis)\nlibrary(sna)\nlibrary(concorR)\nlibrary(ggraph)\nlibrary(Matrix)\nlibrary(patchwork)\nlibrary(texreg)\n```\n:::\n\n\n\n## Descriptivos\n### Red\n\n::: {.cell}\n\n```{.r .cell-code}\n# Leer y preparar las matrices\ncoop_matrix <-       as.matrix(read.csv(\"datos/CoopNet.csv\", header=FALSE))\ntrust_matrix <-      as.matrix(read.csv(\"datos/ConfianzaNet.csv\", header=FALSE))\nresources_matrix <-  as.matrix(read.csv(\"datos/RecursosNet.csv\", header=FALSE))\nvalues_matrix <-     as.matrix(read.csv(\"datos/ValoresNet.csv\", header=FALSE))\nparentesco_matrix <- as.matrix(read.csv(\"datos/ParentescoNet.csv\", header=FALSE))\n\n# Leer atributos\nattributes <- read.csv(\"datos/Atributos _org2011.csv\", header=TRUE)\n\n# Verificar si las redes son dirigidas\nis_directed <- list(\n  Cooperacion = !isSymmetric(coop_matrix),\n  Confianza = !isSymmetric(trust_matrix),\n  Recursos = !isSymmetric(resources_matrix),\n  Valores = !isSymmetric(values_matrix),\n  Parentesco = !isSymmetric(parentesco_matrix)\n)\n\nprint(\"Verificación de direccionalidad de las redes:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Verificación de direccionalidad de las redes:\"\n```\n:::\n\n```{.r .cell-code}\nprint(unlist(is_directed))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCooperacion   Confianza    Recursos     Valores  Parentesco \n       TRUE        TRUE        TRUE        TRUE        TRUE \n```\n:::\n\n```{.r .cell-code}\n# Lista de todas las matrices para análisis\nmatrices_list <- list(\n  Cooperacion = coop_matrix,\n  Confianza = trust_matrix,\n  Recursos = resources_matrix,\n  Valores = values_matrix,\n  Parentesco = parentesco_matrix\n)\n\nmap_lgl(matrices_list, is.matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCooperacion   Confianza    Recursos     Valores  Parentesco \n       TRUE        TRUE        TRUE        TRUE        TRUE \n```\n:::\n\n```{.r .cell-code}\nmap_lgl(matrices_list, function(x) nrow(x) == ncol(x))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCooperacion   Confianza    Recursos     Valores  Parentesco \n       TRUE        TRUE        TRUE        TRUE        TRUE \n```\n:::\n\n```{.r .cell-code}\nprint(\"\\nEstadísticas descriptivas de las redes:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"\\nEstadísticas descriptivas de las redes:\"\n```\n:::\n\n```{.r .cell-code}\nmap_dfr(matrices_list, function(x) {\n  g <- graph_from_adjacency_matrix(x, mode=\"directed\")\n  tibble(\n    Densidad = edge_density(g),\n    N_lazos = sum(x),\n    N_nodos_activos = sum(rowSums(x) > 0),\n    Reciprocidad = reciprocity(g),\n    Transitivity = transitivity(g),\n    Componentes = count_components(g),\n    Diametro = diameter(g, directed=TRUE, weights=NA)\n  )\n}, .id = \"Red\") %>% \n  kbl() %>%\n  kable_paper(\"hover\", full_width = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Red </th>\n   <th style=\"text-align:right;\"> Densidad </th>\n   <th style=\"text-align:right;\"> N_lazos </th>\n   <th style=\"text-align:right;\"> N_nodos_activos </th>\n   <th style=\"text-align:right;\"> Reciprocidad </th>\n   <th style=\"text-align:right;\"> Transitivity </th>\n   <th style=\"text-align:right;\"> Componentes </th>\n   <th style=\"text-align:right;\"> Diametro </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Cooperacion </td>\n   <td style=\"text-align:right;\"> 0.0291925 </td>\n   <td style=\"text-align:right;\"> 141 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 0.4397163 </td>\n   <td style=\"text-align:right;\"> 0.3434705 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Confianza </td>\n   <td style=\"text-align:right;\"> 0.0260870 </td>\n   <td style=\"text-align:right;\"> 126 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0.3492063 </td>\n   <td style=\"text-align:right;\"> 0.3807692 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Recursos </td>\n   <td style=\"text-align:right;\"> 0.0198758 </td>\n   <td style=\"text-align:right;\"> 96 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 0.2291667 </td>\n   <td style=\"text-align:right;\"> 0.2601626 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valores </td>\n   <td style=\"text-align:right;\"> 0.0271222 </td>\n   <td style=\"text-align:right;\"> 131 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0.4427481 </td>\n   <td style=\"text-align:right;\"> 0.3306122 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Parentesco </td>\n   <td style=\"text-align:right;\"> 0.0095238 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.3043478 </td>\n   <td style=\"text-align:right;\"> 0.2553191 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Actores \n\n::: {.cell}\n\n```{.r .cell-code}\n# Crear objeto network con atributos\nnet_coop <- network(coop_matrix, directed=TRUE)\n\n# Agregar atributos a la red\nnet_coop %v% \"tipo\" <- attributes$Tipo_de_organización\nnet_coop %v% \"ubicacion\" <- attributes$Ubicación\nnet_coop %v% \"orientacion\" <- attributes$Orientación\n\n# Calcular medidas de centralidad\ncent_df <- data.frame(\n  Organizacion = attributes$Nombre,\n  Tipo = attributes$Tipo_de_organización,\n  Orientacion = attributes$Orientación,\n  # Centralidades\n  Degree = sna::degree(net_coop, gmode=\"digraph\"),\n  Indegree = sna::degree(net_coop, gmode=\"digraph\", cmode=\"indegree\"),\n  Outdegree = sna::degree(net_coop, gmode=\"digraph\", cmode=\"outdegree\"),\n  Betweenness = sna::betweenness(net_coop),\n  Eigenvector = sna::evcent(net_coop)\n)\n\n# Top 10 actores más centrales según diferentes medidas\nprint(\"Top 10 actores según Indegree:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Top 10 actores según Indegree:\"\n```\n:::\n\n```{.r .cell-code}\ncent_df %>%\n  arrange(desc(Indegree)) %>%\n  select(Organizacion, Tipo, Indegree) %>%\n  head(10) %>%\n  kbl() %>%\n  kable_paper(\"hover\", full_width = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Organizacion </th>\n   <th style=\"text-align:left;\"> Tipo </th>\n   <th style=\"text-align:right;\"> Indegree </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OPP_MPL </td>\n   <td style=\"text-align:left;\"> Organización política de pobladores </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_OCAP </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CV_BrillaElSol </td>\n   <td style=\"text-align:left;\"> Comité de vivienda </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OC_RAP </td>\n   <td style=\"text-align:left;\"> Organización cultural </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OC_Murgarte </td>\n   <td style=\"text-align:left;\"> Organización cultural </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_AlexLemún </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_RIP </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_CristoJoven </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPP_MUA </td>\n   <td style=\"text-align:left;\"> Organización política de pobladores </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OV_JJVV_n°19_Bolivar </td>\n   <td style=\"text-align:left;\"> Organización vecinal </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nprint(\"\\nTop 10 actores según Betweenness:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"\\nTop 10 actores según Betweenness:\"\n```\n:::\n\n```{.r .cell-code}\ncent_df %>%\n  arrange(desc(Betweenness)) %>%\n  select(Organizacion, Tipo, Betweenness) %>%\n  head(10) %>%\n  kbl() %>%\n  kable_paper(\"hover\", full_width = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Organizacion </th>\n   <th style=\"text-align:left;\"> Tipo </th>\n   <th style=\"text-align:right;\"> Betweenness </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OPP_MPL </td>\n   <td style=\"text-align:left;\"> Organización política de pobladores </td>\n   <td style=\"text-align:right;\"> 497.7976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OV_JJVV_ComunidadEcológica </td>\n   <td style=\"text-align:left;\"> Organización vecinal </td>\n   <td style=\"text-align:right;\"> 385.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CV_LosColgados </td>\n   <td style=\"text-align:left;\"> Comité de vivienda </td>\n   <td style=\"text-align:right;\"> 337.7976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_RIP </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 218.9643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gob_Mun </td>\n   <td style=\"text-align:left;\"> Otros </td>\n   <td style=\"text-align:right;\"> 199.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_AlexLemún </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 198.4405 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CV_BrillaElSol </td>\n   <td style=\"text-align:left;\"> Comité de vivienda </td>\n   <td style=\"text-align:right;\"> 176.3214 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_OCAP </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 134.9405 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPP_MUA </td>\n   <td style=\"text-align:left;\"> Organización política de pobladores </td>\n   <td style=\"text-align:right;\"> 125.4881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OPB_CristoJoven </td>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 113.5714 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Análisis de centralidad por tipo de organización\ncent_by_type <- cent_df %>%\n  group_by(Tipo) %>%\n  summarise(\n    Mean_Indegree = mean(Indegree),\n    Mean_Betweenness = mean(Betweenness),\n    N = n()\n  )\n\nprint(\"\\nCentralidad promedio por tipo de organización:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"\\nCentralidad promedio por tipo de organización:\"\n```\n:::\n\n```{.r .cell-code}\ncent_by_type %>%\n  kbl() %>%\n  kable_paper(\"hover\", full_width = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Tipo </th>\n   <th style=\"text-align:right;\"> Mean_Indegree </th>\n   <th style=\"text-align:right;\"> Mean_Betweenness </th>\n   <th style=\"text-align:right;\"> N </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Club deportivo </td>\n   <td style=\"text-align:right;\"> 0.750000 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Comité de vivienda </td>\n   <td style=\"text-align:right;\"> 2.444444 </td>\n   <td style=\"text-align:right;\"> 60.16138 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Organización cultural </td>\n   <td style=\"text-align:right;\"> 1.923077 </td>\n   <td style=\"text-align:right;\"> 24.18498 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Organización política de base </td>\n   <td style=\"text-align:right;\"> 4.166667 </td>\n   <td style=\"text-align:right;\"> 119.85119 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Organización política de pobladores </td>\n   <td style=\"text-align:right;\"> 4.333333 </td>\n   <td style=\"text-align:right;\"> 126.24008 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Organización vecinal </td>\n   <td style=\"text-align:right;\"> 1.111111 </td>\n   <td style=\"text-align:right;\"> 22.11464 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Otros </td>\n   <td style=\"text-align:right;\"> 2.000000 </td>\n   <td style=\"text-align:right;\"> 51.90000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Equivalencia estructural\n\n::: {.cell}\n\n```{.r .cell-code}\n# Leer datos\ncoop_matrix <- as.matrix(read.csv(\"datos/CoopNet.csv\", header=FALSE))\nattributes <- read.csv(\"datos/Atributos _org2011.csv\", header=TRUE)\n\n# Realizar CONCOR\nbloques <- concor(list(coop_matrix), cutoff=0.8, nsplit=2)\n\n# Ver composición de los bloques\nfor(i in 1:4) {\n    cat(paste(\"\\n\\nBLOQUE\", i, \"\\n\"))\n    cat(\"---------------\\n\")\n    organizaciones <- attributes[bloques == i, ]\n    print(table(organizaciones$Tipo))\n    cat(\"\\nOrganizaciones específicas:\\n\")\n    print(organizaciones$Nombre)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\nBLOQUE 1 \n---------------\n\n2 5 6 7 \n9 4 4 1 \n\nOrganizaciones específicas:\n [1] \"CD_AvanceDeCarvallo\"       \"CD_CristoJovén\"           \n [3] \"CD_RealHéroes\"             \"CD_SanLuisDelElqui\"       \n [5] \"CV_BrillaElSol\"            \"CV_CaminoALaVictoria\"     \n [7] \"CV_CasaDigna\"              \"CV_CoordAllegados\"        \n [9] \"CV_LosColgados\"            \"CV_PasoSeguro\"            \n[11] \"CV_PorUnaVidaMejor\"        \"CV_UnaEsperanzaEnElFuturo\"\n[13] \"CV_volverAEmpezar\"         \"Gob_Mun\"                  \n[15] \"OC_ ClubCientífico\"        \"OC_Barracón\"              \n[17] \"OC_CircoChino\"             \"OC_EncuentroAndino\"       \n\n\nBLOQUE 2 \n---------------\n\n4 5 7 \n1 8 4 \n\nOrganizaciones específicas:\n [1] \"OC_GenteDelSur\"            \"OC_ManzoPiño\"             \n [3] \"OC_Murgarte\"               \"OC_PasiónPorMiTierra\"     \n [5] \"OC_PorLaMemoriaHistórica\"  \"OC_RadioEncuentro(tv8)\"   \n [7] \"OC_RAP\"                    \"OC_Yanawara\"              \n [9] \"OG_ColegioDeArquitectos\"   \"ONG_DefendamosLaCiudad\"   \n[11] \"ONG_PACc\"                  \"OP_AsociaciónMicrobuseros\"\n[13] \"OPB_AlexLemún\"            \n\n\nBLOQUE 3 \n---------------\n\n1 3 4 \n3 6 5 \n\nOrganizaciones específicas:\n [1] \"OPB_CristoJoven\"             \"OPB_GrfemAuto\"              \n [3] \"OPB_OCAP\"                    \"OPB_RecupHermida\"           \n [5] \"OPB_RIP\"                     \"OPP_FENAPO\"                 \n [7] \"OPP_MPL\"                     \"OPP_MPLD\"                   \n [9] \"OPP_MPST\"                    \"OPP_MUA\"                    \n[11] \"OPP_PIgualdad\"               \"OV_AP_LosJardinesDeVespucio\"\n[13] \"OV_CD_ReactivaciónEnMasas\"   \"OV_CD_VillaSolNaciente\"     \n\n\nBLOQUE 4 \n---------------\n\n 1 \n15 \n\nOrganizaciones específicas:\n [1] \"OV_ComSeguridadSM\"               \"OV_CVD_VillaAlboradaNuevaPalena\"\n [3] \"OV_JI_ManosyNaturaleza\"          \"OV_JJVV_ComunidadEcológica\"     \n [5] \"OV_JJVV_CordilleraNevada\"        \"OV_JJVV_LaCordillera\"           \n [7] \"OV_JJVV_n°11_LaFaena\"            \"OV_JJVV_n°12_LaFaena\"           \n [9] \"OV_JJVV_n°14_Parque1\"            \"OV_JJVV_n°17_IsabelRiquelme\"    \n[11] \"OV_JJVV_n°18\"                    \"OV_JJVV_n°19_Bolivar\"           \n[13] \"OV_JJVV_n°19_Heroes\"             \"OV_JJVV_n°29_LoHerAlto\"         \n[15] \"OV_JJVV_PortalDelSol\"           \n```\n:::\n\n```{.r .cell-code}\n# Calcular densidades entre bloques\nblock_density <- matrix(0, 4, 4)\nfor(i in 1:4) {\n    for(j in 1:4) {\n        nodes_i <- which(bloques == i)\n        nodes_j <- which(bloques == j)\n        if(length(nodes_i) > 0 && length(nodes_j) > 0) {\n            block_density[i,j] <- sum(coop_matrix[nodes_i, nodes_j]) / \n                                 (length(nodes_i) * length(nodes_j))\n        }\n    }\n}\n\n# Mostrar densidades\ncat(\"\\n\\nDensidad entre bloques:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\nDensidad entre bloques:\n```\n:::\n\n```{.r .cell-code}\nprint(round(block_density, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]  [,2]  [,3]  [,4]\n[1,] 0.056 0.009 0.044 0.022\n[2,] 0.000 0.077 0.033 0.026\n[3,] 0.048 0.044 0.112 0.010\n[4,] 0.007 0.026 0.024 0.036\n```\n:::\n\n```{.r .cell-code}\n# Calcular cohesión de bloques\nfor(i in 1:4) {\n    cat(paste(\"\\n\\nCohesión Bloque\", i, \"\\n\"))\n    internal <- block_density[i,i]\n    external <- mean(block_density[i,-i])\n    ei_index <- (external - internal)/(external + internal)\n    cat(paste(\"Densidad interna:\", round(internal, 3), \"\\n\"))\n    cat(paste(\"Densidad externa media:\", round(external, 3), \"\\n\"))\n    cat(paste(\"Índice E-I:\", round(ei_index, 3), \"\\n\"))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\nCohesión Bloque 1 \nDensidad interna: 0.056 \nDensidad externa media: 0.025 \nÍndice E-I: -0.383 \n\n\nCohesión Bloque 2 \nDensidad interna: 0.077 \nDensidad externa media: 0.02 \nÍndice E-I: -0.595 \n\n\nCohesión Bloque 3 \nDensidad interna: 0.112 \nDensidad externa media: 0.034 \nÍndice E-I: -0.538 \n\n\nCohesión Bloque 4 \nDensidad interna: 0.036 \nDensidad externa media: 0.019 \nÍndice E-I: -0.305 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Preparar datos para el heatmap de densidades entre bloques\ndensity_df <- expand.grid(\n  from = factor(1:4, labels = paste(\"Bloque\", 1:4)),\n  to = factor(1:4, labels = paste(\"Bloque\", 1:4))\n) %>%\n  mutate(density = as.vector(block_density))\n\n\n\n# 2. Preparar datos para la composición de bloques\ncomposicion_bloques <- data.frame(\n  Bloque = rep(1:4, c(18, 13, 14, 15)),\n  Tipo = c(\n    rep(c(\"Comite Vivienda\",\"Org. Cultural\",\"Club Deportivo\",\"Gob. Municipal\"), c(9,4,4,1)), # Bloque 1\n    rep(c(\"Org. Política Base\",\"Org. Cultural\",\"Otros\"), c(1,8,4)), # Bloque 2\n    rep(c(\"Org. Vecinal\",\"Org. Política Pobladores\",\"Org. Política Base\"), c(3,6,5)), # Bloque 3\n    rep(\"Org. vecinal\", 15) # Bloque 4\n  )\n)\n\n# 3. Preparar datos para métricas de cohesión\ncohesion_df <- data.frame(\n  Bloque = factor(1:4, labels = paste(\"Bloque\", 1:4)),\n  Densidad_interna = diag(block_density),\n  Densidad_externa = sapply(1:4, function(i) mean(block_density[i,-i])),\n  EI_index = sapply(1:4, function(i) {\n    internal <- block_density[i,i]\n    external <- mean(block_density[i,-i])\n    (external - internal)/(external + internal)\n  })\n) %>%\n  pivot_longer(cols = -Bloque, \n               names_to = \"Metrica\", \n               values_to = \"Valor\")\n\n# Crear las visualizaciones\n\n# 1. Heatmap de densidades\np1 <- ggplot(density_df, aes(x = from, y = to, fill = density)) +\n  geom_tile() +\n  scale_fill_viridis() +\n  labs(title = \"Densidad entre Bloques\",\n       x = \"Bloque Origen\",\n       y = \"Bloque Destino\",\n       fill = \"Densidad\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# 2. Composición de bloques\np2 <- ggplot(composicion_bloques, aes(x = factor(Bloque), fill = Tipo)) +\n  geom_bar(position = \"fill\") +\n  scale_fill_viridis_d() +\n  labs(title = \"Composición de Bloques\",\n       x = \"Bloque\",\n       y = \"Proporción\",\n       fill = \"Tipo de Organización\") +\n  theme_minimal()\n\n# 3. Métricas de cohesión\np3 <- ggplot(cohesion_df, aes(x = Bloque, y = Valor, fill = Metrica)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_viridis_d() +\n  labs(title = \"Métricas de Cohesión por Bloque\",\n       x = \"Bloque\",\n       y = \"Valor\",\n       fill = \"Métrica\") +\n  theme_minimal()\n\n# Convertir a plotly\np1_plotly <- ggplotly(p1)\np2_plotly <- ggplotly(p2)\np3_plotly <- ggplotly(p3)\n\n# Mostrar los plots\np1_plotly\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-bef6ed65e32974b728c5\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bef6ed65e32974b728c5\">{\"x\":{\"data\":[{\"x\":[1,2,3,4],\"y\":[1,2,3,4],\"z\":[[0.49494949494949492,0,0.4242424242424242,0.065993265993265993],[0.076146076146076158,0.68531468531468531,0.39160839160839161,0.22843822843822842],[0.3888888888888889,0.2937062937062937,1,0.2121212121212121],[0.19797979797979798,0.22843822843822842,0.084848484848484854,0.31676767676767675]],\"text\":[[\"from: Bloque 1<br />to: Bloque 1<br />density: 0.055555556\",\"from: Bloque 2<br />to: Bloque 1<br />density: 0.000000000\",\"from: Bloque 3<br />to: Bloque 1<br />density: 0.047619048\",\"from: Bloque 4<br />to: Bloque 1<br />density: 0.007407407\"],[\"from: Bloque 1<br />to: Bloque 2<br />density: 0.008547009\",\"from: Bloque 2<br />to: Bloque 2<br />density: 0.076923077\",\"from: Bloque 3<br />to: Bloque 2<br />density: 0.043956044\",\"from: Bloque 4<br />to: Bloque 2<br />density: 0.025641026\"],[\"from: Bloque 1<br />to: Bloque 3<br />density: 0.043650794\",\"from: Bloque 2<br />to: Bloque 3<br />density: 0.032967033\",\"from: Bloque 3<br />to: Bloque 3<br />density: 0.112244898\",\"from: Bloque 4<br />to: Bloque 3<br />density: 0.023809524\"],[\"from: Bloque 1<br />to: Bloque 4<br />density: 0.022222222\",\"from: Bloque 2<br />to: Bloque 4<br />density: 0.025641026\",\"from: Bloque 3<br />to: Bloque 4<br />density: 0.009523810\",\"from: Bloque 4<br />to: Bloque 4<br />density: 0.035555556\"]],\"colorscale\":[[0,\"#440154\"],[0.065993265993265993,\"#481A6C\"],[0.076146076146076158,\"#481C6E\"],[0.084848484848484854,\"#482071\"],[0.19797979797979798,\"#414387\"],[0.2121212121212121,\"#3F4788\"],[0.22843822843822842,\"#3E4C8A\"],[0.2937062937062937,\"#355E8D\"],[0.31676767676767675,\"#32648E\"],[0.3888888888888889,\"#2B758E\"],[0.39160839160839161,\"#2A768E\"],[0.4242424242424242,\"#277E8E\"],[0.49494949494949492,\"#218F8D\"],[0.68531468531468531,\"#3DBC74\"],[1,\"#FDE725\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[1],\"name\":\"b50039613ae82af16212624818f8e597\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#440154\"],[0.0033444816053511705,\"#440256\"],[0.006688963210702341,\"#450357\"],[0.010033444816053512,\"#450558\"],[0.013377926421404682,\"#450659\"],[0.016722408026755852,\"#46075B\"],[0.020066889632107024,\"#46085C\"],[0.023411371237458192,\"#460A5D\"],[0.026755852842809364,\"#460B5E\"],[0.030100334448160536,\"#470C5F\"],[0.033444816053511704,\"#470E61\"],[0.036789297658862873,\"#470F62\"],[0.040133779264214048,\"#471063\"],[0.043478260869565223,\"#471164\"],[0.046822742474916385,\"#471365\"],[0.050167224080267553,\"#481467\"],[0.053511705685618728,\"#481568\"],[0.056856187290969903,\"#481768\"],[0.060200668896321072,\"#481769\"],[0.06354515050167224,\"#48186A\"],[0.066889632107023408,\"#481A6C\"],[0.070234113712374591,\"#481B6D\"],[0.073578595317725745,\"#481C6E\"],[0.076923076923076913,\"#481D6F\"],[0.080267558528428096,\"#481E6F\"],[0.083612040133779264,\"#481F70\"],[0.086956521739130446,\"#482071\"],[0.090301003344481601,\"#482173\"],[0.093645484949832769,\"#482374\"],[0.096989966555183951,\"#482475\"],[0.10033444816053511,\"#482576\"],[0.10367892976588627,\"#482576\"],[0.10702341137123746,\"#482777\"],[0.11036789297658862,\"#482878\"],[0.11371237458193981,\"#482979\"],[0.11705685618729096,\"#472A7A\"],[0.12040133779264214,\"#472B7A\"],[0.12374581939799331,\"#472D7B\"],[0.12709030100334448,\"#472D7B\"],[0.13043478260869565,\"#472E7C\"],[0.13377926421404682,\"#472F7D\"],[0.13712374581939799,\"#46307E\"],[0.14046822742474918,\"#46327E\"],[0.14381270903010032,\"#46337F\"],[0.14715719063545149,\"#463480\"],[0.15050167224080269,\"#463480\"],[0.15384615384615383,\"#453581\"],[0.15719063545150502,\"#453781\"],[0.16053511705685619,\"#453882\"],[0.16387959866220733,\"#443983\"],[0.16722408026755853,\"#443A83\"],[0.1705685618729097,\"#443A83\"],[0.17391304347826089,\"#443C84\"],[0.17725752508361203,\"#433D84\"],[0.1806020066889632,\"#433E85\"],[0.1839464882943144,\"#423F85\"],[0.18729096989966554,\"#424086\"],[0.19063545150501671,\"#424186\"],[0.1939799331103679,\"#424186\"],[0.19732441471571904,\"#414387\"],[0.20066889632107021,\"#414487\"],[0.20401337792642141,\"#404588\"],[0.20735785953177255,\"#404688\"],[0.21070234113712374,\"#3F4788\"],[0.21404682274247491,\"#3F4889\"],[0.21739130434782608,\"#3F4889\"],[0.22073578595317725,\"#3E4989\"],[0.22408026755852842,\"#3E4A89\"],[0.22742474916387961,\"#3E4C8A\"],[0.23076923076923075,\"#3D4D8A\"],[0.23411371237458192,\"#3D4E8A\"],[0.23745819397993312,\"#3C4F8A\"],[0.24080267558528429,\"#3C4F8A\"],[0.24414715719063543,\"#3C508B\"],[0.24749163879598662,\"#3B518B\"],[0.25083612040133779,\"#3B528B\"],[0.25418060200668896,\"#3A538B\"],[0.25752508361204013,\"#3A548C\"],[0.2608695652173913,\"#39558C\"],[0.26421404682274247,\"#39558C\"],[0.26755852842809363,\"#39568C\"],[0.2709030100334448,\"#38588C\"],[0.27424749163879597,\"#38598C\"],[0.27759197324414714,\"#375A8C\"],[0.28093645484949836,\"#375B8D\"],[0.28428093645484948,\"#375B8D\"],[0.28762541806020064,\"#365C8D\"],[0.29096989966555187,\"#365D8D\"],[0.29431438127090298,\"#355E8D\"],[0.29765886287625415,\"#355F8D\"],[0.30100334448160537,\"#34608D\"],[0.30434782608695654,\"#34618D\"],[0.30769230769230765,\"#34618D\"],[0.31103678929765888,\"#33628D\"],[0.31438127090301005,\"#33638D\"],[0.31772575250836116,\"#32648E\"],[0.32107023411371238,\"#32658E\"],[0.32441471571906355,\"#31668E\"],[0.32775919732441466,\"#31678E\"],[0.33110367892976589,\"#31678E\"],[0.33444816053511706,\"#31688E\"],[0.33779264214046817,\"#30698E\"],[0.34113712374581939,\"#306A8E\"],[0.34448160535117056,\"#2F6B8E\"],[0.34782608695652178,\"#2F6C8E\"],[0.3511705685618729,\"#2E6D8E\"],[0.35451505016722407,\"#2E6D8E\"],[0.35785953177257529,\"#2E6E8E\"],[0.3612040133779264,\"#2E6F8E\"],[0.36454849498327757,\"#2D708E\"],[0.3678929765886288,\"#2D718E\"],[0.37123745819397991,\"#2C718E\"],[0.37458193979933108,\"#2C728E\"],[0.3779264214046823,\"#2C728E\"],[0.38127090301003341,\"#2C738E\"],[0.38461538461538458,\"#2B748E\"],[0.38795986622073581,\"#2B758E\"],[0.39130434782608692,\"#2A768E\"],[0.39464882943143809,\"#2A778E\"],[0.39799331103678931,\"#2A778E\"],[0.40133779264214042,\"#2A788E\"],[0.40468227424749159,\"#29798E\"],[0.40802675585284282,\"#297A8E\"],[0.41137123745819398,\"#297B8E\"],[0.4147157190635451,\"#287C8E\"],[0.41806020066889632,\"#287D8E\"],[0.42140468227424749,\"#287D8E\"],[0.42474916387959866,\"#277E8E\"],[0.42809364548494983,\"#277F8E\"],[0.43143812709030099,\"#27808E\"],[0.43478260869565216,\"#26818E\"],[0.43812709030100333,\"#26828E\"],[0.4414715719063545,\"#26828E\"],[0.44481605351170567,\"#26828E\"],[0.44816053511705684,\"#25838E\"],[0.451505016722408,\"#25848E\"],[0.45484949832775923,\"#25858E\"],[0.45819397993311034,\"#24868E\"],[0.46153846153846151,\"#24878E\"],[0.46488294314381273,\"#23888E\"],[0.46822742474916385,\"#23888E\"],[0.47157190635451501,\"#23898E\"],[0.47491638795986624,\"#238A8D\"],[0.47826086956521735,\"#228B8D\"],[0.48160535117056857,\"#228C8D\"],[0.48494983277591974,\"#228D8D\"],[0.48829431438127086,\"#218E8D\"],[0.49163879598662208,\"#218E8D\"],[0.49498327759197325,\"#218F8D\"],[0.49832775919732436,\"#21908D\"],[0.50167224080267558,\"#21918C\"],[0.50501672240802675,\"#20928C\"],[0.50836120401337792,\"#20928C\"],[0.51170568561872909,\"#20928C\"],[0.51505016722408026,\"#20938C\"],[0.51839464882943143,\"#1F948C\"],[0.52173913043478259,\"#1F958B\"],[0.52508361204013376,\"#1F968B\"],[0.52842809364548493,\"#1F978B\"],[0.5317725752508361,\"#1F988B\"],[0.53511705685618727,\"#1F988B\"],[0.53846153846153844,\"#1F998A\"],[0.5418060200668896,\"#1F9A8A\"],[0.54515050167224077,\"#1E9B8A\"],[0.54849498327759194,\"#1E9C89\"],[0.55183946488294311,\"#1E9D89\"],[0.55518394648829428,\"#1F9E89\"],[0.55852842809364545,\"#1F9E89\"],[0.56187290969899673,\"#1F9F88\"],[0.56521739130434778,\"#1FA088\"],[0.56856187290969895,\"#1FA188\"],[0.57190635451505023,\"#1FA187\"],[0.57525083612040129,\"#1FA287\"],[0.57859531772575246,\"#20A386\"],[0.58193979933110374,\"#20A386\"],[0.58528428093645479,\"#20A486\"],[0.58862876254180596,\"#21A585\"],[0.59197324414715724,\"#21A685\"],[0.5953177257525083,\"#22A785\"],[0.59866220735785958,\"#22A884\"],[0.60200668896321075,\"#23A983\"],[0.6053511705685618,\"#23A983\"],[0.60869565217391308,\"#24AA83\"],[0.61204013377926425,\"#25AB82\"],[0.61538461538461531,\"#25AC82\"],[0.61872909698996659,\"#26AD81\"],[0.62207357859531776,\"#27AD81\"],[0.62541806020066881,\"#27AD81\"],[0.62876254180602009,\"#28AE80\"],[0.63210702341137126,\"#29AF7F\"],[0.63545150501672232,\"#2AB07F\"],[0.6387959866220736,\"#2CB17E\"],[0.64214046822742477,\"#2DB27D\"],[0.64548494983277582,\"#2EB37C\"],[0.6488294314381271,\"#2EB37C\"],[0.65217391304347827,\"#30B47C\"],[0.65551839464882933,\"#31B57B\"],[0.65886287625418061,\"#32B67A\"],[0.66220735785953178,\"#34B679\"],[0.66555183946488283,\"#35B779\"],[0.66889632107023411,\"#36B878\"],[0.67224080267558528,\"#37B878\"],[0.67558528428093634,\"#39B977\"],[0.67892976588628762,\"#3ABA76\"],[0.68227424749163879,\"#3BBB75\"],[0.68561872909698984,\"#3DBC74\"],[0.68896321070234112,\"#3EBC73\"],[0.69230769230769229,\"#40BD72\"],[0.69565217391304357,\"#41BD72\"],[0.69899665551839463,\"#42BE71\"],[0.7023411371237458,\"#44BF70\"],[0.70568561872909707,\"#46C06F\"],[0.70903010033444813,\"#48C16E\"],[0.7123745819397993,\"#49C16D\"],[0.71571906354515058,\"#4BC26C\"],[0.71906354515050164,\"#4DC26C\"],[0.72240802675585281,\"#4EC36B\"],[0.72575250836120409,\"#50C46A\"],[0.72909698996655514,\"#52C569\"],[0.73244147157190631,\"#54C568\"],[0.73578595317725759,\"#55C667\"],[0.73913043478260865,\"#57C666\"],[0.74247491638795982,\"#59C765\"],[0.7458193979933111,\"#5AC864\"],[0.74916387959866215,\"#5CC863\"],[0.75250836120401332,\"#5EC962\"],[0.7558528428093646,\"#5FCA61\"],[0.75919732441471566,\"#62CB5F\"],[0.76254180602006683,\"#64CB5F\"],[0.76588628762541811,\"#66CB5D\"],[0.76923076923076916,\"#67CC5C\"],[0.77257525083612033,\"#69CD5B\"],[0.77591973244147161,\"#6CCD5A\"],[0.77926421404682267,\"#6DCE59\"],[0.78260869565217384,\"#6FCF57\"],[0.78595317725752512,\"#71CF57\"],[0.78929765886287617,\"#74D055\"],[0.79264214046822734,\"#75D054\"],[0.79598662207357862,\"#77D153\"],[0.79933110367892968,\"#79D151\"],[0.80267558528428085,\"#7BD250\"],[0.80602006688963213,\"#7ED34F\"],[0.80936454849498318,\"#80D34E\"],[0.81270903010033446,\"#82D34D\"],[0.81605351170568563,\"#84D44B\"],[0.81939799331103669,\"#86D549\"],[0.82274247491638797,\"#88D548\"],[0.82608695652173914,\"#8AD647\"],[0.82943143812709019,\"#8DD645\"],[0.83277591973244147,\"#8FD644\"],[0.83612040133779264,\"#91D743\"],[0.83946488294314381,\"#93D741\"],[0.84280936454849498,\"#95D840\"],[0.84615384615384615,\"#97D83E\"],[0.84949832775919731,\"#9AD93D\"],[0.85284280936454848,\"#9CD93C\"],[0.85618729096989965,\"#9ED93A\"],[0.85953177257525082,\"#A0DA39\"],[0.86287625418060199,\"#A2DA37\"],[0.86622073578595316,\"#A5DB36\"],[0.86956521739130432,\"#A7DB35\"],[0.87290969899665549,\"#A9DC33\"],[0.87625418060200666,\"#ABDC31\"],[0.87959866220735783,\"#AEDC30\"],[0.882943143812709,\"#B0DD2F\"],[0.88628762541806017,\"#B2DD2D\"],[0.88963210702341133,\"#B5DE2B\"],[0.8929765886287625,\"#B7DE2A\"],[0.89632107023411367,\"#B9DE28\"],[0.89966555183946484,\"#BBDE27\"],[0.90301003344481601,\"#BEDF26\"],[0.90635451505016718,\"#C0DF25\"],[0.90969899665551845,\"#C2DF23\"],[0.91304347826086951,\"#C4E021\"],[0.91638795986622068,\"#C7E020\"],[0.91973244147157196,\"#C9E11F\"],[0.92307692307692302,\"#CBE11E\"],[0.92642140468227419,\"#CEE11D\"],[0.92976588628762546,\"#D0E11C\"],[0.93311036789297652,\"#D2E21B\"],[0.93645484949832769,\"#D4E21A\"],[0.93979933110367897,\"#D7E219\"],[0.94314381270903003,\"#D9E319\"],[0.9464882943143812,\"#DBE319\"],[0.94983277591973247,\"#DDE318\"],[0.95317725752508364,\"#DFE318\"],[0.9565217391304347,\"#E2E418\"],[0.95986622073578598,\"#E4E419\"],[0.96321070234113715,\"#E6E419\"],[0.96655518394648821,\"#E8E419\"],[0.96989966555183948,\"#EBE51A\"],[0.97324414715719065,\"#EDE51B\"],[0.97658862876254171,\"#EFE51C\"],[0.97993311036789299,\"#F1E51D\"],[0.98327759197324416,\"#F3E61E\"],[0.98662207357859522,\"#F5E61F\"],[0.98996655518394649,\"#F7E620\"],[0.99331103678929766,\"#F9E622\"],[0.99665551839464872,\"#FBE723\"],[1,\"#FDE725\"]],\"colorbar\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"thickness\":23.039999999999996,\"title\":\"Densidad\",\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.03\",\"0.06\",\"0.09\"],\"tickvals\":[0.0016666666666666668,0.26804848484848481,0.53443030303030303,0.80081212121212109],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"ticklen\":2,\"len\":0.5}},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":53.812112334378554,\"l\":72.32876712328769},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Densidad entre Bloques\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Bloque Origen\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Bloque Destino\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Densidad\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"516c3685d9cb4\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"heatmap\"}},\"cur_data\":\"516c3685d9cb4\",\"visdat\":{\"516c3685d9cb4\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\np2_plotly\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-178059ba8d7e83d16828\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-178059ba8d7e83d16828\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":0.89999999999999991,\"base\":0.77777777777777779,\"x\":[1],\"y\":[0.22222222222222221],\"text\":\"count: 0.22222222<br />factor(Bloque): 1<br />Tipo: Club Deportivo\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(68,1,84,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Club Deportivo\",\"legendgroup\":\"Club Deportivo\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.89999999999999991,\"base\":0.27777777777777779,\"x\":[1],\"y\":[0.5],\"text\":\"count: 0.50000000<br />factor(Bloque): 1<br />Tipo: Comite Vivienda\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(71,45,123,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Comite Vivienda\",\"legendgroup\":\"Comite Vivienda\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.89999999999999991,\"base\":0.22222222222222221,\"x\":[1],\"y\":[0.05555555555555558],\"text\":\"count: 0.05555556<br />factor(Bloque): 1<br />Tipo: Gob. Municipal\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(59,82,139,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Gob. Municipal\",\"legendgroup\":\"Gob. Municipal\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[0,0.38461538461538464],\"x\":[1,2],\"y\":[0.22222222222222221,0.61538461538461542],\"text\":[\"count: 0.22222222<br />factor(Bloque): 1<br />Tipo: Org. Cultural\",\"count: 0.61538462<br />factor(Bloque): 2<br />Tipo: Org. Cultural\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,114,142,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Org. Cultural\",\"legendgroup\":\"Org. Cultural\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000000013,0.90000000000000036],\"base\":[0.30769230769230771,0.6428571428571429],\"x\":[2,3],\"y\":[0.076923076923076927,0.3571428571428571],\"text\":[\"count: 0.07692308<br />factor(Bloque): 2<br />Tipo: Org. Política Base\",\"count: 0.35714286<br />factor(Bloque): 3<br />Tipo: Org. Política Base\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(33,144,140,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Org. Política Base\",\"legendgroup\":\"Org. Política Base\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000036,\"base\":0.21428571428571427,\"x\":[3],\"y\":[0.4285714285714286],\"text\":\"count: 0.42857143<br />factor(Bloque): 3<br />Tipo: Org. Política Pobladores\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(39,173,129,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Org. Política Pobladores\",\"legendgroup\":\"Org. Política Pobladores\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000036,\"base\":0,\"x\":[4],\"y\":[1],\"text\":\"count: 1.00000000<br />factor(Bloque): 4<br />Tipo: Org. vecinal\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(93,200,99,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Org. vecinal\",\"legendgroup\":\"Org. vecinal\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000036,\"base\":0,\"x\":[3],\"y\":[0.21428571428571427],\"text\":\"count: 0.21428571<br />factor(Bloque): 3<br />Tipo: Org. Vecinal\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(170,220,50,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Org. Vecinal\",\"legendgroup\":\"Org. Vecinal\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000013,\"base\":0,\"x\":[2],\"y\":[0.30769230769230771],\"text\":\"count: 0.30769231<br />factor(Bloque): 2<br />Tipo: Otros\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(253,231,37,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Otros\",\"legendgroup\":\"Otros\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Composición de Bloques\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"1\",\"2\",\"3\",\"4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"1\",\"2\",\"3\",\"4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Bloque\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.050000000000000003,1.05],\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Proporción\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Tipo de Organización\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"516c313e68bfa\":{\"x\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"516c313e68bfa\",\"visdat\":{\"516c313e68bfa\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\np3_plotly\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-f0219c7eb9c2b0f8b2ea\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f0219c7eb9c2b0f8b2ea\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.30000000000000004,0.30000000000000027,0.29999999999999982,0.29999999999999982],\"base\":[0,0,0,0],\"x\":[0.69999999999999996,1.7,2.7000000000000002,3.7000000000000002],\"y\":[0.024806674806674808,0.019536019536019536,0.033699633699633698,0.018952652285985618],\"text\":[\"Bloque: Bloque 1<br />Valor: 0.02480667<br />Metrica: Densidad_externa\",\"Bloque: Bloque 2<br />Valor: 0.01953602<br />Metrica: Densidad_externa\",\"Bloque: Bloque 3<br />Valor: 0.03369963<br />Metrica: Densidad_externa\",\"Bloque: Bloque 4<br />Valor: 0.01895265<br />Metrica: Densidad_externa\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(68,1,84,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Densidad_externa\",\"legendgroup\":\"Densidad_externa\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.29999999999999993,0.29999999999999982,0.29999999999999982,0.30000000000000027],\"base\":[0,0,0,0],\"x\":[1,2,3,4],\"y\":[0.055555555555555552,0.076923076923076927,0.11224489795918367,0.035555555555555556],\"text\":[\"Bloque: Bloque 1<br />Valor: 0.05555556<br />Metrica: Densidad_interna\",\"Bloque: Bloque 2<br />Valor: 0.07692308<br />Metrica: Densidad_interna\",\"Bloque: Bloque 3<br />Valor: 0.11224490<br />Metrica: Densidad_interna\",\"Bloque: Bloque 4<br />Valor: 0.03555556<br />Metrica: Densidad_interna\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(33,144,140,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Densidad_interna\",\"legendgroup\":\"Densidad_interna\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.29999999999999982,0.29999999999999982,0.29999999999999982,0.30000000000000071],\"base\":[-0.38262851354773353,-0.59493670886075956,-0.53818572965220501,-0.30459455423366028],\"x\":[1.3,2.2999999999999998,3.2999999999999998,4.2999999999999998],\"y\":[0.38262851354773353,0.59493670886075956,0.53818572965220501,0.30459455423366028],\"text\":[\"Bloque: Bloque 1<br />Valor: 0.38262851<br />Metrica: EI_index\",\"Bloque: Bloque 2<br />Valor: 0.59493671<br />Metrica: EI_index\",\"Bloque: Bloque 3<br />Valor: 0.53818573<br />Metrica: EI_index\",\"Bloque: Bloque 4<br />Valor: 0.30459455<br />Metrica: EI_index\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(253,231,37,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"EI_index\",\"legendgroup\":\"EI_index\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Métricas de Cohesión por Bloque\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Bloque 1\",\"Bloque 2\",\"Bloque 3\",\"Bloque 4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Bloque\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.63029578920175666,0.14760397830018085],\"tickmode\":\"array\",\"ticktext\":[\"-0.6\",\"-0.4\",\"-0.2\",\"0.0\"],\"tickvals\":[-0.60000000000000009,-0.40000000000000008,-0.20000000000000007,0],\"categoryorder\":\"array\",\"categoryarray\":[\"-0.6\",\"-0.4\",\"-0.2\",\"0.0\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Valor\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Métrica\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"516c33c6f323a\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"516c33c6f323a\",\"visdat\":{\"516c33c6f323a\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create multiplex network\nmultiplex_matrix <- coop_matrix * 0.3 + \n                   trust_matrix * 0.3 + \n                   resources_matrix * 0.2 + \n                   values_matrix * 0.2\n\n# Create graph\ng <- graph_from_adjacency_matrix(multiplex_matrix, mode=\"directed\", weighted=TRUE)\n\n# Add vertex attributes using existing data\nV(g)$degree <- igraph::degree(g)\nV(g)$betweenness <- igraph::betweenness(g)\nV(g)$eigenvector <- eigen_centrality(g)$vector\nV(g)$block <- attributes$X1PosciónCONCOR\nV(g)$type <- attributes$Tipo_de_organización\nV(g)$orientation <- attributes$Orientación\nV(g)$nombre <- attributes$Nombre\n\n\n# Add edge attributes\nedge_list <- as_edgelist(g)\nE(g)$block_tie <- ifelse(\n  V(g)$block[edge_list[,1]] == V(g)$block[edge_list[,2]], \n  paste0(\"Block\", V(g)$block[edge_list[,1]]), \n  \"between\"\n)\n\n# Network plot with ggraph\np1 <- ggraph(g, layout = \"fr\") +\n  geom_edge_link(aes(alpha = ifelse(V(g)$block[from] == V(g)$block[to], 0.6, 0.2)),\n                 color = \"black\",\n                 arrow = arrow(length = unit(2, 'mm'))) +\n  geom_node_point(aes(size = betweenness,\n                     color = as.factor(block)),\n                 alpha = 0.7) +\n  geom_node_label(aes(label = ifelse(betweenness > quantile(betweenness, 0.92),\n                                    nombre, \"\")),\n                 repel = TRUE,\n                 size = 3) +\n  scale_color_viridis_d(option = \"D\",\n                       name = \"Bloque\",\n                       labels = c(\"Político\", \"JJ.VV\", \"Base\", \"Cultural\")) +\n  scale_size_continuous(name = \"Intermediación\",\n                       range = c(2, 8),\n                       breaks = c(0, 0.025, 0.05, 0.075, 0.1, 0.125),\n                       labels = c(\"0.000\", \"0.025\", \"0.050\", \"0.075\", \"0.100\", \"0.125\")) +\n  guides(color = guide_legend(override.aes = list(size = 5)),\n         size = guide_legend(override.aes = list(alpha = 1)),\n         edge_alpha = guide_legend(title = \"Vinculo\")) +  # Eliminamos el título de la leyenda edge_alpha\n  labs(title = \"\") +\n  theme_graph() +\n  theme(legend.position = \"right\",\n        plot.title = element_text(hjust = 0.5, size = 14),\n        legend.text = element_text(size = 10),\n        legend.title = element_text(size = 12)) \n\nprint(p1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n## ERGM\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verificar distribución de grados\nout_degrees <- sna::degree(net_coop)\ntable(out_degrees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nout_degrees\n 0  1  2  3  4  5  6  7  8  9 10 11 12 14 19 \n10 20  7  6  2  1  5  4  1  7  1  3  1  1  1 \n```\n:::\n\n```{.r .cell-code}\nmax(out_degrees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19\n```\n:::\n\n```{.r .cell-code}\n# Agregar constraints para manejar el límite de nominaciones\nmodel2 <- ergm(net_coop ~ \n               edges + \n               gwesp(0.25, fixed = TRUE) + \n               gwidegree(0.25, fixed=TRUE) + \n               #gwdegree(0.25, fixed = TRUE) +\n               edgecov(trust_matrix) + \n               edgecov(resources_matrix) +\n               edgecov(parentesco_matrix) +\n               #nodefactor(\"tipo\") +\n               #nodefactor(\"orientacion\") +\n               #nodefactor(\"ubicacion\") +\n               nodematch(\"tipo\") + \n               nodematch(\"orientacion\", diff=TRUE) +\n               nodematch(\"ubicacion\"),\n                constraints = ~bd(maxout=max(out_degrees)), \n               control = control.ergm(seed = 123,\n                                    MCMLE.maxit = 25, # Aumentar iteraciones \n                                    MCMC.burnin = 5000, # Aumentar burn-in\n                                    MCMC.interval = 100, # Aumentar intervalo\n                                    MCMC.samplesize = 5000, # Aumentar tamaño de muestra\n                                    parallel = 2,\n                                    parallel.type = \"PSOCK\"))\n```\n:::\n\n\n```{.r .cell-code}\n# Print summary\nhtmlreg(model2,\n        stars=c(0.01,0.05,0.1), \n        digits=3, \n        star.symbol='&#42;',\n        custom.note = paste(\"%stars.\"),\n         align.center=TRUE,\n        single.row = T, \n        bold = 0.05)\n```\n\n```\nWarning in nobs.ergm(object): The number of observed dyads in this network is\nill-defined due to complex constraints on the sample space. Disable this\nwarning with 'options(ergm.loglik.warn_dyads=FALSE)'.\n```\n\n<table class=\"texreg\" style=\"margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;\">\n<caption>Statistical models</caption>\n<thead>\n<tr>\n<th style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 1</th>\n</tr>\n</thead>\n<tbody>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">edges</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>-7.382</b> (0.582)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">gwesp.OTP.fixed.0.25</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>1.899</b> (0.281)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">gwideg.fixed.0.25</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>2.237</b> (0.695)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">edgecov.trust_matrix</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>6.423</b> (0.801)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">edgecov.resources_matrix</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>5.513</b> (1.024)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">edgecov.parentesco_matrix</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\"><b>-3.082</b> (0.977)<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">nodematch.tipo</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.336 (0.421)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">nodematch.orientacion.Conflictiva</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.306 (0.486)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">nodematch.orientacion.No_conflictiva</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.039 (0.522)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">nodematch.ubicacion</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.415 (0.417)</td>\n</tr>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">AIC</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">-5198.030</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">BIC</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">-5133.204</td>\n</tr>\n<tr style=\"border-bottom: 2px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">Log Likelihood</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">2609.015</td>\n</tr>\n</tbody>\n<tfoot>\n<tr>\n<td style=\"font-size: 0.8em;\" colspan=\"2\"><sup>&#42;&#42;&#42;</sup>p &lt; 0.01; <sup>&#42;&#42;</sup>p &lt; 0.05; <sup>&#42;</sup>p &lt; 0.1.</td>\n</tr>\n</tfoot>\n</table>\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assess goodness-of-fit  \ngof <- gof(model2)\nprint(gof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nGoodness-of-fit for in-degree \n\n          obs min  mean max MC p-value\nidegree0   12   7 11.72  18       0.96\nidegree1   24  15 25.78  34       0.72\nidegree2   15   6 14.61  21       0.98\nidegree3    8   2  6.38  11       0.64\nidegree4    4   1  4.90  10       0.88\nidegree5    3   0  2.12   5       0.60\nidegree6    2   0  1.89   4       1.00\nidegree7    1   0  1.35   3       1.00\nidegree8    0   0  0.22   2       1.00\nidegree9    0   0  0.03   1       1.00\nidegree12   0   0  0.02   1       1.00\nidegree13   1   0  0.14   1       0.28\nidegree14   0   0  0.63   1       0.74\nidegree15   0   0  0.18   1       1.00\nidegree16   0   0  0.02   1       1.00\nidegree17   0   0  0.01   1       1.00\n\nGoodness-of-fit for out-degree \n\n          obs min  mean max MC p-value\nodegree0   38  27 33.83  38       0.08\nodegree1    3   1  5.91  13       0.36\nodegree2    1   0  2.42   6       0.44\nodegree3    6   1  4.47   8       0.54\nodegree4    4   2  7.69  13       0.06\nodegree5    9   1  9.75  15       0.88\nodegree6    6   0  4.30  10       0.44\nodegree7    3   0  1.33   6       0.24\nodegree8    0   0  0.26   2       1.00\nodegree9    0   0  0.03   1       1.00\nodegree10   0   0  0.01   1       1.00\n\nGoodness-of-fit for edgewise shared partner \n\n         obs min  mean max MC p-value\nesp.OTP0  51  40 50.72  66       1.00\nesp.OTP1  53  41 52.81  69       0.96\nesp.OTP2  23  17 27.90  45       0.36\nesp.OTP3  10   2  6.89  14       0.28\nesp.OTP4   4   0  2.73   8       0.42\nesp.OTP5   0   0  0.17   2       1.00\nesp.OTP6   0   0  0.01   1       1.00\n\nGoodness-of-fit for minimum geodesic distance \n\n     obs  min    mean  max MC p-value\n1    141  130  141.23  153       1.00\n2    250  192  248.21  301       0.94\n3    283  207  304.18  414       0.68\n4    230  140  268.84  444       0.40\n5    153   68  180.83  335       0.66\n6    117   13   98.96  241       0.72\n7     67    0   51.56  181       0.68\n8     12    0   26.52  150       0.86\n9      0    0   13.31  102       0.86\n10     0    0    6.38   95       1.00\n11     0    0    3.08  104       1.00\n12     0    0    0.89   21       1.00\n13     0    0    0.43   16       1.00\n14     0    0    0.14    8       1.00\n15     0    0    0.03    2       1.00\nInf 3577 2760 3485.41 4066       0.82\n\nGoodness-of-fit for model statistics \n\n                                           obs       min      mean       max\nedges                                141.00000 130.00000 141.23000 153.00000\ngwesp.OTP.fixed.0.25                  98.91267  83.68375  99.36065 118.47841\ngwideg.fixed.0.25                     66.58862  59.60889  66.48744  71.40914\nedgecov.trust_matrix                 118.00000 112.00000 117.83000 123.00000\nedgecov.resources_matrix              93.00000  90.00000  93.01000  95.00000\nedgecov.parentesco_matrix             38.00000  33.00000  37.99000  41.00000\nnodematch.tipo                        58.00000  49.00000  57.45000  69.00000\nnodematch.orientacion.Conflictiva     65.00000  57.00000  64.93000  73.00000\nnodematch.orientacion.No_conflictiva  32.00000  27.00000  31.92000  38.00000\nnodematch.ubicacion                   80.00000  71.00000  80.12000  90.00000\n                                     MC p-value\nedges                                      1.00\ngwesp.OTP.fixed.0.25                       0.96\ngwideg.fixed.0.25                          0.92\nedgecov.trust_matrix                       1.00\nedgecov.resources_matrix                   1.00\nedgecov.parentesco_matrix                  1.00\nnodematch.tipo                             0.92\nnodematch.orientacion.Conflictiva          1.00\nnodematch.orientacion.No_conflictiva       1.00\nnodematch.ubicacion                        1.00\n```\n:::\n\n```{.r .cell-code}\nplot(gof)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot diagnostics  \nmcmc.diagnostics(model2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSample statistics summary:\n\nIterations = 113280:2260608\nThinning interval = 576 \nNumber of chains = 2 \nSample size per chain = 3729 \n\n1. Empirical mean and standard deviation for each variable,\n   plus standard error of the mean:\n\n                                          Mean    SD Naive SE Time-series SE\nedges                                 0.203942 4.905  0.05680        0.15855\ngwesp.OTP.fixed.0.25                  0.324829 7.119  0.08244        0.26045\ngwideg.fixed.0.25                     0.001303 2.285  0.02646        0.04466\nedgecov.trust_matrix                  0.230088 2.182  0.02527        0.13261\nedgecov.resources_matrix              0.041566 1.068  0.01237        0.05510\nedgecov.parentesco_matrix             0.263878 1.725  0.01998        0.09330\nnodematch.tipo                        0.396755 3.121  0.03614        0.10540\nnodematch.orientacion.Conflictiva     0.133280 3.040  0.03520        0.10609\nnodematch.orientacion.No_conflictiva -0.018235 2.454  0.02842        0.06978\nnodematch.ubicacion                  -0.024269 3.413  0.03952        0.10540\n\n2. Quantiles for each variable:\n\n                                        2.5%    25%      50%   75%  97.5%\nedges                                 -9.000 -3.000  0.00000 3.000 10.000\ngwesp.OTP.fixed.0.25                 -13.067 -4.634  0.16737 5.192 14.697\ngwideg.fixed.0.25                     -4.403 -1.594 -0.03542 1.556  4.511\nedgecov.trust_matrix                  -4.000 -1.000  0.00000 2.000  4.000\nedgecov.resources_matrix              -2.000 -1.000  0.00000 1.000  2.000\nedgecov.parentesco_matrix             -3.000 -1.000  0.00000 1.000  3.000\nnodematch.tipo                        -5.000 -2.000  0.00000 2.000  7.000\nnodematch.orientacion.Conflictiva     -6.000 -2.000  0.00000 2.000  6.000\nnodematch.orientacion.No_conflictiva  -4.000 -2.000  0.00000 2.000  5.000\nnodematch.ubicacion                   -6.000 -2.000  0.00000 2.000  7.000\n\n\nAre sample statistics significantly different from observed?\n               edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25\ndiff.      0.2039421            0.3248285       0.001302875\ntest stat. 1.3103792            1.2734396       0.030079119\nP-val.     0.1900676            0.2028621       0.976003954\n           edgecov.trust_matrix edgecov.resources_matrix\ndiff.                 0.2300885                0.0415661\ntest stat.            1.7567443                0.7542863\nP-val.                0.0789614                0.4506773\n           edgecov.parentesco_matrix nodematch.tipo\ndiff.                    0.263877715   0.3967551622\ntest stat.               2.856112054   3.7768393985\nP-val.                   0.004288637   0.0001588311\n           nodematch.orientacion.Conflictiva\ndiff.                              0.1332797\ntest stat.                         1.2713375\nP-val.                             0.2036086\n           nodematch.orientacion.No_conflictiva nodematch.ubicacion\ndiff.                               -0.01823545         -0.02426924\ntest stat.                          -0.26177960         -0.23254063\nP-val.                               0.79349137          0.81611813\n                 (Omni)\ndiff.                NA\ntest stat. 3.912031e+01\nP-val.     3.283269e-05\n\nSample statistics cross-correlations:\n                                         edges gwesp.OTP.fixed.0.25\nedges                                1.0000000            0.7503673\ngwesp.OTP.fixed.0.25                 0.7503673            1.0000000\ngwideg.fixed.0.25                    0.6226578            0.1736493\nedgecov.trust_matrix                 0.4753875            0.4463577\nedgecov.resources_matrix             0.2466648            0.1260179\nedgecov.parentesco_matrix            0.3955081            0.4076238\nnodematch.tipo                       0.6043182            0.4923756\nnodematch.orientacion.Conflictiva    0.5921523            0.6280903\nnodematch.orientacion.No_conflictiva 0.4577369            0.1705258\nnodematch.ubicacion                  0.6574279            0.5786321\n                                     gwideg.fixed.0.25 edgecov.trust_matrix\nedges                                       0.62265776            0.4753875\ngwesp.OTP.fixed.0.25                        0.17364934            0.4463577\ngwideg.fixed.0.25                           1.00000000            0.2083101\nedgecov.trust_matrix                        0.20831006            1.0000000\nedgecov.resources_matrix                    0.08518801            0.1529194\nedgecov.parentesco_matrix                   0.16911330            0.7868593\nnodematch.tipo                              0.34320034            0.4412721\nnodematch.orientacion.Conflictiva           0.17467212            0.4154842\nnodematch.orientacion.No_conflictiva        0.45732699            0.1624489\nnodematch.ubicacion                         0.35304030            0.2501853\n                                     edgecov.resources_matrix\nedges                                              0.24666483\ngwesp.OTP.fixed.0.25                               0.12601792\ngwideg.fixed.0.25                                  0.08518801\nedgecov.trust_matrix                               0.15291940\nedgecov.resources_matrix                           1.00000000\nedgecov.parentesco_matrix                          0.21725480\nnodematch.tipo                                     0.15110349\nnodematch.orientacion.Conflictiva                  0.16676813\nnodematch.orientacion.No_conflictiva               0.03281462\nnodematch.ubicacion                                0.24784977\n                                     edgecov.parentesco_matrix nodematch.tipo\nedges                                               0.39550811      0.6043182\ngwesp.OTP.fixed.0.25                                0.40762379      0.4923756\ngwideg.fixed.0.25                                   0.16911330      0.3432003\nedgecov.trust_matrix                                0.78685928      0.4412721\nedgecov.resources_matrix                            0.21725480      0.1511035\nedgecov.parentesco_matrix                           1.00000000      0.3600311\nnodematch.tipo                                      0.36003114      1.0000000\nnodematch.orientacion.Conflictiva                   0.36027801      0.3731789\nnodematch.orientacion.No_conflictiva                0.03955758      0.3571450\nnodematch.ubicacion                                 0.23468991      0.4319629\n                                     nodematch.orientacion.Conflictiva\nedges                                                       0.59215225\ngwesp.OTP.fixed.0.25                                        0.62809031\ngwideg.fixed.0.25                                           0.17467212\nedgecov.trust_matrix                                        0.41548417\nedgecov.resources_matrix                                    0.16676813\nedgecov.parentesco_matrix                                   0.36027801\nnodematch.tipo                                              0.37317886\nnodematch.orientacion.Conflictiva                           1.00000000\nnodematch.orientacion.No_conflictiva                       -0.01592184\nnodematch.ubicacion                                         0.28046311\n                                     nodematch.orientacion.No_conflictiva\nedges                                                          0.45773688\ngwesp.OTP.fixed.0.25                                           0.17052580\ngwideg.fixed.0.25                                              0.45732699\nedgecov.trust_matrix                                           0.16244894\nedgecov.resources_matrix                                       0.03281462\nedgecov.parentesco_matrix                                      0.03955758\nnodematch.tipo                                                 0.35714501\nnodematch.orientacion.Conflictiva                             -0.01592184\nnodematch.orientacion.No_conflictiva                           1.00000000\nnodematch.ubicacion                                            0.28309945\n                                     nodematch.ubicacion\nedges                                          0.6574279\ngwesp.OTP.fixed.0.25                           0.5786321\ngwideg.fixed.0.25                              0.3530403\nedgecov.trust_matrix                           0.2501853\nedgecov.resources_matrix                       0.2478498\nedgecov.parentesco_matrix                      0.2346899\nnodematch.tipo                                 0.4319629\nnodematch.orientacion.Conflictiva              0.2804631\nnodematch.orientacion.No_conflictiva           0.2830995\nnodematch.ubicacion                            1.0000000\n\nSample statistics auto-correlation:\nChain 1 \n             edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25 edgecov.trust_matrix\nLag 0    1.0000000            1.0000000        1.00000000            1.0000000\nLag 576  0.4397807            0.6227530        0.18162679            0.9178198\nLag 1152 0.3148283            0.4728451        0.09813186            0.8480034\nLag 1728 0.2698242            0.3907255        0.08396391            0.7912741\nLag 2304 0.2537632            0.3348324        0.08270944            0.7421865\nLag 2880 0.2518141            0.3086343        0.08922975            0.6997454\n         edgecov.resources_matrix edgecov.parentesco_matrix nodematch.tipo\nLag 0                   1.0000000                 1.0000000      1.0000000\nLag 576                 0.8770662                 0.8874269      0.5352554\nLag 1152                0.7853049                 0.8034089      0.4365070\nLag 1728                0.7156640                 0.7390042      0.3566043\nLag 2304                0.6533247                 0.6824135      0.3276652\nLag 2880                0.6000438                 0.6363426      0.2863504\n         nodematch.orientacion.Conflictiva nodematch.orientacion.No_conflictiva\nLag 0                            1.0000000                           1.00000000\nLag 576                          0.5890142                           0.26249115\nLag 1152                         0.4525227                           0.17479771\nLag 1728                         0.3924194                           0.12756234\nLag 2304                         0.3510933                           0.09905353\nLag 2880                         0.3275476                           0.12989554\n         nodematch.ubicacion\nLag 0              1.0000000\nLag 576            0.4762715\nLag 1152           0.3266910\nLag 1728           0.2832940\nLag 2304           0.2423880\nLag 2880           0.2301816\nChain 2 \n             edges gwesp.OTP.fixed.0.25 gwideg.fixed.0.25 edgecov.trust_matrix\nLag 0    1.0000000            1.0000000        1.00000000            1.0000000\nLag 576  0.4371948            0.6385332        0.12922643            0.9097443\nLag 1152 0.3262631            0.4884039        0.10594288            0.8370430\nLag 1728 0.2813862            0.4024359        0.10195574            0.7703448\nLag 2304 0.2346036            0.3256577        0.06437188            0.7070170\nLag 2880 0.1954026            0.2793614        0.04171042            0.6502221\n         edgecov.resources_matrix edgecov.parentesco_matrix nodematch.tipo\nLag 0                   1.0000000                 1.0000000      1.0000000\nLag 576                 0.8731033                 0.8863344      0.5119171\nLag 1152                0.7757923                 0.7986013      0.4023770\nLag 1728                0.7025512                 0.7217819      0.3477717\nLag 2304                0.6416237                 0.6513139      0.2845192\nLag 2880                0.5844292                 0.5893462      0.2492085\n         nodematch.orientacion.Conflictiva nodematch.orientacion.No_conflictiva\nLag 0                            1.0000000                            1.0000000\nLag 576                          0.6115570                            0.2928067\nLag 1152                         0.4724889                            0.2079767\nLag 1728                         0.3950607                            0.1770956\nLag 2304                         0.3358570                            0.1496688\nLag 2880                         0.2782121                            0.1436833\n         nodematch.ubicacion\nLag 0              1.0000000\nLag 576            0.4840663\nLag 1152           0.3318695\nLag 1728           0.2821755\nLag 2304           0.2284347\nLag 2880           0.1844652\n\nSample statistics burn-in diagnostic (Geweke):\nChain 1 \n\nFraction in 1st window = 0.1\nFraction in 2nd window = 0.5 \n\n                               edges                 gwesp.OTP.fixed.0.25 \n                        -0.857525302                         -0.365429626 \n                   gwideg.fixed.0.25                 edgecov.trust_matrix \n                        -1.687627240                         -0.935067963 \n            edgecov.resources_matrix            edgecov.parentesco_matrix \n                         0.970112692                         -0.005143813 \n                      nodematch.tipo    nodematch.orientacion.Conflictiva \n                        -1.127942233                         -0.516256129 \nnodematch.orientacion.No_conflictiva                  nodematch.ubicacion \n                        -0.121592526                         -0.919287054 \n\nIndividual P-values (lower = worse):\n                               edges                 gwesp.OTP.fixed.0.25 \n                          0.39115464                           0.71479073 \n                   gwideg.fixed.0.25                 edgecov.trust_matrix \n                          0.09148281                           0.34975328 \n            edgecov.resources_matrix            edgecov.parentesco_matrix \n                          0.33199032                           0.99589585 \n                      nodematch.tipo    nodematch.orientacion.Conflictiva \n                          0.25934432                           0.60567553 \nnodematch.orientacion.No_conflictiva                  nodematch.ubicacion \n                          0.90322173                           0.35794545 \nJoint P-value (lower = worse):  0.2739651 \nChain 2 \n\nFraction in 1st window = 0.1\nFraction in 2nd window = 0.5 \n\n                               edges                 gwesp.OTP.fixed.0.25 \n                           0.9356072                            0.1658378 \n                   gwideg.fixed.0.25                 edgecov.trust_matrix \n                          -0.1285074                           -0.4289485 \n            edgecov.resources_matrix            edgecov.parentesco_matrix \n                           2.1376506                           -1.5191622 \n                      nodematch.tipo    nodematch.orientacion.Conflictiva \n                           1.1046990                            1.3965386 \nnodematch.orientacion.No_conflictiva                  nodematch.ubicacion \n                           1.3711042                            0.3396664 \n\nIndividual P-values (lower = worse):\n                               edges                 gwesp.OTP.fixed.0.25 \n                          0.34947549                           0.86828461 \n                   gwideg.fixed.0.25                 edgecov.trust_matrix \n                          0.89774741                           0.66796070 \n            edgecov.resources_matrix            edgecov.parentesco_matrix \n                          0.03254511                           0.12872168 \n                      nodematch.tipo    nodematch.orientacion.Conflictiva \n                          0.26929005                           0.16255237 \nnodematch.orientacion.No_conflictiva                  nodematch.ubicacion \n                          0.17034248                           0.73410781 \nJoint P-value (lower = worse):  0.004002474 \n\nNote: To save space, only one in every 3 iterations of the MCMC sample\n  used for estimation was stored for diagnostics. Sample size per chain\n  was originally around 11187 with thinning interval 192.\n\nNote: MCMC diagnostics shown here are from the last round of\n  simulation, prior to computation of final parameter estimates.\n  Because the final estimates are refinements of those used for this\n  simulation run, these diagnostics may understate model performance.\n  To directly assess the performance of the final model on in-model\n  statistics, please use the GOF command: gof(ergmFitObject,\n  GOF=~model).\n```\n:::\n:::\n\n\n## Difusión\n\nDetalle de la función de difusión creada...\n\n### Cargamos datos \n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Cargar datos\ncoop_matrix      <- as.matrix(read.csv(\"datos/CoopNet.csv\", header=FALSE))\ntrust_matrix     <- as.matrix(read.csv(\"datos/ConfianzaNet.csv\", header=FALSE))\nresources_matrix <- as.matrix(read.csv(\"datos/RecursosNet.csv\", header=FALSE))\nvalues_matrix    <- as.matrix(read.csv(\"datos/ValoresNet.csv\", header=FALSE))\n\n# 2. Cargar atributos (cambiamos el nombre de la variable)\norg_attributes <- read.csv(\"datos/Atributos _org2011.csv\", header=TRUE) %>%\n  mutate(\n    conflictivo = trimws(Orientación) == \"Conflictiva\",  # Crear variable conflictivo\n    tipo = Tipo_de_organización,\n    ubicacion = Ubicación,\n    orientacion = Orientación\n  )\n\n\n# 3. Verificar la creación correcta de la variable\nprint(\"Verificar variable conflictivo:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Verificar variable conflictivo:\"\n```\n:::\n\n```{.r .cell-code}\ntable(org_attributes$conflictivo, org_attributes$Orientación, useNA = \"always\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       \n        Conflictiva No_conflictiva <NA>\n  FALSE           0             41    0\n  TRUE           29              0    0\n  <NA>            0              0    0\n```\n:::\n\n```{.r .cell-code}\n# 4. Preparar lista de redes\nnetworks <- list(\n  trust_matrix,    # Red de confianza (peso 0.3)\n  values_matrix,   # Red de valores (peso 0.3)\n  coop_matrix,     # Red de cooperación (peso 0.2)\n  resources_matrix # Red de recursos (peso 0.2)\n)\n```\n:::\n\n\n\n### Función para proceso de difusión \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\norg_attributes$block <- as.factor(org_attributes$`X1PosciónCONCOR`)\n\nimproved_diffusion_v9 <- function(networks, attributes, seeds, \n                                  max_iterations = 1000,\n                                  convergence_threshold = 0.001,\n                                  memory_window = 5,\n                                  use_heterogeneous_thresholds = TRUE) {\n  \n  # 1. Umbrales realistas para comportamiento conflictivo\n  thresholds <- list(\n    base = 0.05, # Umbral base alto para comportamiento conflictivo\n    by_type = c(\n      \" Club deportivo \" = 0.15,\n      \" Comité de vivienda \" = 0.06,\n      \" Organización cultural \" = 0.10,\n      \" Organización política de base \" = 0.07,\n      \" Organización política de pobladores \" = 0.05,\n      \" Organización vecinal \" = 0.10,\n      \"Otros\" = 0.15\n    ))\n  \n  # 2. Validación de entrada y preprocesamiento\n  networks <- lapply(networks, function(x) {\n    if(!is.matrix(x)) stop(\"Todas las redes deben ser matrices\")\n    return(as.matrix(x))\n  })\n  \n  if(!all(sapply(networks, function(x) all(dim(x) == dim(networks[[1]])))))\n    stop(\"Todas las redes deben tener las mismas dimensiones\")\n  \n  # 3. Inicialización\n  n_nodes <- nrow(networks[[1]])\n  weights <- c(0.35, 0.35, 0.15, 0.15) # Más peso a confianza y valores\n  \n  # 4. Crear red compuesta\n  composite_net <- Reduce(\"+\", Map(\"*\", networks, weights))\n  \n  # 5. Calcular medidas estructurales\n  g <- igraph::graph_from_adjacency_matrix(composite_net, \n                                           weighted = TRUE, \n                                           mode = \"directed\")\n  \n  # 6. Medidas de centralidad\n  centrality_measures <- list(\n    between = igraph::betweenness(g, normalized = TRUE),\n    degree = igraph::degree(g, mode = \"all\", normalized = TRUE),\n    eigen = igraph::eigen_centrality(g)$vector,\n    authority = igraph::authority_score(g)$vector\n  )\n  \n  # 7. Identificación de roles estructurales\n  role_scores <- data.frame(\n    node = 1:n_nodes,\n    between_score = scale(centrality_measures$between),\n    degree_score = scale(centrality_measures$degree),\n    eigen_score = scale(centrality_measures$eigen),\n    authority_score = scale(centrality_measures$authority)\n  )\n  \n  # Calcular scores compuestos\n  role_scores$broker_score <- role_scores$between_score + role_scores$degree_score\n  role_scores$core_score <- role_scores$eigen_score + role_scores$authority_score\n  \n  # Asignar roles con umbrales más estrictos\n  role_scores$role <- with(role_scores, {\n    ifelse(broker_score > quantile(broker_score, 0.85), \"broker\",\n           ifelse(core_score > quantile(core_score, 0.85), \"core\",\n                  ifelse(authority_score > quantile(authority_score, 0.85), \"authority\",\n                         \"peripheral\")))\n  })\n  \n  # 8. Funciones auxiliares mejoradas\n  calc_local_clustering <- function(node, networks) {\n    cluster_scores <- sapply(networks, function(x) {\n      neighbors <- which(x[node,] > 0)\n      if(length(neighbors) < 2) return(0)\n      submat <- x[neighbors, neighbors]\n      sum(submat) / (length(neighbors) * (length(neighbors)-1))\n    })\n    weighted.mean(cluster_scores, weights)\n  }\n  \n  calc_exposure_time <- function(node, history, window = memory_window) {\n    # Si no hay historia, retornar 0\n    if(is.null(history) || is.null(dim(history)) || nrow(history) == 0) return(0)\n    \n    # Si no hay vecinos, retornar 0\n    if(length(node_neighbors[[node]]) == 0) return(0)\n    \n    # Ajustar ventana si es necesario\n    current_window <- min(window, nrow(history))\n    \n    # Obtener historia reciente\n    if(current_window == 1) {\n      recent_history <- matrix(history, nrow=1)\n    } else {\n      recent_history <- tail(history, current_window)\n    }\n    \n    # Calcular exposición de vecinos\n    exposed_neighbors <- rowSums(recent_history[, node_neighbors[[node]], drop=FALSE])\n    \n    # Calcular pesos\n    weights <- exp(-(current_window:1)/3)\n    \n    # Retornar media ponderada\n    return(weighted.mean(exposed_neighbors, weights))\n  }\n  \n  identity_alignment <- function(node, attributes) {\n    # Mide similitud en atributos organizacionales\n    same_type <- attributes$tipo == attributes$tipo[node]\n    same_orientation <- attributes$Orientación == attributes$Orientación[node]\n    return(mean(same_type & same_orientation))\n  }\n  \n  collective_action_cost <- function(node, role_scores) {\n    # Costo base por visibilidad estructural\n    base_cost <- 1 + abs(role_scores$degree_score[node])\n    \n    # Modificador por rol\n    role_modifier <- switch(role_scores$role[node],\n                            \"broker\" = 1.3,\n                            \"core\" = 1.2,\n                            \"authority\" = 1.1,\n                            1.0)\n    \n    return(base_cost * role_modifier)\n  }\n  \n  # 9. Inicialización de estados y memorias\n  states <- rep(0, n_nodes)\n  states[seeds] <- 1\n  \n  # Crear lista de vecinos\n  node_neighbors <- lapply(1:n_nodes, function(i) {\n    unique(unlist(lapply(networks, function(x) which(x[i,] > 0))))\n  })\n  \n  # 10. Inicialización de matrices de historia\n  history <- matrix(0, nrow = max_iterations, ncol = n_nodes)\n  history[1,] <- states\n  exposure_memory <- matrix(0, nrow = max_iterations, ncol = n_nodes)\n  exposure_memory[1,] <- sapply(1:n_nodes, function(i) {\n    if(length(node_neighbors[[i]]) > 0) {\n      mean(states[node_neighbors[[i]]])\n    } else {\n      0\n    }\n  })\n  clustering_memory <- matrix(0, nrow = max_iterations, ncol = n_nodes)\n  clustering_memory[1,] <- sapply(1:n_nodes, function(i) calc_local_clustering(i, networks))\n  \n  # 11. Proceso de difusión mejorado\n  for(iter in 2:max_iterations) {\n    old_states <- states\n    \n    # Procesar nodos inactivos\n    inactive_nodes <- which(states == 0)\n    \n    for(i in inactive_nodes) {\n      # Calcular influencia base\n      influence <- 0\n      total_weight <- 0\n      \n      # Influencia por tipo de red\n      for(n in seq_along(networks)) {\n        neighbors <- which(networks[[n]][i,] > 0)\n        if(length(neighbors) > 0) {\n          # Influencia ponderada por tipo de vínculo y tiempo\n          net_influence <- sum(states[neighbors]) / length(neighbors)\n          \n          # Factor temporal de exposición\n          exposure_time <- calc_exposure_time(i, history[1:(iter-1), , drop=FALSE])\n          \n          temporal_factor <- 1 - exp(-0.05 * exposure_time)\n          \n          # Efecto de clustering local\n          cluster_effect <- calc_local_clustering(i, networks)\n          cluster_multiplier <- 1 + (cluster_effect * 2)\n          \n          # Efecto de identidad\n          identity_effect <- identity_alignment(i, attributes)\n          \n          # Costo de acción colectiva\n          action_cost <- collective_action_cost(i, role_scores)\n          \n          # Combinar efectos\n          combined_influence <- net_influence * weights[n] * \n            temporal_factor * cluster_multiplier * \n            (1 + identity_effect) / action_cost\n          \n          influence <- influence + combined_influence\n          total_weight <- total_weight + weights[n]\n        }\n      }\n      \n      if(total_weight > 0) {\n        # Normalizar influencia\n        influence <- influence / total_weight\n        \n        if(use_heterogeneous_thresholds) {\n          # Threshold dinámico con heterogeneidad\n          base_threshold <- thresholds$base\n          type_threshold <- thresholds$by_type[attributes$tipo[i]]\n        } else {\n          # Threshold dinámico sin heterogeneidad\n          base_threshold <- thresholds$base\n          type_threshold <- 1\n        }\n        \n        # Ajustar threshold por exposición temporal y clustering\n        exposure_effect <- mean(exposure_memory[1:max(1,iter-1), i], na.rm=TRUE)\n        cluster_effect <- mean(clustering_memory[1:max(1,iter-1), i], na.rm=TRUE)\n        \n        final_threshold <- (base_threshold * type_threshold) * \n          exp(-0.05 * exposure_effect) *\n          (1 - 0.2 * cluster_effect)\n        \n        # Probabilidad de adopción\n        if(influence >= final_threshold) {\n          # Fricción en adopción\n          adoption_prob <- 0.3 * (1 + exposure_effect)\n          states[i] <- rbinom(1, 1, min(1, adoption_prob))\n        }\n      }\n      \n      # Actualizar memorias\n      exposure_memory[iter, i] <- ifelse(length(node_neighbors[[i]]) > 0,\n                                         sum(states[node_neighbors[[i]]]) / length(node_neighbors[[i]]),\n                                         0)\n      clustering_memory[iter, i] <- calc_local_clustering(i, networks)\n    }\n    \n    # Guardar historia\n    history[iter,] <- states\n    \n    # Verificar convergencia\n    if(iter > 20) {\n      recent_window <- (iter-19):iter\n      change_rate <- mean(diff(colMeans(history[recent_window,])))\n      if(abs(change_rate) < convergence_threshold) break\n    }\n    \n    if(all(old_states == states) && iter > 10) break\n  }\n  \n  # 12. Calcular métricas finales\n  final_metrics <- list(\n    adoption_rate = mean(states),\n    clustering_effect = sapply(1:n_nodes, function(i) calc_local_clustering(i, networks)),\n    temporal_exposure = colMeans(exposure_memory[1:iter,], na.rm=TRUE),\n    convergence_iteration = iter,\n    change_trajectory = rowMeans(history[1:iter,]),\n    adoption_by_type = tapply(states, attributes$tipo, mean),\n    adoption_by_role = tapply(states, role_scores$role, mean),\n    final_thresholds = sapply(1:n_nodes, function(i) {\n      base_threshold <- if(use_heterogeneous_thresholds) {\n        thresholds$by_type[attributes$tipo[i]]\n      } else {\n        thresholds$base\n      }\n      exposure_effect <- mean(exposure_memory[1:iter, i], na.rm=TRUE)\n      cluster_effect <- mean(clustering_memory[1:iter, i], na.rm=TRUE)\n      base_threshold * exp(-0.05 * exposure_effect) *\n        (1 - 0.2 * cluster_effect)\n    }),\n    network_effects = list(\n      clustering = mean(sapply(1:n_nodes, function(i) calc_local_clustering(i, networks))),\n      exposure = mean(colMeans(exposure_memory[1:iter,], na.rm=TRUE)),\n      identity = mean(sapply(1:n_nodes, function(i) identity_alignment(i, attributes))),\n      costs = mean(sapply(1:n_nodes, function(i) collective_action_cost(i, role_scores)))\n    )\n  )\n  \n  # 13. Retornar resultados\n  return(list(\n    final_states = states,\n    history = history[1:iter,],\n    n_iterations = iter,\n    role_scores = role_scores,\n    centrality_measures = centrality_measures,\n    composite_net = composite_net,\n    exposure_memory = exposure_memory[1:iter,],\n    clustering_memory = clustering_memory[1:iter,],\n    final_metrics = final_metrics,\n    converged = iter < max_iterations,\n    parameters = list(\n      thresholds = thresholds,\n      weights = weights,\n      memory_window = memory_window,\n      convergence_threshold = convergence_threshold,\n      use_heterogeneous_thresholds = use_heterogeneous_thresholds\n    )\n  ))\n}\n```\n:::\n\n\n\n### Función para plotear \n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nplot_diffusion_results_v2 <- function(results, org_attributes) {\n  library(ggplot2)\n  library(dplyr)\n  library(tidyr)\n  library(patchwork)\n  library(viridis)\n  \n  # 1. Datos para difusión total\n  df_total <- data.frame(\n    iteration = 1:nrow(results$history),\n    proportion = rowMeans(results$history),\n    exposure = rowMeans(results$exposure_memory)  # Cambio aquí: rowMeans en lugar de colMeans\n  )\n  \n  # 2. Datos por tipo de organización\n  df_by_type <- data.frame(results$history) %>%\n    mutate(iteration = row_number()) %>%\n    pivot_longer(-iteration, names_to = \"node\", values_to = \"state\") %>%\n    mutate(node = as.numeric(gsub(\"[^0-9]\", \"\", node))) %>%\n    left_join(\n      data.frame(\n        node = 1:nrow(org_attributes),\n        tipo = org_attributes$Tipo_de_organización\n      ),\n      by = \"node\"\n    ) %>%\n    group_by(iteration, tipo) %>%\n    summarise(\n      proportion = mean(state),\n      n_adopted = sum(state),\n      n_total = n(),\n      .groups = 'drop'\n    )\n  \n  # 3. Análisis de roles y adopción\n  role_adoption <- data.frame(\n    role = factor(results$role_scores$role),\n    adopted = factor(results$final_states)\n  ) %>%\n    group_by(role) %>%\n    summarise(\n      n = n(),\n      adopted = sum(as.numeric(as.character(adopted))),\n      proportion = adopted/n\n    )\n  \n  # 4. Análisis de bloques estructurales\n  node_cohesion <- data.frame(\n    node = 1:length(results$final_metrics$clustering_effect),\n    cohesion = results$final_metrics$clustering_effect\n  )\n  \n  block_adoption <- data.frame(\n    node = 1:length(results$final_states),\n    block = ifelse(1:length(results$final_states) <= nrow(org_attributes),\n                   as.character(org_attributes$block), \"Unknown\"),\n    adopted = results$final_states\n  ) %>%\n    left_join(node_cohesion, by = \"node\") %>%\n    group_by(block) %>%\n    summarise(\n      adoption_rate = mean(adopted),\n      cohesion = mean(cohesion, na.rm = TRUE)\n    )\n  \n  # 5. Visualizaciones\n  p1 <- ggplot(df_total, aes(x = iteration, y = proportion)) +\n    geom_line(size = 1.2, color = \"#2C3E50\") +\n    geom_point(size = 3, color = \"#E74C3C\") +\n    geom_line(aes(y = exposure), linetype = \"dashed\", color = \"#8E44AD\") +\n    theme_minimal() +\n    labs(\n      title = \"Difusión Global y Exposición\",\n      subtitle = sprintf(\"Adopción final: %.1f%%\", \n                         results$final_metrics$adoption_rate * 100),\n      x = \"Iteración\",\n      y = \"Proporción\"\n    ) +\n    scale_y_continuous(\n      labels = scales::percent_format(),\n      limits = c(0, 1)\n    )\n  \n  p2 <- ggplot(df_by_type, aes(x = iteration, y = proportion, color = tipo)) +\n    geom_line(size = 1.2) +\n    geom_point(size = 2) +\n    theme_minimal() +\n    labs(\n      title = \"Difusión por Tipo de Organización\",\n      x = \"Iteración\",\n      y = \"Proporción Adoptante\",\n      color = \"Tipo de Organización\"\n    ) +\n    scale_y_continuous(\n      labels = scales::percent_format(),\n      limits = c(0, 1)\n    ) +\n    scale_color_viridis_d() + \n    theme(legend.position = \"none\")\n  \n  p3 <- ggplot(role_adoption, \n               aes(x = reorder(role, proportion), y = proportion)) +\n    geom_bar(stat = \"identity\", fill = \"#2C3E50\", alpha = 0.8) +\n    geom_text(aes(label = scales::percent(proportion)), \n              position = position_stack(vjust = 0.5),\n              color = \"white\") +\n    theme_minimal() +\n    labs(\n      title = \"Adopción Final por Rol Estructural\",\n      x = \"Rol\",\n      y = \"Proporción Adoptante\"\n    ) +\n    scale_y_continuous(labels = scales::percent_format()) +\n    theme(\n      plot.title = element_text(face = \"bold\", size = 14),\n      axis.title = element_text(size = 11),\n      axis.text.x = element_text(angle = 45, hjust = 1)\n    )\n  \n  p4 <- ggplot(block_adoption, aes(x = cohesion, y = adoption_rate)) +\n    geom_point(size = 3, color = \"#E74C3C\") +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"#2C3E50\") +\n    theme_minimal() +\n    labs(\n      title = \"Adopción vs Cohesión por Bloque Estructural\",\n      x = \"Cohesión Estructural del Bloque\",\n      y = \"Tasa de Adopción del Bloque\"\n    )\n  \n  # 6. Combinar visualizaciones\n  layout <- \"\n  AB\n  CD\n  \"\n  \n  combined_plot <- p1 + p2 + p3 + p4 +\n    plot_layout(design = layout) +\n    plot_annotation(\n      title = \"Análisis de Difusión de Comportamiento Conflictivo\",\n      subtitle = sprintf(\"Iteraciones: %d | Convergencia en: %.1f%% de adopción\", \n                         results$n_iterations,\n                         results$final_metrics$adoption_rate * 100),\n      theme = theme(\n        plot.title = element_text(size = 16, face = \"bold\"),\n        plot.subtitle = element_text(size = 12)\n      )\n    )\n  \n  return(combined_plot)\n}\n```\n:::\n\n\n### Ejecutar funciones  \n\n#### Resultados heterogeneous thresholds = FALSE\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ejecutar una simulación\nresults <- improved_diffusion_v9(\n  networks = networks,\n  attributes = org_attributes,\n  seeds = which(org_attributes$tipo == \" Organización política de pobladores \"),\n  use_heterogeneous_thresholds = FALSE\n)\n\n# Visualizar resultados\nplot_diffusion_results_v2(results, org_attributes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n#### Resultados heterogeneous thresholds = TRUE\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ejecutar una simulación\nresults <- improved_diffusion_v9(\n  networks = networks,\n  attributes = org_attributes,\n  seeds = which(org_attributes$tipo == \" Organización política de pobladores \"),\n  use_heterogeneous_thresholds = TRUE\n)\n\n# Visualizar resultados\nplot_diffusion_results_v2(results, org_attributes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Simulaciones heterogeneous thresholds = TRUE\n\n::: {.cell}\n\n```{.r .cell-code}\n# Función para ejecutar múltiples simulaciones\nrun_multiple_simulations <- function(networks, attributes, seeds, n_sims = 100) {\n  results_list <- list()\n  for(i in 1:n_sims) {\n    results_list[[i]] <- improved_diffusion_v9(\n      networks = networks,\n      attributes = attributes,\n      seeds = seeds\n    )\n  }\n  \n  # Calcular estadísticas agregadas\n  adoption_rates <- sapply(results_list, function(x) x$final_metrics$adoption_rate)\n  iterations <- sapply(results_list, function(x) x$n_iterations)\n  \n  return(list(\n    mean_adoption = mean(adoption_rates),\n    sd_adoption = sd(adoption_rates),\n    mean_iterations = mean(iterations),\n    sd_iterations = sd(iterations),\n    results = results_list\n  ))\n}\n\n\n# O ejecutar múltiples simulaciones\nmultiple_results <- run_multiple_simulations(\n  networks = networks,\n  attributes = org_attributes,\n  seeds = which(org_attributes$tipo == \" Organización política de pobladores \"),\n  n_sims = 100\n)\n\n# Análisis de la infomracióm simulada\nmean_adoption_rate <- multiple_results$mean_adoption\nsd_adoption_rate <- multiple_results$sd_adoption\n\ncat(\"La tasa de adopción final promedio es:\", round(mean_adoption_rate * 100, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLa tasa de adopción final promedio es: 35.84 %\n```\n:::\n\n```{.r .cell-code}\ncat(\"La desviación estándar de la tasa de adopción final es:\", round(sd_adoption_rate * 100, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLa desviación estándar de la tasa de adopción final es: 1.25 %\n```\n:::\n\n```{.r .cell-code}\n## Trayectorias simuladas\ndiffusion_trajectories <- lapply(seq_along(multiple_results$results), function(i) {\n  data.frame(\n    iteration = seq_along(multiple_results$results[[i]]$final_metrics$change_trajectory),\n    adoption_rate = multiple_results$results[[i]]$final_metrics$change_trajectory,\n    simulation = paste(\"Simulación\", i)\n  )\n})\n\ndiffusion_trajectories <- do.call(rbind, diffusion_trajectories)\n\nggplot(diffusion_trajectories, aes(x = iteration, y = adoption_rate, color = simulation)) +\n  geom_line() +\n  labs(x = \"Iteración\", y = \"Tasa de Adopción\") +\n  ggtitle(\"Trayectorias de Difusión\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## Adopción por tipo y rol\nadoption_by_type <- lapply(multiple_results$results, function(x) x$final_metrics$adoption_by_type)\nadoption_by_role <- lapply(multiple_results$results, function(x) x$final_metrics$adoption_by_role)\n\nmean_adoption_by_type <- Reduce(\"+\", adoption_by_type) / length(adoption_by_type)\nmean_adoption_by_role <- Reduce(\"+\", adoption_by_role) / length(adoption_by_role)\n\nprint(\"Adopción promedio por tipo de organización:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Adopción promedio por tipo de organización:\"\n```\n:::\n\n```{.r .cell-code}\nprint(mean_adoption_by_type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      Club deportivo                    Comité de vivienda  \n                            0.0000000                             0.3322222 \n               Organización cultural         Organización política de base  \n                            0.4069231                             0.9783333 \n Organización política de pobladores                  Organización vecinal  \n                            1.0000000                             0.1829630 \n                                Otros \n                            0.0000000 \n```\n:::\n\n```{.r .cell-code}\nprint(\"Adopción promedio por rol estructural:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Adopción promedio por rol estructural:\"\n```\n:::\n\n```{.r .cell-code}\nprint(mean_adoption_by_role)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n authority     broker       core peripheral \n 0.4800000  0.8072727  0.9833333  0.1890385 \n```\n:::\n\n```{.r .cell-code}\n## Adopción y centralidad \ncentrality_measures <- lapply(multiple_results$results, function(x) x$centrality_measures)\nclustering_effects <- lapply(multiple_results$results, function(x) x$final_metrics$clustering_effect)\n\n# Ejemplo: Correlación promedio entre centralidad de grado y adopción final\ncor_degree_adoption <- sapply(seq_along(centrality_measures), function(i) {\n  degree_centrality <- centrality_measures[[i]]$degree\n  adoption_status <- multiple_results$results[[i]]$final_states\n  cor(degree_centrality, adoption_status)\n})\n\nmean_cor_degree_adoption <- mean(cor_degree_adoption)\ncat(\"Correlación promedio entre centralidad de grado y adopción final:\", round(mean_cor_degree_adoption, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCorrelación promedio entre centralidad de grado y adopción final: 0.74 \n```\n:::\n\n```{.r .cell-code}\n# Asumiendo que ejecutaste múltiples simulaciones con diferentes parámetros y los resultados están en `multiple_results`\nmean_adoption_rates <- sapply(multiple_results$results, function(x) x$final_metrics$adoption_rate)\nplot(mean_adoption_rates, xlab = \"Simulación\", ylab = \"Tasa de Adopción Final\", main = \"Análisis de Sensibilidad\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n\n\n## Discusión\n\nEste modelo incorpora varios elementos teóricos clave:\n\n1. **Multiplexidad de vínculos**: Considera cinco tipos de relaciones con diferentes pesos según su importancia teórica para la difusión de identidades políticas.\n\n2. **Roles estructurales**: Identifica brokers y organizaciones núcleo usando una combinación de medidas de centralidad y multiplexidad.\n\n3. **Umbrales heterogéneos**: Aplica diferentes umbrales de adopción según el tipo de organización, reflejando su propensión a adoptar posturas contenciosas.\n\n4. **Mecanismos de influencia**: \n   - Efecto directo de vínculos múltiples\n   - Bonus por tipo de vínculo (confianza y valores)\n   - Efectos de rol estructural (brokers y cores)\n   \n5. **Complex contagion**: Requiere exposición múltiple y considera la estructura local de la red.\n\nLos resultados sugieren que:\n\n1. Las organizaciones políticas de pobladores actúan como núcleo efectivo del proceso de difusión.\n2. La multiplexidad de vínculos acelera la adopción.\n3. Existen umbrales críticos que varían por tipo organizativo.\n4. Los brokers juegan un rol clave en conectar diferentes dominios organizativos.\n\n\n# References\n\nBaldassarri, D., & Diani, M. (2007). The integrative power of civic networks. American Journal of Sociology, 113(3), 735-780.\n\nCentola, D. (2018). How behavior spreads: The science of complex contagions. Princeton University Press.\n\nCentola, D., & Macy, M. (2007). Complex contagions and the weakness of long ties. American Journal of Sociology, 113(3), 702-734.\n\nDiani, M. (2003). Networks and social movements: A research programme. In M. Diani & D. McAdam (Eds.), Social movements and networks: Relational approaches to collective action (pp. 299-319). Oxford University Press.\n\nDiani, M. (2015). The cement of civil society. Cambridge University Press.\n\nDomínguez, S., & Hollstein, B. (2014). Mixed methods social networks research: Design and applications. Cambridge University Press.\n\nGould, R. V. (1991). Multiple networks and mobilization in the Paris Commune, 1871. American Sociological Review, 56(6), 716-729.\n\nMcAdam, D., & Paulsen, R. (1993). Specifying the relationship between social ties and activism. American Journal of Sociology, 99(3), 640-667.\n\nMcAdam, D., Tarrow, S., & Tilly, C. (2001). Dynamics of contention. Cambridge University Press.\n\nMische, A. (2003). Cross-talk in movements: Reconceiving the culture-network link. In M. Diani & D. McAdam (Eds.), Social movements and networks: Relational approaches to collective action (pp. 258-280). Oxford University Press.\n\nPassy, F., & Giugni, M. (2001). Social networks and individual perceptions: Explaining differential participation in social movements. Sociological Forum, 16(1), 123-153.\n\nScott, J. (2011). Social network analysis: Developments, advances, and prospects. Social Network Analysis and Mining, 1(1), 21-26.\n\nTarrow, S. (2005). The new transnational activism. Cambridge University Press.\n\nTilly, C. (2004). Social boundary mechanisms. Philosophy of the Social Sciences, 34(2), 211-236.\n\nTilly, C., & Tarrow, S. (2015). Contentious politics (2nd ed.). Oxford University Press.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}